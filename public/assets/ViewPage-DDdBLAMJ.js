import{$ as e,K as ee,a$ as te,a6 as t,aC as n,aD as r,aO as i,aQ as a,aR as o,aS as s,aT as c,aU as l,aW as u,aX as d,aY as ne,ak as re,b1 as f,b2 as ie,b4 as ae,b8 as p,bb as m,bc as h,bf as g,u as oe}from"./index-D3uPKL_7.js";import{b as se}from"./useAuth-DVbJ9eMN.js";import"./GlobalConfig-wPgXFcZ5.js";import{c as _,d as v,f as y}from"./common-CZbH6H1Z.js";import"./tableUtils-dXs1kjAL.js";import"./Modal-Cape7EXm.js";import"./StatusBadge-CqnSJvWI.js";import{b,d as x}from"./currencyUtil-BN7TmPM2.js";import{b as S}from"./DataItems-xHgcV0ga.js";import{b as C}from"./CustomerReturnMarkReceived-bm9ueB0B.js";import{b as w}from"./customerReturnOrdersStore-DT68yrBw.js";import{b as T}from"./CustomerReturnApprove-BivZIeUN.js";const E={class:`max-w-7xl mx-auto sm:px-6 lg:px-8 py-6`},D={class:`mb-6`},O={class:`flex items-center justify-between`},k={key:0,class:`mt-1 text-sm text-gray-600 dark:text-gray-400`},A={class:`flex items-center space-x-3`},j={key:0,class:`flex justify-center items-center py-8`},M={key:1,class:`space-y-6`},N={class:`flex items-center space-x-3`},P={key:0,class:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200`},F={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},I={class:`px-6 py-4`},L={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2 lg:grid-cols-3`},R={class:`text-sm text-gray-900 dark:text-white font-mono`},z={key:0,class:`mt-6`},B={class:`text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded-md`},V={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},H={class:`px-6 py-4`},U={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2`},W={key:0,class:`mt-6`},G={class:`text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded-md`},K={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},ce={class:`px-6 py-4`},le={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2`},ue={key:0,class:`mt-6`},de={class:`text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded-md`},fe={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},pe={class:`overflow-x-auto`},me={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},he={class:`bg-gray-50 dark:bg-gray-900`},ge={key:0,class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},_e={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},ve={class:`px-6 py-4 whitespace-nowrap`},ye={class:`flex items-center`},be={class:`flex-shrink-0 h-10 w-10`},xe=[`src`,`alt`],Se={key:1,class:`h-10 w-10 rounded bg-gray-200 dark:bg-gray-600 flex items-center justify-center`},Ce={class:`ml-4`},we={class:`text-sm font-medium text-gray-900 dark:text-white`},Te={class:`text-sm text-gray-500 dark:text-gray-400`},Ee={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},De={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},Oe={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},ke={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},Ae={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},je={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},Me={key:0,class:`px-6 py-4 whitespace-nowrap text-right text-sm font-medium text-gray-900 dark:text-white`},Ne={class:`px-6 py-4 text-right`},Pe={key:0,class:`px-6 py-4 text-right`},Fe={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},Ie={class:`px-6 py-4`},Le={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2 lg:grid-cols-4`};var q=ne({__name:`ViewPage`,setup(ne){let q=n(),J=r(),Re=w(),{isAdmin:Y,isWarehouseManager:ze,hasAnyRole:Be}=se(),X=m(null),Z=m(!0),Q=m(!1),$=m(!1),Ve=a(()=>Be([`admin`,`salesman`])),He=a(()=>!0),Ue=async()=>{try{Z.value=!0;let e=parseInt(q.params.id);X.value=await Re.fetchReturnOrder(e)}catch(e){console.error(`Error fetching return order:`,e),J.push({name:`customer.return-orders.index`})}finally{Z.value=!1}},We=e=>{X.value=e,Q.value=!1},Ge=e=>{X.value=e,$.value=!1};return te(()=>{Ue()}),(te,n)=>{let r=ae(`router-link`);return f(),l(`div`,E,[o(`div`,D,[o(`div`,O,[o(`div`,null,[n[4]||=o(`h1`,{class:`text-2xl font-semibold text-gray-900 dark:text-white`},`Return Order Details`,-1),X.value?(f(),l(`p`,k,g(X.value.return_code)+` " `+g(h(_)(X.value.date)),1)):c(``,!0)]),o(`div`,A,[X.value&&!X.value.is_approved&&Ve.value?(f(),s(r,{key:0,to:{name:`customer.return-orders.edit`,params:{id:X.value?.id}},class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`},{default:p(()=>[d(h(oe),{class:`h-4 w-4 mr-2`}),n[5]||=u(` Edit `,-1)]),_:1,__:[5]},8,[`to`])):c(``,!0),X.value&&X.value.is_pending&&h(Y)?(f(),l(`button`,{key:1,onClick:n[0]||=e=>Q.value=!0,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500`},[d(h(t),{class:`h-4 w-4 mr-2`}),n[6]||=u(` Approve `,-1)])):c(``,!0),X.value&&X.value.is_approved&&!X.value.is_received&&He.value?(f(),l(`button`,{key:2,onClick:n[1]||=e=>$.value=!0,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500`},[d(h(e),{class:`h-4 w-4 mr-2`}),n[7]||=u(` Mark as Received `,-1)])):c(``,!0),d(r,{to:{name:`customer.return-orders.index`},class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600`},{default:p(()=>[d(h(re),{class:`h-4 w-4 mr-2`}),n[8]||=u(` Back to List `,-1)]),_:1,__:[8]})])])]),Z.value?(f(),l(`div`,j,n[9]||=[o(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600`},null,-1)])):X.value?(f(),l(`div`,M,[o(`div`,N,[X.value.is_received?(f(),l(`span`,P,[d(h(t),{class:`h-4 w-4 mr-1`}),n[10]||=u(` Received `,-1)])):c(``,!0)]),o(`div`,F,[n[11]||=o(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[o(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Return Order Information`)],-1),o(`div`,I,[o(`div`,L,[d(S,{label:`Return Code`},{default:p(()=>[o(`div`,R,g(X.value.return_code),1)]),_:1}),d(S,{label:`Date`,value:h(_)(X.value.date)},null,8,[`value`]),d(S,{label:`Customer`,value:X.value.customer?.name},null,8,[`value`]),d(S,{label:`Salesperson`,value:X.value.salesperson?.name},null,8,[`value`]),d(S,{label:`Warehouse`,value:X.value.warehouse?.name},null,8,[`value`]),d(S,{label:`Currency`,value:X.value.currency?.code},null,8,[`value`]),X.value.currency_rate&&!h(x)(X.value.currency.code)?(f(),s(S,{key:0,label:`Exchange Rate`,value:X.value.currency_rate},null,8,[`value`])):c(``,!0)]),X.value.note?(f(),l(`div`,z,[d(S,{label:`Note`},{default:p(()=>[o(`div`,B,g(X.value.note),1)]),_:1})])):c(``,!0)])]),X.value.is_approved?(f(),l(`div`,V,[n[12]||=o(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[o(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Approval Information`)],-1),o(`div`,H,[o(`div`,U,[d(S,{label:`Approved By`,value:X.value.approved_by_user?.name},null,8,[`value`]),d(S,{label:`Approved At`,value:h(v)(X.value.approved_at)},null,8,[`value`])]),X.value.approve_note?(f(),l(`div`,W,[d(S,{label:`Approval Note`},{default:p(()=>[o(`div`,G,g(X.value.approve_note),1)]),_:1})])):c(``,!0)])])):c(``,!0),X.value.is_received?(f(),l(`div`,K,[n[13]||=o(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[o(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Receipt Information`)],-1),o(`div`,ce,[o(`div`,le,[d(S,{label:`Received By`,value:X.value.return_received_by_user?.name},null,8,[`value`]),d(S,{label:`Received At`,value:h(v)(X.value.return_received_at)},null,8,[`value`])]),X.value.return_received_note?(f(),l(`div`,ue,[d(S,{label:`Receipt Note`},{default:p(()=>[o(`div`,de,g(X.value.return_received_note),1)]),_:1})])):c(``,!0)])])):c(``,!0),o(`div`,fe,[n[23]||=o(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[o(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Return Items`)],-1),o(`div`,pe,[o(`table`,me,[o(`thead`,he,[o(`tr`,null,[n[14]||=o(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`item`,-1),n[15]||=o(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Quantity`,-1),n[16]||=o(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Unit Price`,-1),n[17]||=o(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},[o(`abbr`,{title:`Discount %`},`Dis %`)],-1),n[18]||=o(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},[o(`abbr`,{title:`Tax %`},`TAX %`)],-1),n[19]||=o(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},[o(`abbr`,{title:`ttc price`},`TTC`)],-1),n[20]||=o(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Total`,-1),h(x)(X.value.currency.code)?c(``,!0):(f(),l(`th`,ge,`Total USD`))])]),o(`tbody`,_e,[(f(!0),l(i,null,ie(X.value.items,e=>(f(),l(`tr`,{key:e.id},[o(`td`,ve,[o(`div`,ye,[o(`div`,be,[e.item?.image?(f(),l(`img`,{key:0,src:e.item.image,alt:e.item.name,class:`h-10 w-10 rounded object-cover`},null,8,xe)):(f(),l(`div`,Se,[d(h(ee),{class:`h-6 w-6 text-gray-400`})]))]),o(`div`,Ce,[o(`div`,we,g(e.item?.name),1),o(`div`,Te,g(e.item_code),1)])])]),o(`td`,Ee,g(h(y)(e.quantity)),1),o(`td`,De,g(h(b)(e.price,!0,X.value.currency)),1),o(`td`,Oe,g(h(y)(e.discount_percent)),1),o(`td`,ke,g(h(y)(e.tax_percent)),1),o(`td`,Ae,g(h(y)(e.ttc_price)),1),o(`td`,je,g(h(b)(e.total_price,!0,X.value.currency)),1),h(x)(X.value.currency.code)?c(``,!0):(f(),l(`td`,Me,g(h(b)(e.total_price_usd,!0)),1))]))),128))]),o(`tfoot`,null,[n[21]||=o(`td`,{colspan:`5`},null,-1),n[22]||=o(`td`,{class:`px-6 py-4 text-right`},`Total`,-1),o(`td`,Ne,g(h(b)(X.value.total,X.value.currency?.code)),1),h(x)(X.value.currency.code)?c(``,!0):(f(),l(`td`,Pe,g(h(b)(X.value.total_usd,`usd`)),1))])])])]),o(`div`,Fe,[n[24]||=o(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[o(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Summary`)],-1),o(`div`,Ie,[o(`div`,Le,[d(S,{label:`Total Volume`,value:`${h(y)(X.value.total_volume_cbm)} cbm`},null,8,[`value`]),d(S,{label:`Total Weight`,value:`${h(y)(X.value.total_weight_kg)} kg`},null,8,[`value`]),d(S,{label:`Total Items`,value:X.value.items?.length||0},null,8,[`value`])])])])])):c(``,!0),d(T,{show:Q.value,"onUpdate:show":n[2]||=e=>Q.value=e,"return-order":X.value,onApproved:We},null,8,[`show`,`return-order`]),d(C,{show:$.value,"onUpdate:show":n[3]||=e=>$.value=e,"return-order":X.value,onMarkedReceived:Ge},null,8,[`show`,`return-order`])])}}}),J=q;export{J as default};
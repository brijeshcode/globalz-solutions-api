import{D as e,I as t,a$ as n,aC as ee,aF as r,aG as te,aH as i,aI as a,aK as o,aL as s,aM as ne,aO as c,aQ as l,aR as re,aX as u,a_ as d,aa as ie,am as ae,aq as oe,ar as se,b0 as f,b2 as p,o as ce,q as le,z as ue}from"./index--pi_6MVY.js";import{b as de}from"./useAuth-CraJi6K1.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-BFc6-TYF.js";import{b as fe}from"./ConfirmationModal-z4PnYO2x.js";import{b as m}from"./common-DNevajli.js";import{b as h}from"./DataItems-D-y3rgaf.js";import{b as pe}from"./salesStore-BzIoYxLK.js";const me={class:`max-w-8xl mx-auto py-2`},g={class:``},_={class:`mb-8`},v={class:`flex items-center space-x-4 mb-2`},y={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},b={class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},x={class:`flex items-center justify-between`},S={class:`text-lg font-medium text-gray-900 dark:text-white`},C={class:`text-sm text-gray-500 dark:text-gray-400`},w={class:`flex space-x-3`},T={class:`px-6 py-8`},E={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},D={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6`},O={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-4`},k={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},A={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6`},j={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},M={key:0,class:`text-center py-8 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg`},N={key:1,class:`overflow-x-auto`},P={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},F={class:`bg-gray-50 dark:bg-gray-700`},I={key:0,class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},L={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},R={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},z={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},he={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ge={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},_e={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ve={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ye={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},be={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},xe={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Se={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ce={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},we={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Te={class:`bg-gray-50 dark:bg-gray-700`},Ee={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},De={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Oe={key:0},ke={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Ae={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},je={key:0,class:`px-6 py-4`},Me={class:`bg-green-50 dark:bg-green-900`},Ne={class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},Pe={class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},Fe={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},Ie={class:`grid grid-cols-1 md:grid-cols-3 gap-6`},Le={class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},Re={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},ze={class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},Be={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},Ve={class:`mt-1 text-lg font-medium`},He={key:0,class:`mb-6`},Ue={class:`bg-gray-50 dark:bg-gray-700 rounded-lg p-4`},We={class:`text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap`},Ge={class:`pt-6 border-t border-gray-200 dark:border-gray-700`},Ke={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},qe={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},Je={class:`px-6 py-8 text-center`};var B=ne({__name:`ViewPage`,setup(ne){let B=se(),V=oe(),H=ae(),U=pe(),{isSalesman:Ye,isAdmin:W,isWarehouseManager:Xe}=de(),G=parseInt(V.params.id),K=d(!0),q=d({}),J=d(!1),Y=d(!1),Ze=()=>{B.push({name:`sales.index`})},Qe=()=>{B.push({name:`sales.edit`,params:{id:G.toString()}})},$e=()=>{B.push({name:`sales.invoice`,params:{id:G.toString()},query:{from:`view`}})},et=()=>{J.value=!0},X=()=>{J.value=!1,Y.value=!1},tt=async()=>{Y.value=!0;try{await U.deleteSale(G),H.success(`Sale deleted successfully`),B.push({name:`sales.index`})}catch{H.error(`Failed to delete sale`)}finally{Y.value=!1}},nt=async()=>{try{K.value=!0,q.value=await U.fetchSale(G)}catch(e){console.error(`Error loading sale:`,e),H.error(`Failed to load sale details`),B.push({name:`sales.index`})}finally{K.value=!1}},Z=e=>{let t=Number(e||0);return t>0?`text-green-600 dark:text-green-400 font-medium`:t<0?`text-red-600 dark:text-red-400 font-medium`:`text-gray-600 dark:text-gray-400`},rt=e=>{let t=Number(e||0);return t>0?`bg-green-50 dark:bg-green-900 text-green-600 dark:text-green-400`:t<0?`bg-red-50 dark:bg-red-900 text-red-600 dark:text-red-400`:`bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-400`},it=e=>{let t=Number(e||0);return t>0?`text-red-600 dark:text-red-400 font-medium`:`text-gray-900 dark:text-white`},Q=e=>e?parseFloat(Number(e).toFixed(2)).toString():`0`,at=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleDateString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`})},$=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`})};return c(async()=>{await nt()}),(ne,c)=>(l(),a(`div`,me,[r(`div`,g,[r(`div`,_,[r(`div`,v,[r(`button`,{onClick:Ze,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[s(n(ie),{class:`w-5 h-5`})]),c[1]||=r(`div`,null,[r(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},` Sale Details `),r(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},` View sale order information `)],-1)])]),K.value?(l(),a(`div`,qe,[r(`div`,Je,[s(n(t),{class:`w-8 h-8 animate-spin mx-auto text-blue-600`}),c[30]||=r(`p`,{class:`mt-2 text-gray-600 dark:text-gray-400`},`Loading sale details...`,-1)])])):(l(),a(`div`,y,[r(`div`,b,[r(`div`,x,[r(`div`,null,[r(`h3`,S,p(q.value.prefix)+`-`+p(q.value.code),1),r(`p`,C,` Sale ID: `+p(q.value.id),1)]),r(`div`,w,[r(`button`,{onClick:$e,class:`inline-flex items-center px-3 py-2 border border-green-300 dark:border-green-600 text-sm font-medium rounded-md text-green-700 dark:text-green-300 bg-white dark:bg-gray-800 hover:bg-green-50 dark:hover:bg-green-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200`},[s(n(ue),{class:`w-4 h-4 mr-2`}),c[2]||=o(` Print Invoice `,-1)]),n(W)?(l(),a(`button`,{key:0,onClick:Qe,class:`inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200`},[s(n(e),{class:`w-4 h-4 mr-2`}),c[3]||=o(` Edit `,-1)])):i(``,!0),n(W)?(l(),a(`button`,{key:1,onClick:et,class:`inline-flex items-center px-3 py-2 border border-red-300 dark:border-red-600 text-sm font-medium rounded-md text-red-700 dark:text-red-300 bg-white dark:bg-gray-800 hover:bg-red-50 dark:hover:bg-red-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200`},[s(n(ce),{class:`w-4 h-4 mr-2`}),c[4]||=o(` Delete `,-1)])):i(``,!0)])])]),r(`div`,T,[r(`div`,E,[c[5]||=r(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Basic Information `,-1),r(`div`,D,[s(h,{label:`Sale Date`,value:at(q.value.date)},null,8,[`value`]),s(h,{label:`Customer`,value:q.value.customer.name},null,8,[`value`]),s(h,{label:`Salesperson`,value:q.value.salesperson.name},null,8,[`value`]),s(h,{label:`Warehouse`,value:q.value.warehouse.name},null,8,[`value`]),s(h,{label:`Currency`,value:`${q.value.currency.code} - ${q.value.currency.name}`},null,8,[`value`])]),r(`div`,O,[s(h,{label:`Currency Rate`,value:Q(q.value.currency_rate)},null,8,[`value`]),s(h,{label:`Outstanding Balance`},{default:u(()=>[r(`div`,{class:f([`text-sm`,it(q.value.outStanding_balance)])},p(n(m)(q.value.outStanding_balance)),3)]),_:1})])]),r(`div`,k,[c[6]||=r(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Financial Summary `,-1),r(`div`,A,[s(h,{label:`Sub Total`,value:n(m)(q.value.sub_total)},null,8,[`value`]),s(h,{label:`Sub Total (USD)`,value:n(m)(q.value.sub_total_usd)},null,8,[`value`]),s(h,{label:`Discount Amount`,value:n(m)(q.value.discount_amount)},null,8,[`value`]),n(W)?(l(),te(h,{key:0,label:`Total Profit`},{default:u(()=>[r(`div`,{class:f([`text-sm`,Z(q.value.total_profit)])},p(n(m)(q.value.total_profit)),3)]),_:1})):i(``,!0)])]),r(`div`,j,[c[24]||=r(`div`,{class:`flex items-center justify-between mb-4`},[r(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white`},` Sale Items `)],-1),q.value.items&&q.value.items.length===0?(l(),a(`div`,M,[s(n(le),{class:`mx-auto h-12 w-12 text-gray-400`}),c[7]||=r(`h5`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},`No items found`,-1),c[8]||=r(`p`,{class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},`This sale has no items.`,-1)])):(l(),a(`div`,N,[r(`table`,P,[r(`thead`,F,[r(`tr`,null,[c[9]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`#`,-1),c[10]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Code`,-1),c[11]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Item`,-1),c[12]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Unit`,-1),c[13]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[r(`abbr`,{title:`Total Quantity`},`QTY`)],-1),c[14]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Sale Price`,-1),c[15]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Cost Price`,-1),c[16]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[r(`abbr`,{title:`Discount Percentage`},`Dis. %`)],-1),c[17]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[r(`abbr`,{title:`Tax Percentage`},`Tax %`)],-1),c[18]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[r(`abbr`,{title:`Tax-inclusive Price`},`TTC`)],-1),c[19]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Total`,-1),c[20]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`USD`,-1),n(W)?(l(),a(`th`,I,`Profit`)):i(``,!0)])]),r(`tbody`,L,[(l(!0),a(ee,null,re(q.value.items,(e,t)=>(l(),a(`tr`,{key:t,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[r(`td`,R,p(t+1),1),r(`td`,z,p(e.item_code),1),r(`td`,he,p(e.item.description),1),r(`td`,ge,p(e.item.item_unit.name),1),r(`td`,_e,p(Q(e.quantity)),1),r(`td`,ve,p(n(m)(e.price)),1),r(`td`,ye,p(n(m)(e.cost_price)),1),r(`td`,be,p(Q(e.discount_percent))+`%`,1),r(`td`,xe,p(Q(e.tax_percent))+`%`,1),r(`td`,Se,p(Q(e.ttc_price)),1),r(`td`,Ce,p(n(m)(e.total_price)),1),r(`td`,we,p(n(m)(e.total_price_usd)),1),n(W)?(l(),a(`td`,{key:0,class:f([`px-6 py-4 whitespace-nowrap text-sm`,Z(e.unit_profit)])},p(n(m)(e.unit_profit)),3)):i(``,!0)]))),128))]),r(`tfoot`,Te,[r(`tr`,null,[c[21]||=r(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Sub Total:`,-1),r(`td`,Ee,p(n(m)(q.value.sub_total)),1),r(`td`,De,p(n(m)(q.value.sub_total_usd)),1),n(W)?(l(),a(`td`,{key:0,class:f([`px-6 py-4 text-sm font-medium`,Z(q.value.total_profit)])},p(n(m)(q.value.total_profit)),3)):i(``,!0)]),q.value.discount_amount&&Number(q.value.discount_amount)>0?(l(),a(`tr`,Oe,[c[22]||=r(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Additional Discount:`,-1),r(`td`,ke,`-`+p(n(m)(q.value.discount_amount)),1),r(`td`,Ae,`-`+p(n(m)(q.value.discount_amount_usd)),1),n(W)?(l(),a(`td`,je)):i(``,!0)])):i(``,!0),r(`tr`,Me,[c[23]||=r(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-bold text-gray-900 dark:text-white`},`Final Total:`,-1),r(`td`,Ne,p(n(m)(q.value.total)),1),r(`td`,Pe,p(n(m)(q.value.total_usd)),1),n(W)?(l(),a(`td`,{key:0,class:f([`px-6 py-4 text-sm font-bold`,Z(q.value.total_profit)])},p(n(m)(q.value.total_profit)),3)):i(``,!0)])])])]))]),r(`div`,Fe,[c[28]||=r(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Final Totals `,-1),r(`div`,Ie,[r(`div`,Le,[c[25]||=r(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount`,-1),r(`dd`,Re,p(n(m)(q.value.total)),1)]),r(`div`,ze,[c[26]||=r(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount (USD)`,-1),r(`dd`,Be,p(n(m)(q.value.total_usd)),1)]),n(W)?(l(),a(`div`,{key:0,class:f([`rounded-lg p-4`,rt(q.value.total_profit)])},[c[27]||=r(`dt`,{class:`text-sm font-medium`},`Total Profit (USD)`,-1),r(`dd`,Ve,p(n(m)(q.value.total_profit)),1)],2)):i(``,!0)])]),q.value.note?(l(),a(`div`,He,[c[29]||=r(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Notes `,-1),s(h,{label:`Note`},{default:u(()=>[r(`div`,Ue,[r(`p`,We,p(q.value.note),1)])]),_:1})])):i(``,!0),r(`div`,Ge,[r(`div`,Ke,[s(h,{label:`Created At`,value:$(q.value.created_at)},null,8,[`value`]),s(h,{label:`Last Updated`,value:$(q.value.updated_at)},null,8,[`value`])])])])]))]),s(fe,{show:J.value,"onUpdate:show":c[0]||=e=>J.value=e,type:`delete`,title:`Delete Sale ${q.value.prefix}-${q.value.code}`,message:`Are you sure you want to delete sale '${q.value.prefix}-${q.value.code}'? This action can be undone by restoring from trash.`,"confirm-text":`Delete Sale`,"loading-text":`Deleting...`,loading:Y.value,onConfirm:tt,onCancel:X},null,8,[`show`,`title`,`message`,`loading`])]))}}),V=B;export{V as default};
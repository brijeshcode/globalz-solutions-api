import{E as e,G as t,Q as n,_ as r,a$ as i,aC as a,aG as o,aH as ee,aO as s,aS as te,aU as c,aV as l,aW as ne,aX as re,aY as u,a_ as d,b0 as ie,b3 as ae,b5 as f,b6 as oe,bc as se,bd as p,bf as m,bg as h,bh as ce,bj as g,y as le}from"./index-BogmXPcL.js";import"./GlobalConfig-wPgXFcZ5.js";import{b as _}from"./StatCard-CZ1uUQrS.js";import{c as ue,f as de}from"./common-CZbH6H1Z.js";import"./tableUtils-dXs1kjAL.js";import{b as fe}from"./PageHeader-fwn1kRSK.js";import{b as v}from"./accountsStore-CkY2_KMu.js";import{b as y,d as b}from"./currencyUtil-Bk2vDNVl.js";const x={class:`space-y-6`},S=[`disabled`],C={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6`},w={class:`bg-white dark:bg-gray-800 shadow rounded-lg p-4`},T={class:`grid grid-cols-1 md:grid-cols-6 gap-4`},E={class:`md:col-span-2`},D={class:`relative`},O={class:`bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden`},k={key:0,class:`p-8 text-center`},A={key:1,class:`p-8 text-center`},j={class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},M={key:2,class:`overflow-x-auto`},N={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},P={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},F={class:`px-4 py-1 whitespace-nowrap`},I={class:`text-sm text-gray-900 dark:text-white`},L={class:`px-4 py-1 whitespace-nowrap`},R={class:`px-4 py-1 whitespace-nowrap`},z={class:`px-4 py-1 whitespace-nowrap`},B=[`onClick`],pe={key:1,class:`text-sm text-gray-900 dark:text-white`},me={class:`px-4 py-1 whitespace-nowrap`},he={class:`text-sm text-gray-900 dark:text-white`},ge={class:`px-4 py-1 whitespace-nowrap text-right`},_e={class:`text-sm font-medium text-red-600 dark:text-red-400`},ve={class:`px-4 py-1 whitespace-nowrap text-right`},ye={class:`text-sm font-medium text-green-600 dark:text-green-400`},be={class:`px-4 py-1 whitespace-nowrap text-right`};var V=ie({__name:`StatmentPage`,setup(ie){let V=o(),H=ee(),xe=a(),U=v(),W=c(()=>parseInt(V.params.id)),G=m(!1),K=m([]),q=m({}),J=m({}),Y=m(``),X=m(null),Z=m({search:``,from_date:``,to_date:``,withPage:!1}),Q=async()=>{try{G.value=!0;let e=await U.getAccountStatements(W.value,Z.value);K.value=e.data,q.value=e.stats}catch(e){xe.error(`Failed to load account statements`,{title:`Error`}),console.error(`Error fetching statements:`,e)}finally{G.value=!1}},Se=()=>{X.value&&clearTimeout(X.value),X.value=setTimeout(()=>{Q()},300)},$=()=>{Q()},Ce=()=>{Z.value={search:``,from_date:``,to_date:``,withPage:!1},Q()},we=e=>{let t={sales:`Sales`,payments:`Payment`,credit_note:`Credit Note`,debit_note:`Debit Note`,returns:`Return`,journal:`Journal Entry`,opening_balance:`Opening Balance`};return t[e]||e},Te=async()=>{try{J.value=await U.fetchAccount(W.value),Y.value=J.value.name}catch(e){console.error(`Error fetching account details:`,e)}},Ee=()=>{H.push({name:`accounts.statement.preview`,params:{id:W.value},query:{from_date:Z.value.from_date,to_date:Z.value.to_date,search:Z.value.search}})},De=e=>{if(e.transaction_type!=`opening_balance`&&(!e.id||!e.transaction_type))return;let t={customer_payment:`customer.payments.show`,expense:`expenses.transactions.view`,supplier_payment:`supplier.payments.show`,income:`incomes.transactions.view`,purchase:`purchases.view`,opening_balance:`accounts.view`};console.log(t[e.transaction_type]);let n=t[e.transaction_type];if(!n)return;let r=H.resolve({name:n,params:{id:e.id}});window.open(r.href,`_blank`)};return ae(async()=>{try{await Promise.all([Te(),Q()])}catch(e){console.error(`Error loading initial data:`,e)}}),(a,o)=>(f(),u(`div`,x,[i(fe,{title:`Account Statement - ${Y.value}`,description:`View account transaction history including debits, credits, and balance`,showCreateButton:!1},{actions:se(()=>[l(`button`,{onClick:Ee,disabled:K.value.length===0,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},[i(h(t),{class:`w-4 h-4 mr-2`}),o[3]||=d(` Print Preview `,-1)],8,S)]),_:1},8,[`title`]),l(`div`,C,[h(b)(J.value.currency?.code)?re(``,!0):(f(),ne(_,{key:0,label:`USD Value`,value:h(de)(q.value.balance_in_usd),icon:h(e),"icon-color":`blue`},null,8,[`value`,`icon`])),i(_,{label:`Balance`,value:h(y)(q.value.balance,!1,J.value.currency),icon:h(e),"icon-color":`blue`},null,8,[`value`,`icon`]),i(_,{label:`Credit`,value:h(y)(q.value.total_credit,!1,J.value.currency),icon:h(e),"icon-color":`green`},null,8,[`value`,`icon`]),i(_,{label:`Debit`,value:h(y)(q.value.total_debit,!1,J.value.currency),icon:h(e),"icon-color":`red`},null,8,[`value`,`icon`])]),l(`div`,w,[l(`div`,T,[l(`div`,E,[o[4]||=l(`label`,{for:`search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Search `,-1),l(`div`,D,[p(l(`input`,{id:`search`,"onUpdate:modelValue":o[0]||=e=>Z.value.search=e,type:`text`,placeholder:`Search note...`,class:`block w-full px-3 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 sm:text-sm transition-colors duration-200`,onInput:Se},null,544),[[s,Z.value.search]]),i(h(le),{class:`absolute left-3 top-2.5 h-5 w-5 text-gray-400`})])]),l(`div`,null,[o[5]||=l(`label`,{for:`from_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` From Date `,-1),p(l(`input`,{id:`from_date`,"onUpdate:modelValue":o[1]||=e=>Z.value.from_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:$},null,544),[[s,Z.value.from_date]])]),l(`div`,null,[o[6]||=l(`label`,{for:`to_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` To Date `,-1),p(l(`input`,{id:`to_date`,"onUpdate:modelValue":o[2]||=e=>Z.value.to_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:$},null,544),[[s,Z.value.to_date]])]),l(`div`,{class:`flex items-end`},[l(`button`,{onClick:Ce,class:`w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200`},` Clear `)])])]),l(`div`,O,[G.value?(f(),u(`div`,k,[i(h(n),{class:`h-8 w-8 animate-spin mx-auto text-blue-600 dark:text-blue-400`}),o[7]||=l(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},`Loading statements...`,-1)])):K.value.length===0?(f(),u(`div`,A,[i(h(r),{class:`h-12 w-12 mx-auto text-gray-400`}),o[8]||=l(`h3`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},` No statements found `,-1),l(`p`,j,g(Z.value.search?`Try adjusting your search criteria.`:`No transactions available for this account.`),1)])):(f(),u(`div`,M,[l(`table`,N,[o[9]||=l(`thead`,{class:`bg-gray-50 dark:bg-gray-700`},[l(`tr`,null,[l(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Date `),l(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Type `),l(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Name `),l(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Transaction ID `),l(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Note `),l(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Debit `),l(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Credit `),l(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Balance `)])],-1),l(`tbody`,P,[(f(!0),u(te,null,oe(K.value,e=>(f(),u(`tr`,{key:e.id,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[l(`td`,F,[l(`div`,I,g(h(ue)(e.date)),1)]),l(`td`,L,g(we(e.type)),1),l(`td`,R,g(e.name||`--`),1),l(`td`,z,[e.code?(f(),u(`div`,{key:0,onClick:t=>De(e),class:`text-sm text-blue-600 dark:text-blue-400 cursor-zoom-in hover:underline`},g(e.code),9,B)):(f(),u(`div`,pe,` - `))]),l(`td`,me,[l(`div`,he,g(e.note||`-`),1)]),l(`td`,ge,[l(`div`,_e,g(e.debit?h(y)(e.debit,!1,J.value.currency):`-`),1)]),l(`td`,ve,[l(`div`,ye,g(e.credit?h(y)(e.credit,!1,J.value.currency):`-`),1)]),l(`td`,be,[l(`div`,{class:ce([`text-sm font-medium`,e.balance>=0?`text-green-600 dark:text-green-400`:`text-red-600 dark:text-red-400`])},g(h(y)(e.balance,!1,J.value.currency)),3)])]))),128))])])]))])]))}}),H=V;export{H as default};
import{I as e,S as t,a$ as n,aD as r,aF as i,aG as a,aH as ee,aI as te,aJ as o,aL as s,aM as c,aN as ne,aP as re,aR as l,aS as ie,aY as ae,aZ as u,an as oe,ar as se,as as ce,az as d,b0 as f,b1 as le,b3 as p,s as ue,x as m,z as de}from"./index-I6Ll8fg7.js";import"./GlobalConfig-Dep5CV3r.js";import{c as fe}from"./accountsStore-D6_fFvUt.js";import"./tableUtils-BFc6-TYF.js";import{b as pe}from"./PageHeader-BhStYyPB.js";import{c as me,f as h}from"./common-DNevajli.js";import{b as g}from"./StatCard-wD1UlMGd.js";import{b as _,d as v}from"./currencyUtil-fU26E72S.js";const y={class:`space-y-6`},b=[`disabled`],x={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6`},S={class:`bg-white dark:bg-gray-800 shadow rounded-lg p-4`},C={class:`grid grid-cols-1 md:grid-cols-6 gap-4`},w={class:`md:col-span-2`},T={class:`relative`},E={class:`bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden`},D={key:0,class:`p-8 text-center`},O={key:1,class:`p-8 text-center`},k={class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},A={key:2,class:`overflow-x-auto`},j={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},M={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},N={class:`px-4 py-1 whitespace-nowrap`},P={class:`text-sm text-gray-900 dark:text-white`},F={class:`px-4 py-1 whitespace-nowrap`},I={class:`px-4 py-1 whitespace-nowrap`},L=[`onClick`],R={key:1,class:`text-sm text-gray-900 dark:text-white`},z={class:`px-4 py-1 whitespace-nowrap`},he={class:`text-sm text-gray-900 dark:text-white`},ge={class:`px-4 py-1 whitespace-nowrap text-right`},_e={class:`text-sm font-medium text-red-600 dark:text-red-400`},ve={class:`px-4 py-1 whitespace-nowrap text-right`},ye={class:`text-sm font-medium text-green-600 dark:text-green-400`},be={class:`px-4 py-1 whitespace-nowrap text-right`};var B=ne({__name:`StatmentPage`,setup(ne){let B=se(),V=ce(),xe=oe(),H=fe(),U=i(()=>parseInt(B.params.id)),W=n(!1),G=n([]),K=n({}),q=n({}),J=n(``),Y=n(null),X=n({search:``,from_date:``,to_date:``,withPage:!1}),Z=async()=>{try{W.value=!0;let e=await H.getAccountStatements(U.value,X.value);G.value=e.data,K.value=e.stats}catch(e){xe.error(`Failed to load account statements`,{title:`Error`}),console.error(`Error fetching statements:`,e)}finally{W.value=!1}},Se=()=>{Y.value&&clearTimeout(Y.value),Y.value=setTimeout(()=>{Z()},300)},Q=()=>{Z()},Ce=()=>{X.value={search:``,from_date:``,to_date:``,withPage:!1},Z()},$=e=>{let t={sales:`Sales`,payments:`Payment`,credit_note:`Credit Note`,debit_note:`Debit Note`,returns:`Return`,journal:`Journal Entry`,opening_balance:`Opening Balance`};return t[e]||e},we=async()=>{try{q.value=await H.fetchAccount(U.value),J.value=q.value.name}catch(e){console.error(`Error fetching account details:`,e)}},Te=()=>{V.push({name:`accounts.statement.preview`,params:{id:U.value},query:{from_date:X.value.from_date,to_date:X.value.to_date,search:X.value.search}})},Ee=e=>{if(!e.id||!e.transaction_type)return;let t={customer_payment:`customer.payments.show`,expense:`expenses.transactions.view`,purchase:`purchases.view`,opening_balance:``},n=t[e.transaction_type];if(!n)return;let r=V.resolve({name:n,params:{id:e.id}});window.open(r.href,`_blank`)};return re(async()=>{try{await Promise.all([we(),Z()])}catch(e){console.error(`Error loading initial data:`,e)}}),(n,i)=>(l(),o(`div`,y,[c(pe,{title:`Account Statement - ${J.value}`,description:`View account transaction history including debits, credits, and balance`,showCreateButton:!1},{actions:ae(()=>[a(`button`,{onClick:Te,disabled:G.value.length===0,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},[c(f(de),{class:`w-4 h-4 mr-2`}),i[3]||=s(` Print Preview `,-1)],8,b)]),_:1},8,[`title`]),a(`div`,x,[f(v)(q.value.currency?.code)?te(``,!0):(l(),ee(g,{key:0,label:`USD Value`,value:f(h)(K.value.balance_in_usd),icon:f(m),"icon-color":`blue`},null,8,[`value`,`icon`])),c(g,{label:`Balance`,value:f(h)(K.value.balance),icon:f(m),"icon-color":`blue`},null,8,[`value`,`icon`]),c(g,{label:`Credit`,value:f(h)(K.value.total_credit),icon:f(m),"icon-color":`green`},null,8,[`value`,`icon`]),c(g,{label:`Debit`,value:f(h)(K.value.total_debit),icon:f(m),"icon-color":`red`},null,8,[`value`,`icon`])]),a(`div`,S,[a(`div`,C,[a(`div`,w,[i[4]||=a(`label`,{for:`search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Search `,-1),a(`div`,T,[u(a(`input`,{id:`search`,"onUpdate:modelValue":i[0]||=e=>X.value.search=e,type:`text`,placeholder:`Search note...`,class:`block w-full px-3 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 sm:text-sm transition-colors duration-200`,onInput:Se},null,544),[[d,X.value.search]]),c(f(ue),{class:`absolute left-3 top-2.5 h-5 w-5 text-gray-400`})])]),a(`div`,null,[i[5]||=a(`label`,{for:`from_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` From Date `,-1),u(a(`input`,{id:`from_date`,"onUpdate:modelValue":i[1]||=e=>X.value.from_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:Q},null,544),[[d,X.value.from_date]])]),a(`div`,null,[i[6]||=a(`label`,{for:`to_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` To Date `,-1),u(a(`input`,{id:`to_date`,"onUpdate:modelValue":i[2]||=e=>X.value.to_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:Q},null,544),[[d,X.value.to_date]])]),a(`div`,{class:`flex items-end`},[a(`button`,{onClick:Ce,class:`w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200`},` Clear `)])])]),a(`div`,E,[W.value?(l(),o(`div`,D,[c(f(e),{class:`h-8 w-8 animate-spin mx-auto text-blue-600 dark:text-blue-400`}),i[7]||=a(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},`Loading statements...`,-1)])):G.value.length===0?(l(),o(`div`,O,[c(f(t),{class:`h-12 w-12 mx-auto text-gray-400`}),i[8]||=a(`h3`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},` No statements found `,-1),a(`p`,k,p(X.value.search?`Try adjusting your search criteria.`:`No transactions available for this account.`),1)])):(l(),o(`div`,A,[a(`table`,j,[i[9]||=a(`thead`,{class:`bg-gray-50 dark:bg-gray-700`},[a(`tr`,null,[a(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Date `),a(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Type `),a(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Transaction ID `),a(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Note `),a(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Debit `),a(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Credit `),a(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Balance `)])],-1),a(`tbody`,M,[(l(!0),o(r,null,ie(G.value,e=>(l(),o(`tr`,{key:e.id,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[a(`td`,N,[a(`div`,P,p(f(me)(e.date)),1)]),a(`td`,F,p($(e.type)),1),a(`td`,I,[e.code?(l(),o(`div`,{key:0,onClick:t=>Ee(e),class:`text-sm text-blue-600 dark:text-blue-400 cursor-zoom-in hover:underline`},p(e.code),9,L)):(l(),o(`div`,R,` - `))]),a(`td`,z,[a(`div`,he,p(e.note||`-`),1)]),a(`td`,ge,[a(`div`,_e,p(e.debit?f(_)(e.debit,!0):`-`),1)]),a(`td`,ve,[a(`div`,ye,p(e.credit?f(_)(e.credit,!0):`-`),1)]),a(`td`,be,[a(`div`,{class:le([`text-sm font-medium`,e.balance>=0?`text-green-600 dark:text-green-400`:`text-red-600 dark:text-red-400`])},p(f(_)(e.balance,!0)),3)])]))),128))])])]))])]))}}),V=B;export{V as default};
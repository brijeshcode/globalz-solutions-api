import{C as e,N as t,X as n,a$ as r,aC as i,aD as ee,aK as a,aO as te,aQ as ne,aR as o,aU as s,aX as c,aY as re,au as l,ay as ie,b1 as u,b2 as ae,b8 as oe,b9 as d,bb as f,bc as p,bd as se,bf as m,x as ce}from"./index-BsiRFf-z.js";import"./GlobalConfig-wPgXFcZ5.js";import{b as h}from"./StatCard-Cpv8xnh7.js";import{c as le}from"./common-CZbH6H1Z.js";import"./tableUtils-dXs1kjAL.js";import{b as ue}from"./PageHeader-DxszpCRg.js";import{b as g}from"./currencyUtil-BgG2HgTe.js";import{c as de}from"./suppliersStore-DRg_DNzK.js";var _=class{baseUrl=`/suppliers`;async getStatements(e){try{let t=this.buildQueryParams(e),n=await l(`${this.baseUrl}/statements?${t}`,{loadingMessage:`Loading statements...`,showLoading:!0});return{data:n.data.data,pagination:n.data.pagination,stats:n.data.stats||[]}}catch(e){throw console.error(`Error fetching statements:`,e),e}}async getSupplierStatements(e,t){try{let n=this.buildQueryParams(t),r=await l(`${this.baseUrl}/statements/${e}?${n}`,{loadingMessage:`Loading supplier statements...`,showLoading:!0});return{data:r.data.data,pagination:r.data.pagination,stats:r.data.stats||[]}}catch(e){throw console.error(`Error fetching supplier statements:`,e),e}}buildQueryParams(e){if(!e)return``;let t=new URLSearchParams;return Object.entries(e).forEach(([e,n])=>{n!=null&&n!==``&&t.append(e,String(n))}),t.toString()}};const v=new _,y={class:`space-y-6`},b={class:`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6`},x={class:`bg-white dark:bg-gray-800 shadow rounded-lg p-4`},S={class:`grid grid-cols-1 md:grid-cols-6 gap-4`},C={class:`md:col-span-2`},w={class:`relative`},T={class:`bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden`},E={key:0,class:`p-8 text-center`},D={key:1,class:`p-8 text-center`},O={class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},k={key:2,class:`overflow-x-auto`},A={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},j={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},M={class:`px-4 py-1 whitespace-nowrap`},N={class:`text-sm text-gray-900 dark:text-white`},P={class:`px-4 py-1 whitespace-nowrap`},F={class:`px-4 py-1 whitespace-nowrap`},I=[`onClick`],L={key:1,class:`text-sm text-gray-900 dark:text-white`},fe={class:`px-4 py-1 whitespace-nowrap`},R={class:`text-sm text-gray-900 dark:text-white`},z={class:`px-4 py-1 whitespace-nowrap text-right`},B={class:`text-sm font-medium text-red-600 dark:text-red-400`},V={class:`px-4 py-1 whitespace-nowrap text-right`},pe={class:`text-sm font-medium text-green-600 dark:text-green-400`},me={class:`px-4 py-1 whitespace-nowrap text-right`};var H=re({__name:`StatementPage`,setup(re){let l=i(),_=ee(),H=ie(),U=de(),W=ne(()=>parseInt(l.params.id)),G=f(!1),K=f([]),q=f([]),J=f(``),Y=f(null),X=f({search:``,from_date:``,to_date:``,transaction_type:``,withPage:!1}),Z=async()=>{try{G.value=!0;let e=await v.getSupplierStatements(W.value,X.value);K.value=e.data,q.value=e.stats}catch(e){H.error(`Failed to load supplier statements`,{title:`Error`}),console.error(`Error fetching statements:`,e)}finally{G.value=!1}},he=()=>{Y.value&&clearTimeout(Y.value),Y.value=setTimeout(()=>{Z()},300)},Q=()=>{Z()},ge=()=>{X.value={search:``,from_date:``,to_date:``,transaction_type:``,withPage:!1},Z()},$=e=>{let t={purchase:`Purchase`,payments:`Payment`,credit_note:`Credit Note`,debit_note:`Debit Note`,returns:`Return`};return t[e]||e},_e=async()=>{try{let e=await U.fetchSupplier(W.value);J.value=e.name}catch(e){console.error(`Error fetching supplier details:`,e)}},ve=e=>{if(!e.id||!e.transaction_type)return;let t={purchase:`purchases.view`,payment:`supplier.payments.show`,credit_debit_note:`supplier.notes.show`,purchase_returns:`purchase-returns.view`},n=t[e.transaction_type];if(!n)return;let r=_.resolve({name:n,params:{id:e.id}});window.open(r.href,`_blank`)};return r(async()=>{try{await Promise.all([_e(),Z()])}catch(e){console.error(`Error loading initial data:`,e)}}),(r,i)=>(u(),s(`div`,y,[c(ue,{title:`Supplier Statement - ${J.value}`,description:`View supplier transaction history including purchases, payments, and notes`,showCreateButton:!1},{actions:oe(()=>i[3]||=[]),_:1},8,[`title`]),o(`div`,b,[c(h,{label:`Balance`,value:p(g)(q.value.balance),icon:p(e),"icon-color":`blue`},null,8,[`value`,`icon`]),c(h,{label:`Credit`,value:p(g)(q.value.total_credit),icon:p(e),"icon-color":`green`},null,8,[`value`,`icon`]),c(h,{label:`Debit`,value:p(g)(q.value.total_debit),icon:p(e),"icon-color":`red`},null,8,[`value`,`icon`])]),o(`div`,x,[o(`div`,S,[o(`div`,C,[i[4]||=o(`label`,{for:`search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Search `,-1),o(`div`,w,[d(o(`input`,{id:`search`,"onUpdate:modelValue":i[0]||=e=>X.value.search=e,type:`text`,placeholder:`Search note...`,class:`block w-full px-3 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 sm:text-sm transition-colors duration-200`,onInput:he},null,544),[[a,X.value.search]]),c(p(ce),{class:`absolute left-3 top-2.5 h-5 w-5 text-gray-400`})])]),o(`div`,null,[i[5]||=o(`label`,{for:`from_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` From Date `,-1),d(o(`input`,{id:`from_date`,"onUpdate:modelValue":i[1]||=e=>X.value.from_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:Q},null,544),[[a,X.value.from_date]])]),o(`div`,null,[i[6]||=o(`label`,{for:`to_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` To Date `,-1),d(o(`input`,{id:`to_date`,"onUpdate:modelValue":i[2]||=e=>X.value.to_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:Q},null,544),[[a,X.value.to_date]])]),o(`div`,{class:`flex items-end`},[o(`button`,{onClick:ge,class:`w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200`},` Clear `)])])]),o(`div`,T,[G.value?(u(),s(`div`,E,[c(p(t),{class:`h-8 w-8 animate-spin mx-auto text-blue-600 dark:text-blue-400`}),i[7]||=o(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},`Loading statements...`,-1)])):K.value.length===0?(u(),s(`div`,D,[c(p(n),{class:`h-12 w-12 mx-auto text-gray-400`}),i[8]||=o(`h3`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},` No statements found `,-1),o(`p`,O,m(X.value.search||X.value.transaction_type?`Try adjusting your search criteria.`:`No transactions available for this supplier.`),1)])):(u(),s(`div`,k,[o(`table`,A,[i[9]||=o(`thead`,{class:`bg-gray-50 dark:bg-gray-700`},[o(`tr`,null,[o(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Date `),o(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Type `),o(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Transaction ID `),o(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Note `),o(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Debit `),o(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Credit `),o(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Balance `)])],-1),o(`tbody`,j,[(u(!0),s(te,null,ae(K.value,e=>(u(),s(`tr`,{key:e.id,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[o(`td`,M,[o(`div`,N,m(p(le)(e.date)),1)]),o(`td`,P,m($(e.type)),1),o(`td`,F,[e.code?(u(),s(`div`,{key:0,onClick:t=>ve(e),class:`text-sm text-blue-600 dark:text-blue-400 cursor-zoom-in hover:underline`},m(e.code),9,I)):(u(),s(`div`,L,` - `))]),o(`td`,fe,[o(`div`,R,m(e.note||`-`),1)]),o(`td`,z,[o(`div`,B,m(e.debit?p(g)(e.debit,!0):`-`),1)]),o(`td`,V,[o(`div`,pe,m(e.credit?p(g)(e.credit,!0):`-`),1)]),o(`td`,me,[o(`div`,{class:se([`text-sm font-medium`,e.balance>=0?`text-green-600 dark:text-green-400`:`text-red-600 dark:text-red-400`])},m(p(g)(e.balance,!0)),3)])]))),128))])])]))])]))}}),U=H;export{U as default};
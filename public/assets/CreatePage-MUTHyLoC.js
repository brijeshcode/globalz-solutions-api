import{I as e,Q as t,a$ as n,aC as r,aH as i,aN as a,aO as o,aR as s,aS as c,aU as l,aV as u,aW as d,aX as f,aY as p,a_ as m,ao as ee,b0 as te,b3 as ne,b5 as h,b6 as g,bb as _,bd as v,be as re,bf as y,bg as b,bh as ie,bj as x,d as ae,s as oe,z as se}from"./index-Bbnq3hOa.js";import{b as ce}from"./useAuth-qXEospJa.js";import"./GlobalConfig-wPgXFcZ5.js";import{c as S}from"./common-CZbH6H1Z.js";import"./tableUtils-dXs1kjAL.js";import{d as C}from"./currencyUtil-CTYSvgFA.js";import{b as le}from"./CurrencyRateInput-ycef2QgY.js";import{b as ue}from"./customerReturnOrdersStore-DYmBaMqH.js";const de={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8`},fe={class:``},pe={class:`mb-8`},me={class:`flex items-center space-x-4 mb-2`},he={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},ge={class:`px-6 py-8`},_e={class:`border-b border-gray-200 dark:border-gray-700 pb-6`},ve={class:`grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6`},ye={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},be=[`disabled`],xe={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Se={for:`customer_id`,class:`text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex gap-2`},Ce=[`disabled`],we=[`value`],Te={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Ee={key:0},De=[`disabled`],Oe=[`value`],ke={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Ae=[`disabled`],je=[`value`],Me={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Ne=[`disabled`],Pe=[`value`],Fe={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Ie={class:`border-b border-gray-200 dark:border-gray-700 pb-6`},Le={id:`item-add-form`,class:`mb-6`},Re={class:`mb-4 w-1/2`},ze={for:`item-select`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},Be=[`disabled`],Ve={value:null},He=[`value`],Ue={key:0,class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},We={key:0,class:`mb-4`},Ge={class:`bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md p-3`},Ke={class:`text-sm text-blue-800 dark:text-blue-200`},qe={class:`ml-2`},Je={class:`ml-3`},Ye={key:0,class:`text-sm text-amber-700 dark:text-amber-400 mt-1`},Xe={class:`font-medium`},Ze={key:1,class:`mb-4`},Qe={class:`overflow-x-auto border border-gray-300 dark:border-gray-600 rounded-md`},$e={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},et={class:`bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600`},tt=[`onClick`],nt={class:`px-3 py-2 whitespace-nowrap text-sm`},rt=[`value`,`checked`],it={class:`px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100`},at={class:`px-3 py-2 whitespace-nowrap text-sm`},ot=[`onClick`],st={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},ct={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},lt={class:`px-3 py-2 whitespace-nowrap text-sm text-right font-medium text-green-600 dark:text-green-400`},ut={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},dt={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},ft={key:2,class:`grid grid-cols-1 md:grid-cols-3 gap-4 mb-4`},pt=[`max`],mt={class:`mt-1 text-xs text-gray-500 dark:text-gray-400`},ht={class:`md:col-span-2`},gt={key:3},_t={key:0,id:`item-list`,class:`mt-6`},vt={class:`overflow-x-auto border border-gray-300 dark:border-gray-600 rounded-md`},yt={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},bt={class:`bg-gray-50 dark:bg-gray-800`},xt={key:0,class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},St={key:1,class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},Ct={class:`bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600`},wt={class:`px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100`},Tt={class:`px-3 py-2 text-sm text-gray-900 dark:text-gray-100`},Et={class:`text-xs text-gray-500 dark:text-gray-400`},Dt={key:0,class:`text-xs text-gray-500 dark:text-gray-400 italic`},Ot={class:`px-3 py-2 text-sm text-gray-900 dark:text-gray-100`},kt=[`onClick`],At={class:`text-xs text-gray-500 dark:text-gray-400`},jt={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},Mt={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},Nt={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},Pt={key:0,class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},Ft={key:1,class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},It={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},Lt={class:`px-3 py-2 whitespace-nowrap text-sm text-center`},Rt=[`onClick`],zt={class:`bg-gray-50 dark:bg-gray-800`},Bt={class:`px-3 py-2 whitespace-nowrap text-sm text-right font-bold text-gray-900 dark:text-gray-100`},Vt={class:`border-b border-gray-200 dark:border-gray-700 pb-6`},Ht={class:`grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6`},Ut={class:`pb-6`},Wt={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Gt={class:`flex items-center justify-end space-x-4 pt-6 border-t border-gray-200 dark:border-gray-700`},Kt=[`disabled`],qt=[`disabled`];var w=te({__name:`CreatePage`,setup(te){let w=i(),T=r(),E=ue(),D=ae(),{isAdmin:Jt,isSalesman:O,user:Yt}=ce(),k=y(!1),A=y(!1),j=y(!1),M=y({}),N=y(null),P=y([]),F=y({selectedItemId:null,selectedSaleItemId:null,quantity:1,note:``}),I=y(!1),L=re({date:new Date().toISOString().split(`T`)[0],prefix:`RTN`,customer_id:null,salesperson_id:O?Yt.value?.id:null,currency_id:null,warehouse_id:null,currency_rate:1,total:0,total_usd:0,total_volume_cbm:0,total_weight_kg:0,note:``,items:[]}),R=l(()=>D.customers),Xt=l(()=>D.salesEmployees),z=l(()=>D.currencies),B=l(()=>D.warehouses),V=l(()=>F.value.selectedItemId?P.value.find(e=>e.item_id===F.value.selectedItemId):null),H=l(()=>{let e=V.value?.sales||[];return e.filter(e=>e.can_return&&e.available_quantity>0)}),U=l(()=>H.value.filter(e=>e.sale_prefix===`INV`).length),W=l(()=>H.value.filter(e=>e.sale_prefix===`INX`).length),G=l(()=>H.value.filter(e=>!(L.prefix===`RTX`&&e.sale_prefix!==`INX`||L.prefix===`RTN`&&e.sale_prefix!==`INV`))),K=l(()=>F.value.selectedSaleItemId?G.value.find(e=>e.sale_item_id===F.value.selectedSaleItemId):null),Zt=l(()=>C(N.value?.code)),q=l(()=>L.prefix===`RTX`),J=l(()=>!!(L.date&&L.prefix&&L.customer_id&&L.currency_id&&L.warehouse_id&&L.total>=0&&L.total_usd>=0&&L.items.length>0&&L.items.every(e=>e.sale_item_id&&e.quantity>0))),Qt=async()=>{if(!L.customer_id){P.value=[];return}try{j.value=!0;let e=await E.fetchSaleItemsForReturn({customer_id:L.customer_id});P.value=e?.items||[]}catch(e){console.error(`Error fetching sale items:`,e),T.error(`Failed to load sale items for return`),P.value=[]}finally{j.value=!1}},$t=()=>{F.value.selectedItemId?(I.value=!0,F.value.selectedSaleItemId=null,F.value.quantity=1):I.value=!1},en=e=>{F.value.selectedSaleItemId=e,F.value.quantity=1},tn=()=>{if(!K.value){T.error(`Please select a sale transaction`);return}if(F.value.quantity<=0){T.error(`Quantity must be greater than 0`);return}if(F.value.quantity>K.value.available_quantity){T.error(`Quantity cannot exceed available quantity (${K.value.available_quantity})`);return}let e=L.items.filter(e=>e.sale_item_id===F.value.selectedSaleItemId).reduce((e,t)=>e+t.quantity,0);if(e+F.value.quantity>K.value.available_quantity){T.error(`Total quantity for this sale item cannot exceed ${K.value.available_quantity}. Already added: ${e}`);return}let t={sale_item_id:F.value.selectedSaleItemId,item_id:V.value.item_id,item_code:V.value.item_code,quantity:F.value.quantity,price:K.value.price,price_usd:K.value.price_usd,discount_percent:K.value.discount_percent,tax_percent:q.value?0:K.value.tax_percent,tax_label:q.value?null:K.value.tax_label,ttc_price:K.value.ttc_price,ttc_price_usd:K.value.ttc_price_usd,unit_discount_amount:K.value.unit_discount_amount,unit_discount_amount_usd:K.value.unit_discount_amount_usd,total_price:K.value.ttc_price*F.value.quantity,total_price_usd:K.value.ttc_price_usd*F.value.quantity,note:F.value.note||null,sale_code:K.value.sale_code,sale_id:K.value.sale_id,sale_prefix:K.value.sale_prefix,sale_date:S(K.value.sale_date),item_name:V.value.item?.description||V.value.item?.code,item_unit:V.value.item?.itemUnit?.name||``};L.items.length===1&&!L.items[0].sale_item_id&&(L.items=[]),L.items.push(t),F.value={selectedItemId:null,selectedSaleItemId:null,quantity:1,note:``},I.value=!1,X(),T.success(`Item added successfully`)},nn=e=>{L.items.splice(e,1),X()},Y=e=>e?parseFloat(Number(e).toFixed(2)).toString():`0`,X=()=>{let e=L.items.reduce((e,t)=>e+(t.total_price||0),0),t=L.items.reduce((e,t)=>e+(t.total_price_usd||0),0);L.total=e,L.total_usd=t;let n=L.items.reduce((e,t)=>e+(t.total_volume_cbm||0),0),r=L.items.reduce((e,t)=>e+(t.total_weight_kg||0),0);L.total_volume_cbm=n,L.total_weight_kg=r},Z=()=>{N.value=z.value.find(e=>e.id==L.currency_id),N.value&&(L.currency_rate=N.value.active_rate?.rate*1||1)},rn=async()=>{let e=R.value.find(e=>e.id===L.customer_id);e&&e.salesperson_id&&(L.salesperson_id=e.salesperson_id),L.items=[],F.value={selectedItemId:null,selectedSaleItemId:null,quantity:1,note:``},I.value=!1,await Qt(),X()},an=async()=>{if(J.value){k.value=!0,M.value={};try{let e={date:L.date,prefix:L.prefix,customer_id:L.customer_id,salesperson_id:L.salesperson_id,currency_id:L.currency_id,warehouse_id:L.warehouse_id,currency_rate:L.currency_rate,total:L.total,total_usd:L.total_usd,total_volume_cbm:L.total_volume_cbm,total_weight_kg:L.total_weight_kg,note:L.note,items:L.items.map(e=>({sale_item_id:e.sale_item_id,quantity:e.quantity,note:e.note}))},t=await E.createReturnOrder(e);T.success(`Return order created successfully`),w.push({name:`customer.return-orders.show`,params:{id:t.id.toString()}})}catch(e){e.errors&&(M.value=e.errors),console.log(M.value),T.error(`Failed to create return order`)}finally{k.value=!1}}},Q=()=>{w.push({name:`customer.return-orders.index`})},$=e=>{let t=w.resolve({name:`sales.show`,params:{id:e.toString()}});window.open(t.href,`_blank`)};return ne(async()=>{A.value=!0;try{let e=[];if(D.customers.length===0&&e.push(D.fetchCustomers()),D.salesEmployees.length===0&&e.push(D.fetchSalesEmployees()),D.currencies.length===0&&e.push(D.fetchCurrencies()),D.warehouses.length===0&&e.push(D.fetchWarehouses()),await Promise.all(e),D.currencies?.length&&!L.currency_id){let e=D.currencies.find(e=>C(e.code));e&&(L.currency_id=e.id,Z())}z.value.length===1&&(L.currency_id=z.value[0].id),B.value.length===1&&(L.warehouse_id=B.value[0].id)}catch{T.error(`Failed to load form data`)}finally{A.value=!1}}),_(()=>L.currency_id,()=>{Z()}),_(()=>L.prefix,()=>{F.value.selectedItemId=null,F.value.selectedSaleItemId=null,F.value.quantity=1,F.value.note=``,I.value=!1,L.items.splice(0,L.items.length),X()}),(r,i)=>(h(),p(`div`,de,[u(`div`,fe,[u(`div`,pe,[u(`div`,me,[u(`button`,{onClick:Q,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[n(b(ee),{class:`w-5 h-5`})]),i[13]||=u(`div`,null,[u(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},` Create Return Order `),u(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},` Create a new customer return order request `)],-1)])]),u(`div`,he,[u(`div`,ge,[u(`form`,{onSubmit:s(an,[`prevent`]),class:`space-y-6`},[u(`div`,_e,[i[26]||=u(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Return Information `,-1),u(`div`,ve,[u(`div`,null,[i[15]||=u(`label`,{for:`prefix`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[m(` Prefix `),u(`span`,{class:`text-red-500 ml-1`},`*`)],-1),v(u(`select`,{id:`prefix`,"onUpdate:modelValue":i[0]||=e=>L.prefix=e,required:``,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},i[14]||=[u(`option`,{value:`RTN`},`RTN`,-1),u(`option`,{value:`RTX`},`RTX`,-1)],512),[[a,L.prefix]]),M.value.prefix?(h(),p(`p`,ye,x(M.value.prefix),1)):f(``,!0)]),u(`div`,null,[i[16]||=u(`label`,{for:`date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[m(` Return Date `),u(`span`,{class:`text-red-500 ml-1`},`*`)],-1),v(u(`input`,{id:`date`,"onUpdate:modelValue":i[1]||=e=>L.date=e,type:`date`,disabled:k.value,required:``,class:`block w-full rounded-md border-0 py-2 px-3 text-gray-900 dark:text-gray-100 shadow-sm ring-1 ring-inset ring-gray-300 dark:ring-gray-600 placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6 transition-colors duration-200 bg-white dark:bg-gray-700`},null,8,be),[[o,L.date]]),M.value.date?(h(),p(`p`,xe,x(M.value.date),1)):f(``,!0)]),u(`div`,null,[u(`label`,Se,[i[17]||=m(` Customer `,-1),i[18]||=u(`span`,{class:`text-red-500 ml-1`},`*`,-1),u(`span`,null,[k.value||A.value?(h(),d(b(t),{key:0,class:`h-4 w-4 animate-spin mr-2`})):f(``,!0)])]),v(u(`select`,{id:`customer_id`,"onUpdate:modelValue":i[2]||=e=>L.customer_id=e,required:``,onChange:rn,disabled:k.value||A.value,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},[i[19]||=u(`option`,{value:``},`Select Customer`,-1),(h(!0),p(c,null,g(R.value,e=>(h(),p(`option`,{key:e.id,value:e.id},x(e.name),9,we))),128))],40,Ce),[[a,L.customer_id]]),M.value.customer_id?(h(),p(`p`,Te,x(M.value.customer_id),1)):f(``,!0)]),b(O)?f(``,!0):(h(),p(`div`,Ee,[i[21]||=u(`label`,{for:`salesperson_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Salesperson `,-1),v(u(`select`,{id:`salesperson_id`,"onUpdate:modelValue":i[3]||=e=>L.salesperson_id=e,disabled:k.value||A.value||b(O),class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},[i[20]||=u(`option`,{value:``},`Select Salesperson`,-1),(h(!0),p(c,null,g(Xt.value,e=>(h(),p(`option`,{key:e.id,value:e.id},x(e.name),9,Oe))),128))],8,De),[[a,L.salesperson_id]]),M.value.salesperson_id?(h(),p(`p`,ke,x(M.value.salesperson_id),1)):f(``,!0)])),u(`div`,null,[i[23]||=u(`label`,{for:`currency_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[m(` Currency `),u(`span`,{class:`text-red-500 ml-1`},`*`)],-1),v(u(`select`,{id:`currency_id`,"onUpdate:modelValue":i[4]||=e=>L.currency_id=e,required:``,disabled:k.value||A.value,onChange:Z,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},[i[22]||=u(`option`,{value:``},`Select Currency`,-1),(h(!0),p(c,null,g(z.value,e=>(h(),p(`option`,{key:e.id,value:e.id},x(e.name)+` (`+x(e.code)+`) `,9,je))),128))],40,Ae),[[a,L.currency_id]]),M.value.currency_id?(h(),p(`p`,Me,x(M.value.currency_id),1)):f(``,!0)]),N.value&&!Zt.value?(h(),d(le,{key:1,modelValue:L.currency_rate,"onUpdate:modelValue":i[5]||=e=>L.currency_rate=e,modelModifiers:{number:!0},error:M.value.currency_rate,disabled:k.value,loading:k.value,loadingDropdowns:A.value},null,8,[`modelValue`,`error`,`disabled`,`loading`,`loadingDropdowns`])):f(``,!0),u(`div`,null,[i[25]||=u(`label`,{for:`warehouse_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[m(` Warehouse `),u(`span`,{class:`text-red-500 ml-1`},`*`)],-1),v(u(`select`,{id:`warehouse_id`,"onUpdate:modelValue":i[6]||=e=>L.warehouse_id=e,required:``,disabled:k.value||A.value,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},[i[24]||=u(`option`,{value:``},`Select Warehouse`,-1),(h(!0),p(c,null,g(B.value,e=>(h(),p(`option`,{key:e.id,value:e.id},x(e.name),9,Pe))),128))],8,Ne),[[a,L.warehouse_id]]),M.value.warehouse_id?(h(),p(`p`,Fe,x(M.value.warehouse_id),1)):f(``,!0)])])]),u(`div`,Ie,[i[45]||=u(`div`,{class:`flex justify-between items-center mb-4`},[u(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},` Return Items `)],-1),u(`div`,Le,[u(`div`,Re,[u(`label`,ze,[i[27]||=m(` Select Item `,-1),u(`span`,null,[j.value?(h(),d(b(t),{key:0,class:`h-4 w-4 animate-spin inline ml-2`})):f(``,!0)])]),v(u(`select`,{id:`item-select`,"onUpdate:modelValue":i[7]||=e=>F.value.selectedItemId=e,onChange:$t,disabled:!L.customer_id||j.value||P.value.length===0,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},[u(`option`,Ve,x(L.customer_id?`Select an item`:`Select customer first`),1),(h(!0),p(c,null,g(P.value,e=>(h(),p(`option`,{key:e.item_id,value:e.item_id},x(e.item_code)+` - `+x(e.item?.description||e.item?.short_name)+` (Available: `+x(e.total_available)+`) `,9,He))),128))],40,Be),[[a,F.value.selectedItemId]]),L.customer_id&&P.value.length===0&&!j.value?(h(),p(`p`,Ue,` No items available for return from this customer `)):f(``,!0)]),I.value&&V.value?(h(),p(`div`,We,[u(`div`,Ge,[u(`p`,Ke,[i[28]||=u(`span`,{class:`font-medium`},`Available sales for this item:`,-1),u(`span`,qe,`INV: `+x(U.value),1),u(`span`,Je,`INX: `+x(W.value),1)]),G.value.length===0?(h(),p(`p`,Ye,[u(`span`,Xe,`âš  No `+x(L.prefix===`RTN`?`INV`:`INX`)+` sales found for the selected prefix (`+x(L.prefix)+`).`,1),m(` `+x(L.prefix===`RTN`&&W.value>0?` Try switching to RTX prefix to return INX sales.`:``)+` `+x(L.prefix===`RTX`&&U.value>0?` Try switching to RTN prefix to return INV sales.`:``),1)])):f(``,!0)])])):f(``,!0),I.value&&G.value.length>0?(h(),p(`div`,Ze,[i[30]||=u(`h4`,{class:`text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},`Select Sale Transaction`,-1),u(`div`,Qe,[u(`table`,$e,[i[29]||=u(`thead`,{class:`bg-gray-50 dark:bg-gray-800`},[u(`tr`,null,[u(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Select`),u(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Date`),u(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Inv Code`),u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Original Qty`),u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Returned`),u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Available`),u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Price`),u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Disc. %`)])],-1),u(`tbody`,et,[(h(!0),p(c,null,g(G.value,e=>(h(),p(`tr`,{key:e.sale_item_id,onClick:t=>en(e.sale_item_id),class:ie({"cursor-pointer hover:bg-blue-50 dark:hover:bg-gray-600":!0,"bg-blue-100 dark:bg-blue-900":F.value.selectedSaleItemId===e.sale_item_id})},[u(`td`,nt,[u(`input`,{type:`radio`,value:e.sale_item_id,checked:F.value.selectedSaleItemId===e.sale_item_id,class:`h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300`},null,8,rt)]),u(`td`,it,x(b(S)(e.sale_date)),1),u(`td`,at,[u(`a`,{onClick:s(t=>$(e.sale_id),[`stop`]),class:`text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 cursor-pointer underline`,title:`View sale details (opens in new tab)`},x(e.sale_prefix)+x(e.sale_code),9,ot)]),u(`td`,st,x(e.quantity),1),u(`td`,ct,x(e.returned_quantity),1),u(`td`,lt,x(e.available_quantity),1),u(`td`,ut,x(Y(e.price)),1),u(`td`,dt,x(e.discount_percent)+`%`,1)],10,tt))),128))])])])])):f(``,!0),F.value.selectedSaleItemId?(h(),p(`div`,ft,[u(`div`,null,[i[31]||=u(`label`,{for:`return-quantity`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[m(` Return Quantity `),u(`span`,{class:`text-red-500 ml-1`},`*`)],-1),v(u(`input`,{id:`return-quantity`,"onUpdate:modelValue":i[8]||=e=>F.value.quantity=e,type:`number`,min:`1`,max:K.value?.available_quantity,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm`},null,8,pt),[[o,F.value.quantity,void 0,{number:!0}]]),u(`p`,mt,`Max: `+x(K.value?.available_quantity),1)]),u(`div`,ht,[i[32]||=u(`label`,{for:`item-note`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Note (Optional) `,-1),v(u(`input`,{id:`item-note`,"onUpdate:modelValue":i[9]||=e=>F.value.note=e,type:`text`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm`,placeholder:`Optional note for this item...`},null,512),[[o,F.value.note]])])])):f(``,!0),F.value.selectedSaleItemId?(h(),p(`div`,gt,[u(`button`,{type:`button`,onClick:tn,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200`},[n(b(e),{class:`h-4 w-4 mr-2`}),i[33]||=m(` Add Item `,-1)])])):f(``,!0)]),L.items.length>0&&L.items[0].sale_item_id?(h(),p(`div`,_t,[i[44]||=u(`h4`,{class:`text-sm font-medium text-gray-700 dark:text-gray-300 mb-3`},`Items to Return`,-1),u(`div`,vt,[u(`table`,yt,[u(`thead`,bt,[u(`tr`,null,[i[34]||=u(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`#`,-1),i[35]||=u(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Item`,-1),i[36]||=u(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Sale`,-1),i[37]||=u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Quantity`,-1),i[38]||=u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Price`,-1),i[39]||=u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Disc %`,-1),q.value?f(``,!0):(h(),p(`th`,xt,`TAX %`)),q.value?f(``,!0):(h(),p(`th`,St,`TTC Price`)),f(``,!0),i[40]||=u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Total USD`,-1),i[41]||=u(`th`,{class:`px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Actions`,-1)])]),u(`tbody`,Ct,[(h(!0),p(c,null,g(L.items,(e,t)=>(h(),p(`tr`,{key:t},[u(`td`,wt,x(t+1),1),u(`td`,Tt,[u(`div`,null,x(e.item_code),1),u(`div`,Et,x(e.item_name),1),e.note?(h(),p(`div`,Dt,`Note: `+x(e.note),1)):f(``,!0)]),u(`td`,Ot,[u(`div`,null,[u(`a`,{onClick:s(t=>$(e.sale_id),[`stop`]),class:`text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 cursor-pointer underline`,title:`View sale details (opens in new tab)`},x(e.sale_prefix)+x(e.sale_code),9,kt)]),u(`div`,At,x(e.sale_date),1)]),u(`td`,jt,x(e.quantity)+` `+x(e.item_unit),1),u(`td`,Mt,x(Y(e.price)),1),u(`td`,Nt,x(e.discount_percent)+`%`,1),q.value?f(``,!0):(h(),p(`td`,Pt,x(e.tax_percent),1)),q.value?f(``,!0):(h(),p(`td`,Ft,x(Y(e.ttc_price)),1)),f(``,!0),u(`td`,It,x(Y(e.total_price_usd)),1),u(`td`,Lt,[u(`button`,{type:`button`,onClick:e=>nn(t),class:`inline-flex items-center p-1 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300`,title:`Remove item`},[n(b(oe),{class:`h-4 w-4`})],8,Rt)])]))),128))]),u(`tfoot`,zt,[u(`tr`,null,[i[42]||=u(`td`,{colspan:`8`,class:`px-3 py-2 text-sm font-medium text-right text-gray-900 dark:text-gray-100`},`Total:`,-1),f(``,!0),u(`td`,Bt,x(Y(L.total_usd)),1),i[43]||=u(`td`,null,null,-1)])])])])])):f(``,!0)]),u(`div`,Vt,[i[48]||=u(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Return Summary `,-1),u(`div`,Ht,[u(`div`,null,[i[46]||=u(`label`,{for:`total_volume_cbm`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Volume (CBM) `,-1),v(u(`input`,{id:`total_volume_cbm`,"onUpdate:modelValue":i[10]||=e=>L.total_volume_cbm=e,type:`number`,min:`0`,step:`0.0001`,readonly:``,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 dark:bg-gray-600 text-gray-900 dark:text-white sm:text-sm`},null,512),[[o,L.total_volume_cbm,void 0,{number:!0}]])]),u(`div`,null,[i[47]||=u(`label`,{for:`total_weight_kg`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Weight (KG) `,-1),v(u(`input`,{id:`total_weight_kg`,"onUpdate:modelValue":i[11]||=e=>L.total_weight_kg=e,type:`number`,min:`0`,step:`0.0001`,readonly:``,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 dark:bg-gray-600 text-gray-900 dark:text-white sm:text-sm`},null,512),[[o,L.total_weight_kg,void 0,{number:!0}]])])])]),u(`div`,Ut,[i[49]||=u(`label`,{for:`note`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Notes `,-1),v(u(`textarea`,{id:`note`,"onUpdate:modelValue":i[12]||=e=>L.note=e,rows:`3`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,placeholder:`Any additional notes about this return...`},null,512),[[o,L.note]]),M.value.note?(h(),p(`p`,Wt,x(M.value.note),1)):f(``,!0)]),u(`div`,Gt,[u(`button`,{type:`button`,onClick:Q,disabled:k.value,class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},` Cancel `,8,Kt),u(`button`,{type:`submit`,disabled:k.value||!J.value,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},[k.value?(h(),d(b(t),{key:0,class:`w-4 h-4 mr-2 animate-spin`})):(h(),d(b(se),{key:1,class:`w-4 h-4 mr-2`})),m(` `+x(k.value?`Creating...`:`Create Return Order`),1)],8,qt)])],32)])])])]))}}),T=w;export{T as default};
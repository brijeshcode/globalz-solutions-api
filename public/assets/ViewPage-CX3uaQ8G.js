import{O as e,T as t,U as n,W as r,_ as i,a4 as ee,aA as a,aL as te,aN as o,aO as s,aP as c,aQ as l,aR as u,aT as d,aU as f,aV as ne,aX as re,aY as ie,aZ as p,a_ as ae,ah as oe,av as se,az as ce,b0 as m,b1 as le,b4 as h,b7 as g,b8 as _,bb as v,r as ue}from"./index-Bbab_3Rt.js";import"./GlobalConfig-wPgXFcZ5.js";import"./tableUtils-ylneqlK-.js";import{c as de,d as y}from"./common-qdv5PS_C.js";import{b}from"./currencyUtil-Dtq1BUJy.js";import{b as x}from"./DataItems-BWsPCul_.js";import{b as fe,c as S}from"./SystemInfoCard-C0MTNwaU.js";import{b as C}from"./documentService-D0HPYoLz.js";import{b as w}from"./DownloadIcon-uyE6fzGt.js";import{b as pe}from"./incomeTransactionStore-KI6LDkN7.js";const me={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8`},he={class:`mb-8`},T={class:`flex items-center justify-between`},E={class:`flex items-center space-x-4`},D={class:`text-3xl font-bold text-gray-900 dark:text-gray-100`},O={class:`text-sm text-gray-600 dark:text-gray-400 mt-1`},k={class:`flex items-center space-x-3`},A={key:0,class:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300`},j={key:0,class:`flex items-center justify-center py-12`},M={key:1,class:`bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6`},N={class:`flex items-center`},P={class:`text-red-600 dark:text-red-400 mt-1`},F={key:2,class:`space-y-8`},I={class:`font-medium text-blue-600 dark:text-blue-400`},L={class:`text-lg font-semibold text-red-600 dark:text-red-400`},R={class:`text-sm text-gray-900 dark:text-gray-100 whitespace-pre-wrap`},ge={key:2,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},_e={class:`px-6 py-5 border-b border-gray-200 dark:border-gray-700`},ve={class:`flex items-center justify-between`},ye={class:`text-lg font-medium text-gray-900 dark:text-gray-100`},be={class:`px-6 py-5`},xe={class:`grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3`},Se={class:`flex items-start space-x-3`},Ce={class:`flex-shrink-0`},we={class:`flex-1 min-w-0`},Te={class:`text-sm font-medium text-gray-900 dark:text-gray-100 truncate`},Ee={class:`text-xs text-gray-500 dark:text-gray-400 mt-1`},z={class:`text-xs text-gray-500 dark:text-gray-400`},De={class:`flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity`},Oe={class:`flex space-x-2`},ke=[`onClick`],Ae=[`onClick`],je={key:3,class:`bg-white dark:bg-gray-800 shadow rounded-lg p-8`},Me={class:`text-center`},Ne={key:4,class:`fixed inset-0 z-50 overflow-y-auto`,"aria-labelledby":`modal-title`,role:`dialog`,"aria-modal":`true`},Pe={class:`flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0`},Fe={class:`inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full sm:p-6`},Ie={class:`absolute top-0 right-0 pt-4 pr-4`},Le={class:`mt-3 text-center sm:mt-5`},Re={class:`text-lg leading-6 font-medium text-gray-900 dark:text-gray-100 mb-4`},ze={key:0,class:`max-h-96 overflow-auto`},Be=[`src`,`alt`],Ve={key:1,class:`flex items-center justify-center py-8`},He={key:1,class:`h-96`},Ue=[`src`],We={key:1,class:`flex items-center justify-center py-8`},Ge={key:2,class:`text-center py-8`},Ke={class:`mt-5 sm:mt-6 flex justify-center space-x-3`};var B=ne({__name:`ViewPage`,setup(ne){let B=a(),V=ce(),H=pe(),{showError:qe}=se(),U=g(!0),W=g(null),Je=o(()=>Number(V.params.id)),G=g(!1),K=g(null),q=g(``),J=o(()=>H.currentIncomeTransaction),Y=async e=>{await C.download(e)},Ye=async e=>{try{K.value=e,G.value=!0;let t=await C.preview(e.id);q.value=t.preview_url}catch(t){console.error(`Error getting preview URL:`,t),q.value=Ze(e)}},X=()=>{G.value=!1,K.value=null,q.value=``},Xe=e=>Z(e)||Q(e),Z=e=>{let t=e.file_extension?.toLowerCase();return[`jpg`,`jpeg`,`png`,`gif`,`bmp`,`svg`,`webp`].includes(t||``)},Q=e=>{let t=e.file_extension?.toLowerCase();return t===`pdf`},Ze=e=>{let t=`https://staging.globalzsolutions.com`;return`${t}/api/documents/${e.id}/preview`},Qe=r=>{let i=r?.toLowerCase();return[`jpg`,`jpeg`,`png`,`gif`,`bmp`,`svg`].includes(i)?e:[`pdf`].includes(i)?n:t},$e=async()=>{try{U.value=!0,W.value=null,await H.fetchIncomeTransaction(Je.value),!H.currentIncomeTransaction&&(W.value=`Transaction not found`)}catch(e){W.value=e.response?.data?.message||`Failed to load transaction details`,qe(W.value)}finally{U.value=!1}},et=()=>{J.value&&B.push({name:`incomes.transactions.edit`,params:{id:J.value.id}})},$=()=>{B.go(-1)};return re(()=>{$e()}),ie(()=>{H.clearCurrentIncomeTransaction()}),(e,t)=>{let n=m(`X`),a=m(`FileTextIcon`);return p(),u(`div`,me,[s(`div`,he,[s(`div`,T,[s(`div`,E,[s(`button`,{onClick:$,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[f(_(oe),{class:`w-5 h-5`})]),s(`div`,null,[s(`h1`,D,v(J.value?.subject||`Income Transaction Details`),1),s(`p`,O,` Transaction Code: `+v(J.value?.code),1)])]),s(`div`,k,[J.value?(p(),u(`span`,A,v(_(b)(J.value.amount)),1)):l(``,!0),s(`button`,{onClick:et,class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700`},[f(_(ue),{class:`w-4 h-4 mr-2`}),t[1]||=d(` Edit `,-1)])])])]),U.value?(p(),u(`div`,j,t[2]||=[s(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mr-4`},null,-1),s(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading transaction details...`,-1)])):W.value?(p(),u(`div`,M,[s(`div`,N,[f(_(ee),{class:`w-6 h-6 text-red-500 mr-3`}),s(`div`,null,[t[3]||=s(`h3`,{class:`text-lg font-medium text-red-800 dark:text-red-300`},`Error Loading Transaction`,-1),s(`p`,P,v(W.value),1)])])])):J.value?(p(),u(`div`,F,[f(S,{title:`Transaction Information`},{default:h(()=>[f(x,{label:`Transaction Date`,value:_(de)(J.value.date)},null,8,[`value`]),f(x,{label:`Code`},{default:h(()=>[s(`span`,I,v(J.value.code),1)]),_:1}),f(x,{label:`Amount`},{default:h(()=>[s(`span`,L,v(_(b)(J.value.amount)),1)]),_:1}),f(x,{label:`Subject`,value:J.value.subject||`No subject provided`},null,8,[`value`]),f(x,{label:`Income Category`,value:J.value.income_category?.name},null,8,[`value`]),f(x,{label:`Account`,value:J.value.account?.name},null,8,[`value`])]),_:1}),J.value.order_number||J.value.check_number||J.value.bank_ref_number?(p(),c(S,{key:0,title:`Reference Information`,gridCols:`cols-3`},{default:h(()=>[f(x,{label:`Order Number`,value:J.value.order_number},null,8,[`value`]),f(x,{label:`Check Number`,value:J.value.check_number},null,8,[`value`]),f(x,{label:`Bank Reference`,value:J.value.bank_ref_number},null,8,[`value`])]),_:1})):l(``,!0),J.value.note?(p(),c(S,{key:1,title:`Notes`},{default:h(()=>[f(x,{label:`Notes`,class:`sm:col-span-3`},{default:h(()=>[s(`p`,R,v(J.value.note),1)]),_:1})]),_:1})):l(``,!0),J.value.documents&&J.value.documents.length>0?(p(),u(`div`,ge,[s(`div`,_e,[s(`div`,ve,[s(`h3`,ye,` Documents (`+v(J.value.documents.length)+`) `,1)])]),s(`div`,be,[s(`div`,xe,[(p(!0),u(te,null,ae(J.value.documents,e=>(p(),u(`div`,{key:e.id,class:`relative group bg-gray-50 dark:bg-gray-700 rounded-lg p-4 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors`},[s(`div`,Se,[s(`div`,Ce,[(p(),c(le(Qe(e.file_extension)),{class:`h-8 w-8 text-gray-400`}))]),s(`div`,we,[s(`p`,Te,v(e.title||e.original_name),1),s(`p`,Ee,v(e.file_size_human),1),s(`p`,z,v(_(y)(e.created_at)),1)]),s(`div`,De,[s(`div`,Oe,[Xe(e)?(p(),u(`button`,{key:0,onClick:t=>Ye(e),class:`text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300`,title:`Preview`},[f(_(r),{class:`h-5 w-5`})],8,ke)):l(``,!0),s(`button`,{onClick:t=>Y(e),class:`text-indigo-600 hover:text-indigo-500 dark:text-indigo-400 dark:hover:text-indigo-300`,title:`Download`},[f(w,{class:`h-5 w-5`})],8,Ae)])])])]))),128))])])])):l(``,!0),f(fe,{item:J.value,formatDateTime:_(y)},null,8,[`item`,`formatDateTime`])])):(p(),u(`div`,je,[s(`div`,Me,[f(_(i),{class:`h-12 w-12 mx-auto text-gray-400`}),t[4]||=s(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-2`},` Transaction Not Found `,-1),t[5]||=s(`p`,{class:`text-gray-600 dark:text-gray-400 mb-4`},` The income transaction you're looking for could not be found. `,-1),s(`button`,{onClick:$,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`},` Go Back `)])])),G.value?(p(),u(`div`,Ne,[s(`div`,Pe,[s(`div`,{class:`fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity`,onClick:X}),s(`div`,Fe,[s(`div`,Ie,[s(`button`,{onClick:X,class:`bg-white dark:bg-gray-800 rounded-md text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none`},[f(n,{class:`h-6 w-6`})])]),s(`div`,Le,[s(`h3`,Re,v(K.value?.title||K.value?.original_name),1),K.value&&Z(K.value)?(p(),u(`div`,ze,[q.value?(p(),u(`img`,{key:0,src:q.value,alt:K.value.original_name,class:`max-w-full h-auto mx-auto rounded-lg shadow-lg`},null,8,Be)):(p(),u(`div`,Ve,t[6]||=[s(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mr-4`},null,-1),s(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading preview...`,-1)]))])):K.value&&Q(K.value)?(p(),u(`div`,He,[q.value?(p(),u(`iframe`,{key:0,src:q.value,class:`w-full h-full border rounded-lg`,title:`PDF Preview`,frameborder:`0`},null,8,Ue)):(p(),u(`div`,We,t[7]||=[s(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mr-4`},null,-1),s(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading preview...`,-1)]))])):(p(),u(`div`,Ge,[f(a,{class:`mx-auto h-12 w-12 text-gray-400 mb-4`}),t[8]||=s(`p`,{class:`text-gray-500 dark:text-gray-400`},`Preview not available for this file type.`,-1)]))]),s(`div`,Ke,[s(`button`,{onClick:t[0]||=e=>Y(K.value),class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700`},[f(w,{class:`h-4 w-4 mr-2`}),t[9]||=d(` Download `,-1)]),s(`button`,{onClick:X,class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600`},` Close `)])])])])):l(``,!0)])}}}),V=B;export{V as default};
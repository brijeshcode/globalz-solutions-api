import{I as e,Q as t,a$ as n,aC as r,aG as i,aH as ee,aN as a,aO as o,aR as s,aS as c,aU as l,aV as u,aW as d,aX as f,aY as p,a_ as m,ao as te,b0 as ne,b3 as re,b5 as h,b6 as g,bb as ie,bd as _,be as ae,bf as v,bg as y,bh as b,bj as x,d as oe,p as se,s as ce,z as le}from"./index-BEKp4Rt1.js";import{b as ue}from"./useAuth-CElKE09n.js";import"./GlobalConfig-wPgXFcZ5.js";import{c as S}from"./common-CZbH6H1Z.js";import"./tableUtils-dXs1kjAL.js";import{d as de}from"./currencyUtil-BrX7-ghZ.js";import{b as fe}from"./CurrencyRateInput-D-d5BmF_.js";import{b as pe}from"./customerReturnOrdersStore-BJdmDN1M.js";const me={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8`},he={class:``},ge={class:`mb-8`},_e={class:`flex items-center space-x-4 mb-2`},ve={class:`text-sm text-gray-600 dark:text-gray-400`},ye={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg p-8`},be={class:`flex items-center justify-center`},xe={key:1,class:`bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 mb-6`},Se={class:`flex`},Ce={class:`ml-3`},we={class:`mt-2 text-sm text-yellow-700 dark:text-yellow-300`},Te={key:2,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},Ee={class:`px-6 py-8`},De={class:`border-b border-gray-200 dark:border-gray-700 pb-6`},Oe={class:`grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6`},ke={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Ae=[`disabled`],C={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},je=[`value`],Me={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Ne=[`disabled`],Pe=[`value`],Fe={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Ie=[`disabled`],Le=[`value`],Re={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},ze=[`disabled`],Be=[`value`],Ve={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},He={class:`border-b border-gray-200 dark:border-gray-700 pb-6`},Ue={id:`item-add-form`,class:`mb-6`},We={class:`mb-4 w-1/2`},Ge={for:`item-select`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},Ke=[`disabled`],qe=[`value`],Je={key:0,class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},Ye={key:0,class:`mb-4`},Xe={class:`bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md p-3`},Ze={class:`text-sm text-blue-800 dark:text-blue-200`},Qe={class:`ml-2`},$e={class:`ml-3`},et={key:0,class:`text-sm text-amber-700 dark:text-amber-400 mt-1`},tt={class:`font-medium`},nt={key:1,class:`mb-4`},rt={class:`overflow-x-auto border border-gray-300 dark:border-gray-600 rounded-md`},it={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},at={class:`bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600`},ot=[`onClick`],st={class:`px-3 py-2 whitespace-nowrap text-sm`},ct=[`value`,`checked`],lt={class:`px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100`},ut={class:`px-3 py-2 whitespace-nowrap text-sm`},dt=[`onClick`],ft={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},pt={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},mt={class:`px-3 py-2 whitespace-nowrap text-sm text-right font-medium text-green-600 dark:text-green-400`},ht={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},gt={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},_t={key:2,class:`grid grid-cols-1 md:grid-cols-3 gap-4 mb-4`},vt=[`max`],yt={class:`mt-1 text-xs text-gray-500 dark:text-gray-400`},bt={class:`md:col-span-2`},xt={key:3},St={key:0,class:`mt-6`},Ct={class:`overflow-x-auto border border-gray-300 dark:border-gray-600 rounded-md`},wt={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},Tt={class:`bg-gray-50 dark:bg-gray-800`},Et={key:0,class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},Dt={key:1,class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},Ot={class:`bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600`},kt={class:`px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100`},At={class:`px-3 py-2 text-sm text-gray-900 dark:text-gray-100`},jt={class:`text-xs text-gray-500 dark:text-gray-400`},Mt={key:0,class:`text-xs text-gray-500 dark:text-gray-400 italic`},w={class:`px-3 py-2 text-sm text-gray-900 dark:text-gray-100`},Nt={key:0},Pt={key:1,class:`text-xs text-gray-500 dark:text-gray-400`},Ft={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},It={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},Lt={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},Rt={key:0,class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},zt={key:1,class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},Bt={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},Vt={class:`px-3 py-2 whitespace-nowrap text-sm text-center`},Ht=[`onClick`],Ut={class:`bg-gray-50 dark:bg-gray-800`},Wt={class:`px-3 py-2 whitespace-nowrap text-sm text-right font-bold text-gray-900 dark:text-gray-100`},Gt={class:`border-b border-gray-200 dark:border-gray-700 pb-6`},Kt={class:`grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6`},qt=[`value`],Jt=[`value`],Yt={class:`pb-6`},Xt={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Zt={class:`flex items-center justify-end space-x-4 pt-6 border-t border-gray-200 dark:border-gray-700`},Qt=[`disabled`],$t=[`disabled`];var T=ne({__name:`EditPage`,setup(ne){let T=ee(),E=i(),D=r(),O=pe(),k=oe(),{isSalesman:A,isAdmin:en}=ue(),j=v(!1),M=v(!1),N=v(!1),P=v(!1),F=v({}),tn=l(()=>parseInt(E.params.id)),I=v(null),L=v(null),R=v([]),z=v({selectedItemId:null,selectedSaleItemId:null,quantity:1,note:``}),B=v(!1),V=ae({date:new Date().toISOString().split(`T`)[0],prefix:`RTN`,customer_id:null,salesperson_id:null,currency_id:null,warehouse_id:null,currency_rate:1,total:0,total_usd:0,total_volume_cbm:0,total_weight_kg:0,note:``,items:[]}),nn=l(()=>k.customers),rn=l(()=>k.salesEmployees),H=l(()=>k.currencies),an=l(()=>k.warehouses),U=l(()=>z.value.selectedItemId?R.value.find(e=>e.item_id===z.value.selectedItemId):null),W=l(()=>{let e=U.value?.sales||[];return e.filter(e=>e.can_return&&e.available_quantity>0)}),G=l(()=>W.value.filter(e=>e.sale_prefix===`INV`).length),K=l(()=>W.value.filter(e=>e.sale_prefix===`INX`).length),q=l(()=>W.value.filter(e=>!(V.prefix===`RTX`&&e.sale_prefix!==`INX`||V.prefix===`RTN`&&e.sale_prefix!==`INV`))),J=l(()=>z.value.selectedSaleItemId?q.value.find(e=>e.sale_item_id===z.value.selectedSaleItemId):null);l(()=>{let e=H.value.find(e=>e.id==V.currency_id);return e?.code===`USD`});let Y=l(()=>V.prefix===`RTX`),on=async()=>{N.value=!0;try{I.value=await O.fetchReturnOrder(tn.value),sn()}catch{D.error(`Failed to load return order`),T.push({name:`customer.return-orders.index`})}finally{N.value=!1}},sn=()=>{if(!I.value)return;let e=new Date(I.value.date),t=e.toISOString().split(`T`)[0];V.date=t||``,V.customer_id=I.value.customer_id,V.salesperson_id=I.value.salesperson_id,V.prefix=I.value.prefix,V.warehouse_id=I.value.warehouse_id,V.currency_id=I.value.currency_id,V.currency_rate=I.value.currency_rate||1,V.total=I.value.total,V.total_usd=I.value.total_usd,V.note=I.value.note||``,L.value=H.value.find(e=>e.id==V.currency_id),V.items=I.value.items?.map(e=>({id:e.id,customer_return_id:e.customer_return_id,sale_item_id:e.sale_item_id,item_code:e.item_code,item_id:e.item_id,quantity:e.quantity,price:e.price,ttc_price:e.ttc_price||0,discount_percent:e.discount_percent,unit_discount_amount:e.unit_discount_amount,discount_amount:e.discount_amount||0,tax_percent:e.tax_percent,tax_label:e.tax_label,total_price:e.total_price,total_price_usd:e.total_price_usd,total_volume_cbm:e.total_volume_cbm,total_weight_kg:e.total_weight_kg,note:e.note||``,sale_code:e.sale.sale_code,sale_date:S(e.sale.date),item_name:e.item?.description||e.item?.short_name||e.item?.code,item_unit:e.item.unit.name||``}))||[],cn()},cn=async()=>{if(!V.customer_id){R.value=[];return}try{P.value=!0;let e=await O.fetchSaleItemsForReturn({customer_id:V.customer_id});R.value=e?.items||[]}catch(e){console.error(`Error fetching sale items:`,e),D.error(`Failed to load sale items for return`),R.value=[]}finally{P.value=!1}},ln=()=>{z.value.selectedItemId?(B.value=!0,z.value.selectedSaleItemId=null,z.value.quantity=1):B.value=!1},un=e=>{z.value.selectedSaleItemId=e,z.value.quantity=1},dn=e=>{let t=T.resolve({name:`sales.show`,params:{id:e.toString()}});window.open(t.href,`_blank`)},fn=()=>{if(!J.value){D.error(`Please select a sale transaction`);return}if(z.value.quantity<=0){D.error(`Quantity must be greater than 0`);return}if(z.value.quantity>J.value.available_quantity){D.error(`Quantity cannot exceed available quantity (${J.value.available_quantity})`);return}let e=V.items.filter(e=>e.sale_item_id===z.value.selectedSaleItemId).reduce((e,t)=>e+t.quantity,0);if(e+z.value.quantity>J.value.available_quantity){D.error(`Total quantity for this sale item cannot exceed ${J.value.available_quantity}. Already added: ${e}`);return}let t={sale_item_id:z.value.selectedSaleItemId,item_id:U.value.item_id,item_code:U.value.item_code,quantity:z.value.quantity,price:J.value.price,price_usd:J.value.price_usd,discount_percent:J.value.discount_percent,tax_percent:Y.value?0:J.value.tax_percent,tax_label:Y.value?null:J.value.tax_label,ttc_price:J.value.ttc_price,ttc_price_usd:J.value.ttc_price_usd,unit_discount_amount:J.value.unit_discount_amount,unit_discount_amount_usd:J.value.unit_discount_amount_usd,total_price:J.value.ttc_price*z.value.quantity,total_price_usd:J.value.ttc_price_usd*z.value.quantity,note:z.value.note||null,sale_code:J.value.sale_code,sale_date:J.value.sale_date,item_name:U.value.item?.description||U.value.item?.code,item_unit:U.value.item?.itemUnit?.name||``};V.items.push(t),z.value={selectedItemId:null,selectedSaleItemId:null,quantity:1,note:``},B.value=!1,Z(),D.success(`Item added successfully`)},pn=e=>{V.items.splice(e,1),Z()},X=e=>{if(e==null||e===void 0||isNaN(Number(e)))return`0`;let t=Number(e);return t===0?`0`:t.toFixed(2)},Z=()=>{let e=V.items.reduce((e,t)=>e+Number(t.total_price||0),0),t=V.items.reduce((e,t)=>e+Number(t.total_price_usd||0),0);V.total=e,V.total_usd=t;let n=V.items.reduce((e,t)=>e+(t.total_volume_cbm||0),0),r=V.items.reduce((e,t)=>e+(t.total_weight_kg||0),0);V.total_volume_cbm=n,V.total_weight_kg=r},Q=()=>{L.value=H.value.find(e=>e.id==V.currency_id),L.value&&(V.currency_rate=L.value.active_rate?.rate*1||1)},mn=async()=>{if(I.value){j.value=!0,F.value={};try{let e={date:V.date,customer_id:V.customer_id,salesperson_id:V.salesperson_id,currency_id:V.currency_id,warehouse_id:V.warehouse_id,currency_rate:V.currency_rate,total:V.total,total_usd:V.total_usd,total_volume_cbm:V.total_volume_cbm,total_weight_kg:V.total_weight_kg,note:V.note,items:V.items.map(e=>({id:e.id,sale_item_id:e.sale_item_id,quantity:e.quantity,note:e.note}))};await O.updateReturnOrder(I.value.id,e),D.success(`Return order updated successfully`),T.push({name:`customer.return-orders.show`,params:{id:I.value.id.toString()}})}catch(e){console.error(`Update error:`,e),e.response?.data?.errors?F.value=e.response.data.errors:e.errors&&(F.value=e.errors);let t=e.response?.data?.message||`Failed to update return order`;D.error(t)}finally{j.value=!1}}},$=()=>{T.push({name:`customer.return-orders.index`})},hn=()=>{I.value&&T.push({name:`customer.return-orders.show`,params:{id:I.value.id.toString()}})};return re(async()=>{M.value=!0;try{let e=[on()];k.customers.length===0&&e.push(k.fetchCustomers().then(()=>{})),k.salesEmployees.length===0&&e.push(k.fetchSalesEmployees().then(()=>{})),k.currencies.length===0&&e.push(k.fetchCurrencies().then(()=>{})),k.warehouses.length===0&&e.push(k.fetchWarehouses().then(()=>{})),await Promise.all(e)}catch{D.error(`Failed to load form data`)}finally{M.value=!1}}),ie(()=>V.currency_id,()=>{Q()}),(r,i)=>(h(),p(`div`,me,[u(`div`,he,[u(`div`,ge,[u(`div`,_e,[u(`button`,{onClick:$,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[n(y(te),{class:`w-5 h-5`})]),u(`div`,null,[i[11]||=u(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},` Edit Return Order `,-1),u(`p`,ve,` Edit existing return order (`+x(I.value?.return_code)+`) `,1)])])]),N.value?(h(),p(`div`,ye,[u(`div`,be,[n(y(t),{class:`h-8 w-8 animate-spin text-blue-600 dark:text-blue-400`}),i[12]||=u(`span`,{class:`ml-3 text-sm text-gray-600 dark:text-gray-400`},`Loading return order...`,-1)])])):I.value&&!I.value.is_pending?(h(),p(`div`,xe,[u(`div`,Se,[n(y(se),{class:`h-5 w-5 text-yellow-400`}),u(`div`,Ce,[i[13]||=u(`h3`,{class:`text-sm font-medium text-yellow-800 dark:text-yellow-200`},` Return Order Cannot Be Edited `,-1),u(`div`,we,[u(`p`,null,`This return order has been `+x(I.value.is_received?`received`:`approved`)+` and can no longer be modified.`,1)]),u(`div`,{class:`mt-4`},[u(`button`,{onClick:hn,class:`bg-yellow-100 dark:bg-yellow-800 px-3 py-2 rounded-md text-sm font-medium text-yellow-800 dark:text-yellow-200 hover:bg-yellow-200 dark:hover:bg-yellow-700 transition-colors`},` View Return Order `)])])])])):I.value?(h(),p(`div`,Te,[u(`div`,Ee,[u(`form`,{onSubmit:s(mn,[`prevent`]),class:`space-y-6`},[u(`div`,De,[i[25]||=u(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Return Information `,-1),u(`div`,Oe,[u(`div`,null,[i[15]||=u(`label`,{for:`prefix`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[m(` Prefix `),u(`span`,{class:`text-red-500 ml-1`},`*`)],-1),_(u(`select`,{id:`prefix`,"onUpdate:modelValue":i[0]||=e=>V.prefix=e,disabled:``,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 dark:bg-gray-600 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},i[14]||=[u(`option`,{value:`RTN`},`RTN`,-1),u(`option`,{value:`RTX`},`RTX`,-1)],512),[[a,V.prefix]]),F.value.prefix?(h(),p(`p`,ke,x(F.value.prefix),1)):f(``,!0)]),u(`div`,null,[i[16]||=u(`label`,{for:`date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[m(` Return Date `),u(`span`,{class:`text-red-500 ml-1`},`*`)],-1),_(u(`input`,{id:`date`,"onUpdate:modelValue":i[1]||=e=>V.date=e,type:`date`,disabled:j.value,required:``,class:`block w-full rounded-md border-0 py-2 px-3 text-gray-900 dark:text-gray-100 shadow-sm ring-1 ring-inset ring-gray-300 dark:ring-gray-600 placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6 transition-colors duration-200 bg-white dark:bg-gray-700`},null,8,Ae),[[o,V.date]]),F.value.date?(h(),p(`p`,C,x(F.value.date),1)):f(``,!0)]),u(`div`,null,[i[18]||=u(`label`,{for:`customer_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[m(` Customer `),u(`span`,{class:`text-red-500 ml-1`},`*`)],-1),_(u(`select`,{id:`customer_id`,"onUpdate:modelValue":i[2]||=e=>V.customer_id=e,disabled:``,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 dark:bg-gray-600 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},[i[17]||=u(`option`,{value:``},`Select Customer`,-1),(h(!0),p(c,null,g(nn.value,e=>(h(),p(`option`,{key:e.id,value:e.id},x(e.name),9,je))),128))],512),[[a,V.customer_id]]),F.value.customer_id?(h(),p(`p`,Me,x(F.value.customer_id),1)):f(``,!0)]),u(`div`,null,[i[20]||=u(`label`,{for:`salesperson_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Salesperson `,-1),_(u(`select`,{id:`salesperson_id`,"onUpdate:modelValue":i[3]||=e=>V.salesperson_id=e,disabled:j.value||M.value||y(A),class:b([`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,{"bg-gray-50 dark:bg-gray-600":y(A)}])},[i[19]||=u(`option`,{value:``},`Select Salesperson`,-1),(h(!0),p(c,null,g(rn.value,e=>(h(),p(`option`,{key:e.id,value:e.id},x(e.name),9,Pe))),128))],10,Ne),[[a,V.salesperson_id]]),F.value.salesperson_id?(h(),p(`p`,Fe,x(F.value.salesperson_id),1)):f(``,!0)]),u(`div`,null,[i[22]||=u(`label`,{for:`currency_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[m(` Currency `),u(`span`,{class:`text-red-500 ml-1`},`*`)],-1),_(u(`select`,{id:`currency_id`,"onUpdate:modelValue":i[4]||=e=>V.currency_id=e,required:``,disabled:j.value||M.value,onChange:Q,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},[i[21]||=u(`option`,{value:``},`Select Currency`,-1),(h(!0),p(c,null,g(H.value,e=>(h(),p(`option`,{key:e.id,value:e.id},x(e.name)+` (`+x(e.code)+`) `,9,Le))),128))],40,Ie),[[a,V.currency_id]]),F.value.currency_id?(h(),p(`p`,Re,x(F.value.currency_id),1)):f(``,!0)]),L.value&&!y(de)(L.value.code)?(h(),d(fe,{key:0,modelValue:V.currency_rate,"onUpdate:modelValue":i[5]||=e=>V.currency_rate=e,modelModifiers:{number:!0},error:F.value.currency_rate,disabled:j.value,loading:j.value,loadingDropdowns:M.value},null,8,[`modelValue`,`error`,`disabled`,`loading`,`loadingDropdowns`])):f(``,!0),u(`div`,null,[i[24]||=u(`label`,{for:`warehouse_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[m(` Warehouse `),u(`span`,{class:`text-red-500 ml-1`},`*`)],-1),_(u(`select`,{id:`warehouse_id`,"onUpdate:modelValue":i[6]||=e=>V.warehouse_id=e,required:``,disabled:j.value||M.value,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},[i[23]||=u(`option`,{value:``},`Select Warehouse`,-1),(h(!0),p(c,null,g(an.value,e=>(h(),p(`option`,{key:e.id,value:e.id},x(e.name),9,Be))),128))],8,ze),[[a,V.warehouse_id]]),F.value.warehouse_id?(h(),p(`p`,Ve,x(F.value.warehouse_id),1)):f(``,!0)])])]),u(`div`,He,[i[45]||=u(`div`,{class:`flex justify-between items-center mb-4`},[u(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},` Return Items `)],-1),u(`div`,Ue,[u(`div`,We,[u(`label`,Ge,[i[26]||=m(` Add New Item `,-1),u(`span`,null,[P.value?(h(),d(y(t),{key:0,class:`h-4 w-4 animate-spin inline ml-2`})):f(``,!0)])]),_(u(`select`,{id:`item-select`,"onUpdate:modelValue":i[7]||=e=>z.value.selectedItemId=e,onChange:ln,disabled:P.value||R.value.length===0,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},[i[27]||=u(`option`,{value:null},`Select an item`,-1),(h(!0),p(c,null,g(R.value,e=>(h(),p(`option`,{key:e.item_id,value:e.item_id},x(e.item_code)+` - `+x(e.item?.description||e.item?.code)+` (Available: `+x(e.total_available)+`) `,9,qe))),128))],40,Ke),[[a,z.value.selectedItemId]]),R.value.length===0&&!P.value?(h(),p(`p`,Je,` No additional items available for return `)):f(``,!0)]),B.value&&U.value?(h(),p(`div`,Ye,[u(`div`,Xe,[u(`p`,Ze,[i[28]||=u(`span`,{class:`font-medium`},`Available sales for this item:`,-1),u(`span`,Qe,`INV: `+x(G.value),1),u(`span`,$e,`INX: `+x(K.value),1)]),q.value.length===0?(h(),p(`p`,et,[u(`span`,tt,`âš  No `+x(V.prefix===`RTN`?`INV`:`INX`)+` sales found for the selected prefix (`+x(V.prefix)+`).`,1),m(` `+x(V.prefix===`RTN`&&K.value>0?` Try switching to RTX prefix to return INX sales.`:``)+` `+x(V.prefix===`RTX`&&G.value>0?` Try switching to RTN prefix to return INV sales.`:``),1)])):f(``,!0)])])):f(``,!0),B.value&&q.value.length>0?(h(),p(`div`,nt,[i[30]||=u(`h4`,{class:`text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},`Select Sale Transaction`,-1),u(`div`,rt,[u(`table`,it,[i[29]||=u(`thead`,{class:`bg-gray-50 dark:bg-gray-800`},[u(`tr`,null,[u(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Select`),u(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Date`),u(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Inv Code`),u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Original Qty`),u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Returned`),u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Available`),u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Price`),u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Disc. %`)])],-1),u(`tbody`,at,[(h(!0),p(c,null,g(q.value,e=>(h(),p(`tr`,{key:e.sale_item_id,onClick:t=>un(e.sale_item_id),class:b({"cursor-pointer hover:bg-blue-50 dark:hover:bg-gray-600":!0,"bg-blue-100 dark:bg-blue-900":z.value.selectedSaleItemId===e.sale_item_id})},[u(`td`,st,[u(`input`,{type:`radio`,value:e.sale_item_id,checked:z.value.selectedSaleItemId===e.sale_item_id,class:`h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300`},null,8,ct)]),u(`td`,lt,x(y(S)(e.sale_date)),1),u(`td`,ut,[u(`a`,{onClick:s(t=>dn(e.sale_id),[`stop`]),class:`text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 cursor-pointer underline`,title:`View sale details (opens in new tab)`},x(e.sale_prefix)+x(e.sale_code),9,dt)]),u(`td`,ft,x(e.quantity),1),u(`td`,pt,x(e.returned_quantity),1),u(`td`,mt,x(e.available_quantity),1),u(`td`,ht,x(X(e.price)),1),u(`td`,gt,x(e.discount_percent)+`%`,1)],10,ot))),128))])])])])):f(``,!0),z.value.selectedSaleItemId?(h(),p(`div`,_t,[u(`div`,null,[i[31]||=u(`label`,{for:`return-quantity`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[m(` Return Quantity `),u(`span`,{class:`text-red-500 ml-1`},`*`)],-1),_(u(`input`,{id:`return-quantity`,"onUpdate:modelValue":i[8]||=e=>z.value.quantity=e,type:`number`,min:`1`,max:J.value?.available_quantity,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm`},null,8,vt),[[o,z.value.quantity,void 0,{number:!0}]]),u(`p`,yt,`Max: `+x(J.value?.available_quantity),1)]),u(`div`,bt,[i[32]||=u(`label`,{for:`item-note`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Note (Optional) `,-1),_(u(`input`,{id:`item-note`,"onUpdate:modelValue":i[9]||=e=>z.value.note=e,type:`text`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm`,placeholder:`Optional note for this item...`},null,512),[[o,z.value.note]])])])):f(``,!0),z.value.selectedSaleItemId?(h(),p(`div`,xt,[u(`button`,{type:`button`,onClick:fn,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200`},[n(y(e),{class:`h-4 w-4 mr-2`}),i[33]||=m(` Add Item `,-1)])])):f(``,!0)]),V.items.length>0?(h(),p(`div`,St,[i[44]||=u(`h4`,{class:`text-sm font-medium text-gray-700 dark:text-gray-300 mb-3`},`Items to Return`,-1),u(`div`,Ct,[u(`table`,wt,[u(`thead`,Tt,[u(`tr`,null,[i[34]||=u(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`#`,-1),i[35]||=u(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Item`,-1),i[36]||=u(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Sale`,-1),i[37]||=u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Quantity`,-1),i[38]||=u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Price`,-1),i[39]||=u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Disc %`,-1),Y.value?f(``,!0):(h(),p(`th`,Et,`TAX %`)),Y.value?f(``,!0):(h(),p(`th`,Dt,`TTC Price`)),i[40]||=u(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Total USD`,-1),i[41]||=u(`th`,{class:`px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Actions`,-1)])]),u(`tbody`,Ot,[(h(!0),p(c,null,g(V.items,(e,t)=>(h(),p(`tr`,{key:e.id||t},[u(`td`,kt,x(t+1),1),u(`td`,At,[u(`div`,null,x(e.item_code),1),u(`div`,jt,x(e.item_name),1),e.note?(h(),p(`div`,Mt,`Note: `+x(e.note),1)):f(``,!0)]),u(`td`,w,[e.sale_code?(h(),p(`div`,Nt,x(e.sale_code),1)):f(``,!0),e.sale_date?(h(),p(`div`,Pt,x(y(S)(e.sale_date)),1)):f(``,!0)]),u(`td`,Ft,x(e.quantity)+` `+x(e.item_unit),1),u(`td`,It,x(X(e.price)),1),u(`td`,Lt,x(e.discount_percent)+`%`,1),Y.value?f(``,!0):(h(),p(`td`,Rt,x(e.tax_percent)+`%`,1)),Y.value?f(``,!0):(h(),p(`td`,zt,x(X(e.ttc_price)),1)),u(`td`,Bt,x(X(e.total_price_usd)),1),u(`td`,Vt,[u(`button`,{type:`button`,onClick:e=>pn(t),class:`inline-flex items-center p-1 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300`,title:`Remove item`},[n(y(ce),{class:`h-4 w-4`})],8,Ht)])]))),128))]),u(`tfoot`,Ut,[u(`tr`,null,[i[42]||=u(`td`,{colspan:`8`,class:`px-3 py-2 text-sm font-medium text-right text-gray-900 dark:text-gray-100`},`Total:`,-1),u(`td`,Wt,x(X(V.total_usd)),1),i[43]||=u(`td`,null,null,-1)])])])])])):f(``,!0)]),u(`div`,Gt,[i[48]||=u(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Return Summary `,-1),u(`div`,Kt,[u(`div`,null,[i[46]||=u(`label`,{for:`total_volume_cbm`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Volume (CBM) `,-1),u(`input`,{id:`total_volume_cbm`,value:X(V.total_volume_cbm),type:`text`,readonly:``,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 dark:bg-gray-600 text-gray-900 dark:text-white sm:text-sm`},null,8,qt)]),u(`div`,null,[i[47]||=u(`label`,{for:`total_weight_kg`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Weight (KG) `,-1),u(`input`,{id:`total_weight_kg`,value:X(V.total_weight_kg),type:`text`,readonly:``,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 dark:bg-gray-600 text-gray-900 dark:text-white sm:text-sm`},null,8,Jt)])])]),u(`div`,Yt,[i[49]||=u(`label`,{for:`note`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Notes `,-1),_(u(`textarea`,{id:`note`,"onUpdate:modelValue":i[10]||=e=>V.note=e,rows:`3`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,placeholder:`Any additional notes about this return...`},null,512),[[o,V.note]]),F.value.note?(h(),p(`p`,Xt,x(F.value.note),1)):f(``,!0)]),u(`div`,Zt,[u(`button`,{type:`button`,onClick:$,disabled:j.value,class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},` Cancel `,8,Qt),u(`button`,{type:`submit`,disabled:j.value,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},[j.value?(h(),d(y(t),{key:0,class:`w-4 h-4 mr-2 animate-spin`})):(h(),d(y(le),{key:1,class:`w-4 h-4 mr-2`})),m(` `+x(j.value?`Updating...`:`Update Return Order`),1)],8,$t)])],32)])])):f(``,!0)])]))}}),E=T;export{E as default};
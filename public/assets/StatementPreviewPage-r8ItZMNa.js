import{D as e,a4 as t,aB as n,aC as r,aD as i,aE as a,aF as o,aG as s,aI as c,aK as l,aL as u,aU as d,aV as f,aW as p,aY as m,ag as h,ak as g,al as _,aw as v,ay as y,az as b,u as ee}from"./index-13Qyoasf.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-jdfVzp2e.js";import{c as x}from"./common-DPsEy-Xi.js";import{b as S}from"./companyStore-C0-csPVa.js";import{b as te}from"./customersStore-DmcjRNcY.js";const C={class:`max-w-4xl mx-auto p-8 bg-white text-gray-900 print:h-full print:p-0 print:max-w-none print:mx-0`},w={class:`header`},T={class:`flex justify-between items-start mb-10 pb-6 border-b-2 border-blue-600 print:border-black print:mb-6`},E={class:`flex-1`},D={class:`flex items-center mb-3`},O=[`src`,`alt`],k={key:1,class:`text-3xl font-bold text-blue-600 print:text-black print:text-2xl`},A={key:0},j={class:`print:text-black`},M={class:`text-right flex-1 mt-4`},N={class:`text-lg font-semibold text-gray-600 print:text-black print:text-base`},P={class:`grid grid-cols-1 md:grid-cols-2 gap-8 mb-10 print:grid-cols-2 print:gap-6 print:mb-6`},F={class:`space-y-1 print:space-y-0`},I={class:`flex justify-between print:justify-between`},L={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},R={class:`flex justify-between print:justify-between`},z={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},B={key:0,class:`flex justify-between print:justify-between`},V={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},H={key:1,class:`flex justify-between print:justify-between`},U={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},W={class:`space-y-1 print:space-y-0`},G={key:0,class:`flex justify-between print:justify-between`},K={class:`text-gray-900 print:text-black print:text-xs`},q={class:`flex justify-between print:justify-between`},J={class:`text-gray-900 print:text-black print:text-xs`},Y={class:`flex justify-between print:justify-between`},X={class:`text-gray-900 print:text-black print:text-xs`},Z={key:1,class:`flex justify-between print:justify-between`},Q={class:`text-gray-900 print:text-black print:text-xs`},ne={class:`body`},re={class:`mb-8 print:mb-4`},ie={class:`overflow-x-auto print:overflow-visible`},ae={class:`w-full border-collapse border border-gray-300 print:border-black`},oe={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},se={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},ce={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},le={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},ue={class:`border-t-2 border-gray-400 print:border-t-2 print:border-black font-bold bg-gray-100 print:bg-gray-200`},de={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},fe={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},pe={class:`footer print:block hidden print:fixed print:bottom-0 print:left-0 print:right-0`},me={class:`border-t-2 border-gray-300 print:border-black pt-4 pb-2`},he={class:`mt-2 print:mt-1`},ge={class:`flex flex-wrap gap-2 text-sm text-gray-600 print:text-black print:text-xs justify-between`},_e={key:0,class:`flex-1`},ve={key:1,class:`flex-1 text-center`},ye={key:2,class:`flex-1 text-center`},be={key:3,class:`flex-1 text-right`};var xe=s({__name:`CustomerStatement`,props:{statements:{default:()=>[]},stats:{default:()=>({})},customerData:{},filters:{default:()=>({})}},setup(e,{expose:t}){let a=e,o=S();c(async()=>{try{o.company.name||await o.fetchCompany()}catch(e){console.error(`Failed to fetch company data:`,e)}});let s=y(()=>{let e=a.statements?.length||0,t=15;return e>=t?0:t-e}),d=e=>!e&&e!==0?`0.00`:Number(e).toLocaleString(`en-US`,{minimumFractionDigits:2,maximumFractionDigits:2}),h=e=>{let t={sales:`Sales`,payments:`Payment`,credit_note:`Credit Note`,debit_note:`Debit Note`,returns:`Return`};return t[e]||e},g=e=>!e&&e!==0?`print:text-black`:e>=0?`text-green-600 dark:text-green-400 print:text-black`:`text-red-600 dark:text-red-400 print:text-black`,_=()=>{window.print()};return t({printStatement:_}),(e,t)=>(l(),r(`div`,C,[b(`section`,w,[b(`div`,T,[b(`div`,E,[b(`div`,D,[f(o).company.logo?.preview_url?(l(),r(`img`,{key:0,src:f(o).company.logo.preview_url,alt:f(o).company.name||`Company Logo`,class:`h-24 w-auto mr-4 print:h-12`},null,8,O)):n(``,!0),f(o).company.logo?.preview_url?n(``,!0):(l(),r(`div`,k,m(f(o).company.name),1))]),f(o).company.tax_number?(l(),r(`div`,A,[b(`p`,j,[b(`b`,null,`Tax Registration #: `+m(f(o).company.tax_number),1)])])):n(``,!0)]),b(`div`,M,[t[0]||=b(`h1`,{class:`text-2xl font-bold text-blue-600 mb-2 print:text-black print:text-xl`},`CUSTOMER STATEMENT`,-1),b(`div`,N,m(e.customerData?.code),1)])]),b(`div`,P,[b(`div`,null,[t[5]||=b(`h3`,{class:`text-lg font-bold text-blue-600 mb-3 print:text-sm border-b border-gray-200 print:text-black print:border-black`},`Customer Information`,-1),b(`div`,F,[b(`div`,I,[t[1]||=b(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Customer:`,-1),b(`span`,L,m(e.customerData?.code)+`, `+m(e.customerData?.name||`Unknown Customer`),1)]),b(`div`,R,[t[2]||=b(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Address:`,-1),b(`span`,z,m(e.customerData?.address)+`, `+m(e.customerData?.city),1)]),e.customerData?.mobile?(l(),r(`div`,B,[t[3]||=b(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Phone:`,-1),b(`span`,V,m(e.customerData?.mobile),1)])):n(``,!0),e.customerData?.mof_tax_number?(l(),r(`div`,H,[t[4]||=b(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Tax #:`,-1),b(`span`,U,m(e.customerData?.mof_tax_number),1)])):n(``,!0)])]),b(`div`,null,[t[10]||=b(`h3`,{class:`text-lg font-bold text-blue-600 mb-3 print:text-sm border-b border-gray-200 print:text-black print:border-black`},`Statement Period`,-1),b(`div`,W,[e.filters?.from_date?(l(),r(`div`,G,[t[6]||=b(`span`,{class:`font-semibold text-gray-700 print:text-black`},`From Date:`,-1),b(`span`,K,m(f(x)(e.filters.from_date)),1)])):n(``,!0),b(`div`,q,[t[7]||=b(`span`,{class:`font-semibold text-gray-700 print:text-black`},`To Date:`,-1),b(`span`,J,m(e.filters?.to_date?f(x)(e.filters.to_date):`Current`),1)]),b(`div`,Y,[t[8]||=b(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Print Date:`,-1),b(`span`,X,m(f(x)(new Date().toISOString())),1)]),e.customerData?.salesperson?(l(),r(`div`,Z,[t[9]||=b(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Sales Pers.:`,-1),b(`span`,Q,m(e.customerData.salesperson?.name),1)])):n(``,!0)])])])]),b(`section`,ne,[b(`div`,re,[b(`div`,ie,[b(`table`,ae,[t[16]||=b(`thead`,null,[b(`tr`,{class:`bg-gray-100 print:bg-gray-200`},[b(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-left font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Date`),b(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-left font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Type`),b(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-left font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Transaction ID`),b(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-left font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Note`),b(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Debit`),b(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Credit`),b(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Balance`)])],-1),b(`tbody`,null,[t[14]||=b(`tr`,{class:`bg-gray-50 print:bg-gray-100 font-semibold`},[b(`td`,{colspan:``,class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`}),b(`td`,{colspan:``,class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`}),b(`td`,{colspan:``,class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`}),b(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},`Opening Balance`),b(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},`0.00`),b(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},`0.00`),b(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},`0.00`)],-1),(l(!0),r(v,null,u(e.statements,e=>(l(),r(`tr`,{key:e.id,class:`even:bg-gray-50 print:even:bg-gray-100`},[b(`td`,oe,m(f(x)(e.date)),1),b(`td`,se,m(h(e.type)),1),b(`td`,ce,m(e.code||`-`),1),b(`td`,le,m(e.note||`-`),1),b(`td`,{class:p([`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-xs`,e.debit?`text-red-600 dark:text-red-400 font-medium print:text-black`:`print:text-black`])},m(e.debit?d(e.debit):`-`),3),b(`td`,{class:p([`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-xs`,e.credit?`text-green-600 dark:text-green-400 font-medium print:text-black`:`print:text-black`])},m(e.credit?d(e.credit):`-`),3),b(`td`,{class:p([`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-xs`,g(e.balance)])},m(d(e.balance)),3)]))),128)),(l(!0),r(v,null,u(s.value,e=>(l(),r(`tr`,{key:`empty-`+e,class:`even:bg-gray-50 print:even:bg-gray-100`},t[11]||=[b(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1),b(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1),b(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1),b(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1),b(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1),b(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1),b(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1)]))),128)),t[15]||=b(`tr`,null,[b(`td`,{colspan:`7`,class:`print:border-black py-2`},`\xA0`)],-1),b(`tr`,ue,[t[12]||=b(`td`,{colspan:`3`,class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black`},null,-1),t[13]||=b(`td`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},`Total`,-1),b(`td`,de,m(d(e.stats?.total_debit)),1),b(`td`,fe,m(d(e.stats?.total_credit)),1),b(`td`,{class:p([`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-lg print:border-black print:text-xs`,g(e.stats?.balance)])},m(d(e.stats?.balance)),3)])])])])]),t[17]||=i(`<div class="flex justify-between items-center mb-6 print:mb-3 mt-8 print:mt-6"><div class="flex-1 text-center"><p class="font-semibold text-gray-700 print:text-black print:text-xs">Received By</p><div class="border-b border-gray-400 print:border-black mt-8 print:mt-4"></div></div><div class="flex-1 text-center ml-8"><p class="font-semibold text-gray-700 print:text-black print:text-xs">Signature</p><div class="border-b border-gray-400 print:border-black mt-8 print:mt-4"></div></div></div>`,1)]),b(`section`,pe,[b(`footer`,me,[b(`div`,he,[b(`div`,ge,[f(o).company.address?(l(),r(`p`,_e,m(f(o).company.address),1)):n(``,!0),f(o).company.phone?(l(),r(`p`,ve,m(f(o).company.phone),1)):n(``,!0),f(o).company.email?(l(),r(`p`,ye,m(f(o).company.email),1)):n(``,!0),f(o).company.website?(l(),r(`p`,be,m(f(o).company.website),1)):n(``,!0)])])])])]))}}),Se=xe;const Ce={class:`min-h-screen bg-gray-50 print:bg-white`},we={class:`bg-white shadow-sm border-b print:hidden`},Te={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8`},Ee={class:`flex items-center justify-between h-16`},De={class:`flex items-center space-x-4`},$={class:`text-sm text-gray-500`},Oe={class:`flex items-center space-x-3`},ke={key:0,class:`flex items-center justify-center min-h-screen`},Ae={class:`text-center`},je={key:1,class:`py-8 print:py-0`},Me={class:`max-w-6xl mx-auto print:max-w-none`};var Ne=s({__name:`StatementPreviewPage`,setup(n){let i=_(),s=g(),u=h(),p=te(),v=y(()=>parseInt(s.params.id)),x=d(!0),S=d([]),C=d({}),w=d(null),T=d(null),E=d({search:s.query.search||``,from_date:s.query.from_date||``,to_date:s.query.to_date||``,transaction_type:s.query.transaction_type||``,withPage:!1}),D=()=>{i.back()},O=async()=>{if(T.value)try{await T.value.printStatement()}catch(e){console.error(`Failed to print statement:`,e),u.error(`Failed to print statement`)}},k=async()=>{try{w.value=await p.fetchCustomer(v.value)}catch(e){console.error(`Error loading customer:`,e),u.error(`Failed to load customer details`),i.push({name:`customers.index`})}},A=async()=>{try{let e=await p.fetchCustomerStatements(v.value,E.value);S.value=e.data,C.value=e.stats}catch(e){u.error(`Failed to load customer statements`,{title:`Error`}),console.error(`Error fetching statements:`,e)}};return c(async()=>{try{x.value=!0,await Promise.all([k(),A()])}catch(e){console.error(`Error initializing statement preview:`,e)}finally{x.value=!1}}),(n,i)=>(l(),r(`div`,Ce,[b(`div`,we,[b(`div`,Te,[b(`div`,Ee,[b(`div`,De,[b(`button`,{onClick:D,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100 transition-colors`},[o(f(t),{class:`w-5 h-5`})]),b(`div`,null,[i[0]||=b(`h1`,{class:`text-lg font-semibold text-gray-900`},`Statement Preview`,-1),b(`p`,$,m(w.value?.code)+` - `+m(w.value?.name),1)])]),b(`div`,Oe,[b(`button`,{onClick:O,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`},[o(f(ee),{class:`w-4 h-4 mr-2`}),i[1]||=a(` Print Statement `,-1)])])])])]),x.value?(l(),r(`div`,ke,[b(`div`,Ae,[o(f(e),{class:`w-8 h-8 animate-spin mx-auto text-blue-600`}),i[2]||=b(`p`,{class:`mt-2 text-gray-600`},`Loading statement...`,-1)])])):(l(),r(`div`,je,[b(`div`,Me,[o(Se,{ref_key:`customerStatementRef`,ref:T,statements:S.value,stats:C.value,"customer-data":w.value,filters:E.value},null,8,[`statements`,`stats`,`customer-data`,`filters`])])]))]))}}),Pe=Ne;export{Pe as default};
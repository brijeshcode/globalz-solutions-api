import{aA as e,aM as t,ap as n,aq as r,ar as i,as as a,at as o,ay as s,az as c,b2 as l,b6 as u}from"./index-BuHiL7JP.js";import{b as d}from"./tableUtils-jdfVzp2e.js";var f=class{baseUrl=`/setups/price-lists`;async getPriceLists(e){try{let t=this.buildQueryParams(e),n=await r(`${this.baseUrl}?${t}`,{loadingMessage:`Loading price lists...`,showLoading:!0});return{data:n.data.data,pagination:n.data.pagination}}catch(e){throw console.error(`Error fetching price lists:`,e),e}}async getPriceList(e){try{let t=await r(`${this.baseUrl}/${e}`,{loadingMessage:`Loading price list...`});return t.data.data}catch(e){throw console.error(`Error fetching price list:`,e),e}}async createPriceList(e){try{let t=await a(this.baseUrl,e,{loadingMessage:`Creating price list...`,showSuccessNotification:!0,successMessage:`Price list created successfully`});return t.data.data}catch(e){throw console.error(`Error creating price list:`,e),e}}async updatePriceList(e,t){try{let n=await o(`${this.baseUrl}/${e}`,t,{loadingMessage:`Updating price list...`,showSuccessNotification:!0,successMessage:`Price list updated successfully`});return n.data.data}catch(e){throw console.error(`Error updating price list:`,e),e}}async deletePriceList(e){try{await n(`${this.baseUrl}/${e}`,{loadingMessage:`Deleting price list...`,showSuccessNotification:!0,successMessage:`Price list deleted successfully`})}catch(e){throw console.error(`Error deleting price list:`,e),e}}async getTrashedPriceLists(e){try{let t=this.buildQueryParams(e),n=await r(`${this.baseUrl}/trashed?${t}`,{loadingMessage:`Loading trashed price lists...`});return{data:n.data.data,pagination:n.data.pagination}}catch(e){throw console.error(`Error fetching trashed price lists:`,e),e}}async restorePriceList(e){try{let t=await i(`${this.baseUrl}/${e}/restore`,{},{loadingMessage:`Restoring price list...`,showSuccessNotification:!0,successMessage:`Price list restored successfully`});return t.data.data}catch(e){throw console.error(`Error restoring price list:`,e),e}}async forceDeletePriceList(e){try{await n(`${this.baseUrl}/${e}/force-delete`,{loadingMessage:`Permanently deleting price list...`,showSuccessNotification:!0,successMessage:`Price list permanently deleted`})}catch(e){throw console.error(`Error permanently deleting price list:`,e),e}}async setDefaultPriceList(e){try{let t=await i(`${this.baseUrl}/${e}/setdefault`,{},{loadingMessage:`Setting default price list...`,showSuccessNotification:!0,successMessage:`Price list set as default successfully`});return t.data.data}catch(e){throw console.error(`Error setting default price list:`,e),e}}async searchPriceLists(e){try{let t=await r(`${this.baseUrl}/search?query=${encodeURIComponent(e)}`,{showLoading:!1});return t.data.data}catch(e){throw console.error(`Error searching price lists:`,e),e}}async getPriceListItems(e){try{let t=await r(`${this.baseUrl}/${e}/items`,{loadingMessage:`Loading price list items...`,showLoading:!0});return t.data.data}catch(e){throw console.error(`Error fetching price list items:`,e),e}}async addPriceListItem(e,t){try{let n=await a(`${this.baseUrl}/${e}/items`,t,{loadingMessage:`Adding item...`,showSuccessNotification:!1});return n.data.data}catch(e){throw console.error(`Error adding price list item:`,e),e}}async updatePriceListItem(e,t,n){try{let r=await o(`${this.baseUrl}/${e}/items/${t}`,n,{loadingMessage:`Updating item...`,showSuccessNotification:!1});return r.data.data}catch(e){throw console.error(`Error updating price list item:`,e),e}}async deletePriceListItem(e){try{await n(`${this.baseUrl}/items/${e}`,{loadingMessage:`Removing item...`,showSuccessNotification:!1})}catch(e){throw console.error(`Error deleting price list item:`,e),e}}buildQueryParams(e){if(!e)return``;let t=new URLSearchParams;return Object.entries(e).forEach(([e,n])=>{n!=null&&n!==``&&t.append(e,String(n))}),t.toString()}};const p=new f,m=e(`priceList`,()=>{let e=c(),n=s(),r=u([]),i=u(null),a=u([]),o=u(d()),f=u(!1),m=u({per_page:50}),h=t(()=>e=>r.value.filter(t=>t.code.toLowerCase().includes(e.toLowerCase()))),g=t(()=>e=>r.value.filter(t=>t.description.toLowerCase().includes(e.toLowerCase()))),_=t(()=>r.value.length),v=t(()=>({total:r.value.length,totalItems:r.value.reduce((e,t)=>e+t.item_count,0)})),y=t(()=>{let e={};return Object.entries(n.query).forEach(([t,n])=>{n&&typeof n==`string`&&(e[t]=n)}),e}),b=async e=>{try{f.value=!0,e&&(m.value={...m.value,...e});let t=await p.getPriceLists(m.value);r.value=t.data,o.value=t.pagination}catch(e){throw console.error(`Error fetching price lists:`,e),e}finally{f.value=!1}},x=async e=>{try{let t=await p.getPriceList(e);return i.value=t,t}catch(e){throw console.error(`Error fetching price list:`,e),e}},S=async e=>{try{let t=await p.createPriceList(e);return r.value.unshift(t),o.value.total+=1,t}catch(e){throw console.error(`Error creating price list:`,e),e}},C=async(e,t)=>{try{let n=await p.updatePriceList(e,t),a=r.value.findIndex(t=>t.id===e);return a!==-1&&(r.value[a]=n),i.value?.id===e&&(i.value=n),n}catch(e){throw console.error(`Error updating price list:`,e),e}},w=async e=>{try{await p.deletePriceList(e);let t=r.value.findIndex(t=>t.id===e);t!==-1&&r.value.splice(t,1),--o.value.total,i.value?.id===e&&(i.value=null)}catch(e){throw console.error(`Error deleting price list:`,e),e}},T=async e=>{try{f.value=!0;let t=e||{},n=await p.getTrashedPriceLists(t);a.value=n.data}catch(e){throw console.error(`Error fetching trashed price lists:`,e),e}finally{f.value=!1}},E=async e=>{try{let t=await p.restorePriceList(e),n=a.value.findIndex(t=>t.id===e);return n!==-1&&a.value.splice(n,1),r.value.unshift(t),o.value.total+=1,t}catch(e){throw console.error(`Error restoring price list:`,e),e}},D=async e=>{try{await p.forceDeletePriceList(e);let t=a.value.findIndex(t=>t.id===e);t!==-1&&a.value.splice(t,1)}catch(e){throw console.error(`Error permanently deleting price list:`,e),e}},O=async e=>{try{let t=await p.setDefaultPriceList(e);r.value.forEach(t=>{t.is_default=t.id===e});let n=r.value.findIndex(t=>t.id===e);return n!==-1&&(r.value[n]=t),i.value?.id===e&&(i.value=t),t}catch(e){throw console.error(`Error setting default price list:`,e),e}},k=async e=>{try{return await p.searchPriceLists(e)}catch(e){throw console.error(`Error searching price lists:`,e),e}},A=async e=>{try{let t=await p.getPriceListItems(e);return i.value&&i.value.id===e&&(i.value.price_list_items=t,i.value.item_count=t.length),t}catch(e){throw console.error(`Error fetching price list items:`,e),e}},j=async(e,t)=>{try{let n=await p.addPriceListItem(e,t);return i.value&&i.value.id===e&&(i.value.price_list_items||(i.value.price_list_items=[]),i.value.price_list_items.push(n),i.value.item_count=(i.value.item_count||0)+1),n}catch(e){throw console.error(`Error adding price list item:`,e),e}},M=async(e,t,n)=>{try{let r=await p.updatePriceListItem(e,t,n);if(i.value&&i.value.price_list_items){let e=i.value.price_list_items.findIndex(e=>e.id===t);e!==-1&&(i.value.price_list_items[e]=r)}return r}catch(e){throw console.error(`Error updating price list item:`,e),e}},N=async e=>{try{if(await p.deletePriceListItem(e),i.value&&i.value.price_list_items){let t=i.value.price_list_items.findIndex(t=>t.id===e);t!==-1&&(i.value.price_list_items.splice(t,1),i.value.item_count=Math.max(0,(i.value.item_count||0)-1))}}catch(e){throw console.error(`Error deleting price list item:`,e),e}},P=e=>{m.value={...m.value,...e}},F=()=>{m.value={per_page:50}},I=()=>{i.value=null},L=e=>{let t={...m.value,search:e,page:1};m.value=t,V(t),W(t,!1)},R=(e,t)=>{let n={...m.value,sort_by:e,sort_direction:t,page:1};m.value=n,V(n),W(n,!1)},z=e=>{let t={...m.value,page:e};m.value=t,V(t),W(t,!1)},B=e=>{let t={...m.value,per_page:e,page:1};m.value=t,V(t),W(t,!1)},V=(t,r=!1)=>{let i={...n.query};Object.entries(t).forEach(([e,t])=>{t!=null&&t!==``?i[e]=String(t):delete i[e]});let a=r?`replace`:`push`;e[a]({query:i})},H=()=>{e.replace({query:{}})},U=()=>{let e={per_page:50};m.value={...e,...y.value}},W=async(e,t=!0)=>{t&&e&&V(e),await b(e)},G=()=>{r.value=[],i.value=null,a.value=[],o.value=d(),m.value={per_page:50},f.value=!1};return l(()=>n.query,async()=>{if(U(),n.name&&n.name.toString().includes(`price-list`))try{await b(m.value)}catch(e){console.error(`Error fetching price lists on URL change:`,e)}},{immediate:!1,deep:!0}),{priceLists:r,currentPriceList:i,trashedPriceLists:a,pagination:o,loading:f,filters:m,priceListsByCode:h,priceListsByDescription:g,totalPriceLists:_,priceListStats:v,urlParams:y,fetchPriceLists:b,fetchPriceList:x,createPriceList:S,updatePriceList:C,deletePriceList:w,fetchTrashedPriceLists:T,restorePriceList:E,forceDeletePriceList:D,setDefaultPriceList:O,searchPriceLists:k,fetchPriceListItems:A,addPriceListItem:j,updatePriceListItem:M,deletePriceListItem:N,updateFilters:P,clearFilters:F,clearCurrentPriceList:I,setSearch:L,setSort:R,setPage:z,setPerPage:B,updateUrlParams:V,clearUrlParams:H,syncFiltersWithUrl:U,fetchData:W,reset:G}});export{m as b};
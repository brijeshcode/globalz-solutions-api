import{E as e,N as t,aA as n,aB as r,aE as i,aG as ee,aH as a,aI as o,aK as te,aM as s,aN as c,aT as ne,aU as l,aW as u,aX as d,aY as f,a_ as p,ai as re,am as ie,an as ae,au as m,ay as oe,p as se,t as h,v as ce}from"./index-7--PgFgh.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-jdfVzp2e.js";import{b as le}from"./PageHeader-BitIiSAG.js";import{b as g,c as ue,f as _}from"./common-DPsEy-Xi.js";import{b as v}from"./StatCard-CEmar-qK.js";import{b as de}from"./customersStore-DWlFXhwU.js";const y={class:`space-y-6`},b=[`disabled`],x={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6`},S={class:`bg-white dark:bg-gray-800 shadow rounded-lg p-4`},C={class:`grid grid-cols-1 md:grid-cols-6 gap-4`},w={class:`md:col-span-2`},T={class:`relative`},E={class:`bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden`},D={key:0,class:`p-8 text-center`},O={key:1,class:`p-8 text-center`},k={class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},A={key:2,class:`overflow-x-auto`},j={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},M={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},N={class:`px-4 py-1 whitespace-nowrap`},P={class:`text-sm text-gray-900 dark:text-white`},F={class:`px-4 py-1 whitespace-nowrap`},I={class:`px-4 py-1 whitespace-nowrap`},L=[`onClick`],fe={key:1,class:`text-sm text-gray-900 dark:text-white`},R={class:`px-4 py-1 whitespace-nowrap`},z={class:`text-sm text-gray-900 dark:text-white`},B={class:`px-4 py-1 whitespace-nowrap text-right`},V={class:`text-sm font-medium text-red-600 dark:text-red-400`},pe={class:`px-4 py-1 whitespace-nowrap text-right`},me={class:`text-sm font-medium text-green-600 dark:text-green-400`},he={class:`px-4 py-1 whitespace-nowrap text-right`};var H=o({__name:`StatementPage`,setup(o){let H=ie(),U=ae(),ge=re(),W=de(),G=n(()=>parseInt(H.params.id)),K=u(!1),q=u([]),J=u([]),Y=u(``),X=u(null),Z=u({search:``,from_date:``,to_date:``,transaction_type:``,withPage:!1}),Q=async()=>{try{K.value=!0;let e=await W.fetchCustomerStatements(G.value,Z.value);console.log(e),q.value=e.data,J.value=e.stats}catch(e){ge.error(`Failed to load customer statements`,{title:`Error`}),console.error(`Error fetching statements:`,e)}finally{K.value=!1}},_e=()=>{X.value&&clearTimeout(X.value),X.value=setTimeout(()=>{Q()},300)},$=()=>{Q()},ve=()=>{Z.value={search:``,from_date:``,to_date:``,transaction_type:``,withPage:!1},Q()},ye=e=>{let t={sales:`Sales`,payments:`Payment`,credit_note:`Credit Note`,debit_note:`Debit Note`,returns:`Return`};return t[e]||e},be=async()=>{try{let e=await W.fetchCustomer(G.value);Y.value=e.name}catch(e){console.error(`Error fetching customer details:`,e)}},xe=()=>{U.push({name:`customers.statement.preview`,params:{id:G.value},query:{from_date:Z.value.from_date,to_date:Z.value.to_date,search:Z.value.search,transaction_type:Z.value.transaction_type}})},Se=e=>{if(!e.id||!e.transaction_type)return;let t={sale:`sales.show`,payment:`customer.payments.show`,credit_debit_note:`customer.notes.show`,customer_returns:`customer.return.show`},n=t[e.transaction_type];if(!n)return;let r=U.resolve({name:n,params:{id:e.id}});window.open(r.href,`_blank`)};return te(async()=>{try{await Promise.all([be(),Q()])}catch(e){console.error(`Error loading initial data:`,e)}}),(n,o)=>(s(),i(`div`,y,[a(le,{title:`Customer Statement - ${Y.value}`,description:`View customer transaction history including sales, payments, and notes`,showCreateButton:!1},{actions:ne(()=>[r(`button`,{onClick:xe,disabled:q.value.length===0,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},[a(d(ce),{class:`w-4 h-4 mr-2`}),o[3]||=ee(` Print Preview `,-1)],8,b)]),_:1},8,[`title`]),r(`div`,x,[a(v,{label:`Balance`,value:d(_)(J.value.balance),icon:d(h),"icon-color":`blue`},null,8,[`value`,`icon`]),a(v,{label:`Credit`,value:d(_)(J.value.total_credit),icon:d(h),"icon-color":`green`},null,8,[`value`,`icon`]),a(v,{label:`Debit`,value:d(_)(J.value.total_debit),icon:d(h),"icon-color":`red`},null,8,[`value`,`icon`])]),r(`div`,S,[r(`div`,C,[r(`div`,w,[o[4]||=r(`label`,{for:`search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Search `,-1),r(`div`,T,[l(r(`input`,{id:`search`,"onUpdate:modelValue":o[0]||=e=>Z.value.search=e,type:`text`,placeholder:`Search note...`,class:`block w-full px-3 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 sm:text-sm transition-colors duration-200`,onInput:_e},null,544),[[m,Z.value.search]]),a(d(se),{class:`absolute left-3 top-2.5 h-5 w-5 text-gray-400`})])]),r(`div`,null,[o[5]||=r(`label`,{for:`from_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` From Date `,-1),l(r(`input`,{id:`from_date`,"onUpdate:modelValue":o[1]||=e=>Z.value.from_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:$},null,544),[[m,Z.value.from_date]])]),r(`div`,null,[o[6]||=r(`label`,{for:`to_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` To Date `,-1),l(r(`input`,{id:`to_date`,"onUpdate:modelValue":o[2]||=e=>Z.value.to_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:$},null,544),[[m,Z.value.to_date]])]),r(`div`,{class:`flex items-end`},[r(`button`,{onClick:ve,class:`w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200`},` Clear `)])])]),r(`div`,E,[K.value?(s(),i(`div`,D,[a(d(e),{class:`h-8 w-8 animate-spin mx-auto text-blue-600 dark:text-blue-400`}),o[7]||=r(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},`Loading statements...`,-1)])):q.value.length===0?(s(),i(`div`,O,[a(d(t),{class:`h-12 w-12 mx-auto text-gray-400`}),o[8]||=r(`h3`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},` No statements found `,-1),r(`p`,k,p(Z.value.search||Z.value.transaction_type?`Try adjusting your search criteria.`:`No transactions available for this customer.`),1)])):(s(),i(`div`,A,[r(`table`,j,[o[9]||=r(`thead`,{class:`bg-gray-50 dark:bg-gray-700`},[r(`tr`,null,[r(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Date `),r(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Type `),r(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Transaction ID `),r(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Note `),r(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Debit `),r(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Credit `),r(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Balance `)])],-1),r(`tbody`,M,[(s(!0),i(oe,null,c(q.value,e=>(s(),i(`tr`,{key:e.id,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[r(`td`,N,[r(`div`,P,p(d(ue)(e.date)),1)]),r(`td`,F,p(ye(e.type)),1),r(`td`,I,[e.code?(s(),i(`div`,{key:0,onClick:t=>Se(e),class:`text-sm text-blue-600 dark:text-blue-400 cursor-zoom-in hover:underline`},p(e.code),9,L)):(s(),i(`div`,fe,` - `))]),r(`td`,R,[r(`div`,z,p(e.note||`-`),1)]),r(`td`,B,[r(`div`,V,p(e.debit?d(g)(e.debit,`usd`):`-`),1)]),r(`td`,pe,[r(`div`,me,p(e.credit?d(g)(e.credit,`usd`):`-`),1)]),r(`td`,he,[r(`div`,{class:f([`text-sm font-medium`,e.balance>=0?`text-green-600 dark:text-green-400`:`text-red-600 dark:text-red-400`])},p(d(g)(e.balance,`usd`)),3)])]))),128))])])]))])]))}}),U=H;export{U as default};
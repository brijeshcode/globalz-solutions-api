import{D as e,I as t,a$ as n,aC as ee,aF as r,aG as i,aH as a,aI as o,aK as s,aL as c,aM as te,aO as l,aQ as u,aR as ne,aX as d,a_ as f,aa as re,am as ie,aq as ae,ar as oe,b0 as p,b2 as m,o as se,q as ce,z as le}from"./index-DvyNiJSL.js";import{b as ue}from"./useAuth-xfUbzRrH.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-BFc6-TYF.js";import{b as de}from"./ConfirmationModal-BGluqHvR.js";import{b as fe}from"./common-DNevajli.js";import{b as h,d as pe}from"./currencyUtil-6sPMGpQ0.js";import{b as g}from"./DataItems-fYFF6gbI.js";import{b as me}from"./salesStore-BCEw2Pav.js";const _={class:`max-w-8xl mx-auto py-2`},v={class:``},y={class:`mb-8`},b={class:`flex items-center space-x-4 mb-2`},x={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},S={class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},C={class:`flex items-center justify-between`},w={class:`text-lg font-medium text-gray-900 dark:text-white`},T={class:`text-sm text-gray-500 dark:text-gray-400`},E={class:`flex space-x-3`},D={class:`px-6 py-8`},O={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},k={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6`},A={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-4`},j={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},M={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6`},N={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},P={key:0,class:`text-center py-8 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg`},F={key:1,class:`overflow-x-auto`},I={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},L={class:`bg-gray-50 dark:bg-gray-700`},R={key:0,class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},z={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},he={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ge={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},_e={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ve={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ye={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},be={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},xe={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Se={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ce={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},we={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Te={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ee={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},De={class:`bg-gray-50 dark:bg-gray-700`},Oe={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},B={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},ke={key:0},Ae={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},je={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Me={key:0,class:`px-6 py-4`},Ne={class:`bg-green-50 dark:bg-green-900`},Pe={class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},Fe={class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},Ie={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},Le={class:`grid grid-cols-1 md:grid-cols-3 gap-6`},Re={class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},ze={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},Be={class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},Ve={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},He={class:`mt-1 text-lg font-medium`},Ue={key:0,class:`mb-6`},We={class:`bg-gray-50 dark:bg-gray-700 rounded-lg p-4`},Ge={class:`text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap`},Ke={class:`pt-6 border-t border-gray-200 dark:border-gray-700`},qe={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},Je={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},Ye={class:`px-6 py-8 text-center`};var V=te({__name:`ViewPage`,setup(te){let V=oe(),H=ae(),U=ie(),W=me(),{isSalesman:Xe,isAdmin:G,isWarehouseManager:Ze}=ue(),K=parseInt(H.params.id),q=f(!0),J=f({}),Y=f(!1),X=f(!1),Qe=()=>{V.push({name:`sales.index`})},$e=()=>{V.push({name:`sales.edit`,params:{id:K.toString()}})},et=()=>{V.push({name:`sales.invoice`,params:{id:K.toString()},query:{from:`view`}})},tt=()=>{Y.value=!0},nt=()=>{Y.value=!1,X.value=!1},rt=async()=>{X.value=!0;try{await W.deleteSale(K),U.success(`Sale deleted successfully`),V.push({name:`sales.index`})}catch{U.error(`Failed to delete sale`)}finally{X.value=!1}},it=async()=>{try{q.value=!0,J.value=await W.fetchSale(K)}catch(e){console.error(`Error loading sale:`,e),U.error(`Failed to load sale details`),V.push({name:`sales.index`})}finally{q.value=!1}},Z=e=>{let t=Number(e||0);return t>0?`text-green-600 dark:text-green-400 font-medium`:t<0?`text-red-600 dark:text-red-400 font-medium`:`text-gray-600 dark:text-gray-400`},at=e=>{let t=Number(e||0);return t>0?`bg-green-50 dark:bg-green-900 text-green-600 dark:text-green-400`:t<0?`bg-red-50 dark:bg-red-900 text-red-600 dark:text-red-400`:`bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-400`},Q=e=>e?parseFloat(Number(e).toFixed(2)).toString():`0`,ot=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleDateString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`})},$=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`})};return l(async()=>{await it()}),(te,l)=>(u(),o(`div`,_,[r(`div`,v,[r(`div`,y,[r(`div`,b,[r(`button`,{onClick:Qe,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[c(n(re),{class:`w-5 h-5`})]),l[1]||=r(`div`,null,[r(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},` Sale Details `),r(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},` View sale order information `)],-1)])]),q.value?(u(),o(`div`,Je,[r(`div`,Ye,[c(n(t),{class:`w-8 h-8 animate-spin mx-auto text-blue-600`}),l[30]||=r(`p`,{class:`mt-2 text-gray-600 dark:text-gray-400`},`Loading sale details...`,-1)])])):(u(),o(`div`,x,[r(`div`,S,[r(`div`,C,[r(`div`,null,[r(`h3`,w,m(J.value.prefix)+`-`+m(J.value.code),1),r(`p`,T,` Sale ID: `+m(J.value.id),1)]),r(`div`,E,[r(`button`,{onClick:et,class:`inline-flex items-center px-3 py-2 border border-green-300 dark:border-green-600 text-sm font-medium rounded-md text-green-700 dark:text-green-300 bg-white dark:bg-gray-800 hover:bg-green-50 dark:hover:bg-green-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200`},[c(n(le),{class:`w-4 h-4 mr-2`}),l[2]||=s(` Print Invoice `,-1)]),n(G)?(u(),o(`button`,{key:0,onClick:$e,class:`inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200`},[c(n(e),{class:`w-4 h-4 mr-2`}),l[3]||=s(` Edit `,-1)])):a(``,!0),n(G)?(u(),o(`button`,{key:1,onClick:tt,class:`inline-flex items-center px-3 py-2 border border-red-300 dark:border-red-600 text-sm font-medium rounded-md text-red-700 dark:text-red-300 bg-white dark:bg-gray-800 hover:bg-red-50 dark:hover:bg-red-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200`},[c(n(se),{class:`w-4 h-4 mr-2`}),l[4]||=s(` Delete `,-1)])):a(``,!0)])])]),r(`div`,D,[r(`div`,O,[l[5]||=r(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Basic Information `,-1),r(`div`,k,[c(g,{label:`Sale Date`,value:ot(J.value.date)},null,8,[`value`]),c(g,{label:`Customer`,value:J.value.customer.name},null,8,[`value`]),c(g,{label:`Salesperson`,value:J.value.salesperson.name},null,8,[`value`]),c(g,{label:`Warehouse`,value:J.value.warehouse.name},null,8,[`value`]),c(g,{label:`Currency`,value:`${J.value.currency.code} - ${J.value.currency.name}`},null,8,[`value`])]),r(`div`,A,[n(pe)(J.value.currency.code)?a(``,!0):(u(),i(g,{key:0,label:`Currency Rate`,value:n(h)(J.value.currency_rate)},null,8,[`value`]))])]),r(`div`,j,[l[6]||=r(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Financial Summary `,-1),r(`div`,M,[c(g,{label:`Sub Total`,value:n(h)(J.value.sub_total,!0,J.value.currency)},null,8,[`value`]),c(g,{label:`Sub Total (USD)`,value:n(h)(J.value.sub_total_usd,!0)},null,8,[`value`]),J.value.discount_amount&&J.value.discount_amount>0?(u(),i(g,{key:0,label:`Discount Amount`,value:n(h)(J.value.discount_amount,!0,J.value.currency)},null,8,[`value`])):a(``,!0),n(G)?(u(),i(g,{key:1,label:`Total Profit`},{default:d(()=>[r(`div`,{class:p([`text-sm`,Z(J.value.total_profit)])},m(n(h)(J.value.total_profit,!0,null)),3)]),_:1})):a(``,!0)])]),r(`div`,N,[l[24]||=r(`div`,{class:`flex items-center justify-between mb-4`},[r(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white`},` Sale Items `)],-1),J.value.items&&J.value.items.length===0?(u(),o(`div`,P,[c(n(ce),{class:`mx-auto h-12 w-12 text-gray-400`}),l[7]||=r(`h5`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},`No items found`,-1),l[8]||=r(`p`,{class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},`This sale has no items.`,-1)])):(u(),o(`div`,F,[r(`table`,I,[r(`thead`,L,[r(`tr`,null,[l[9]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`#`,-1),l[10]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Code`,-1),l[11]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Item`,-1),l[12]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Unit`,-1),l[13]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[r(`abbr`,{title:`Total Quantity`},`QTY`)],-1),l[14]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Sale Price`,-1),l[15]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Cost Price`,-1),l[16]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[r(`abbr`,{title:`Discount Percentage`},`Dis. %`)],-1),l[17]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[r(`abbr`,{title:`Tax Percentage`},`Tax %`)],-1),l[18]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[r(`abbr`,{title:`Tax-inclusive Price`},`TTC`)],-1),l[19]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Total`,-1),l[20]||=r(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`USD`,-1),n(G)?(u(),o(`th`,R,`Profit`)):a(``,!0)])]),r(`tbody`,z,[(u(!0),o(ee,null,ne(J.value.items,(e,t)=>(u(),o(`tr`,{key:t,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[r(`td`,he,m(t+1),1),r(`td`,ge,m(e.item_code),1),r(`td`,_e,m(e.item.description),1),r(`td`,ve,m(e.item.item_unit.name),1),r(`td`,ye,m(Q(e.quantity)),1),r(`td`,be,m(n(h)(e.price,!0,J.value.currency)),1),r(`td`,xe,m(n(h)(e.cost_price,!0)),1),r(`td`,Se,m(Q(e.discount_percent))+`%`,1),r(`td`,Ce,m(Q(e.tax_percent))+`%`,1),r(`td`,we,m(n(h)(e.ttc_price,!0,J.value.currency)),1),r(`td`,Te,m(n(h)(e.total_price,!0,J.value.currency)),1),r(`td`,Ee,m(n(h)(e.total_price_usd,!0)),1),n(G)?(u(),o(`td`,{key:0,class:p([`px-6 py-4 whitespace-nowrap text-sm`,Z(e.unit_profit)])},m(n(fe)(e.unit_profit)),3)):a(``,!0)]))),128))]),r(`tfoot`,De,[r(`tr`,null,[l[21]||=r(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Sub Total:`,-1),r(`td`,Oe,m(n(h)(J.value.sub_total,!0,J.value.currency)),1),r(`td`,B,m(n(h)(J.value.sub_total_usd,!0)),1),n(G)?(u(),o(`td`,{key:0,class:p([`px-6 py-4 text-sm font-medium`,Z(J.value.total_profit)])},m(n(h)(J.value.total_profit,!0)),3)):a(``,!0)]),J.value.discount_amount&&Number(J.value.discount_amount)>0?(u(),o(`tr`,ke,[l[22]||=r(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Additional Discount:`,-1),r(`td`,Ae,`-`+m(n(h)(J.value.discount_amount,J.value.currency)),1),r(`td`,je,`-`+m(n(h)(J.value.discount_amount_usd)),1),n(G)?(u(),o(`td`,Me)):a(``,!0)])):a(``,!0),r(`tr`,Ne,[l[23]||=r(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-bold text-gray-900 dark:text-white`},`Final Total:`,-1),r(`td`,Pe,m(n(h)(J.value.total,!0,J.value.currency)),1),r(`td`,Fe,m(n(h)(J.value.total_usd,!0)),1),n(G)?(u(),o(`td`,{key:0,class:p([`px-6 py-4 text-sm font-bold`,Z(J.value.total_profit)])},m(n(h)(J.value.total_profit,!0)),3)):a(``,!0)])])])]))]),r(`div`,Ie,[l[28]||=r(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Final Totals `,-1),r(`div`,Le,[r(`div`,Re,[l[25]||=r(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount`,-1),r(`dd`,ze,m(n(h)(J.value.total,!0,J.value.currency)),1)]),r(`div`,Be,[l[26]||=r(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount (USD)`,-1),r(`dd`,Ve,m(n(h)(J.value.total_usd,!0)),1)]),n(G)?(u(),o(`div`,{key:0,class:p([`rounded-lg p-4`,at(J.value.total_profit)])},[l[27]||=r(`dt`,{class:`text-sm font-medium`},`Total Profit (USD)`,-1),r(`dd`,He,m(n(h)(J.value.total_profit,!0)),1)],2)):a(``,!0)])]),J.value.note?(u(),o(`div`,Ue,[l[29]||=r(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Notes `,-1),c(g,{label:`Note`},{default:d(()=>[r(`div`,We,[r(`p`,Ge,m(J.value.note),1)])]),_:1})])):a(``,!0),r(`div`,Ke,[r(`div`,qe,[c(g,{label:`Created At`,value:$(J.value.created_at)},null,8,[`value`]),c(g,{label:`Last Updated`,value:$(J.value.updated_at)},null,8,[`value`])])])])]))]),c(de,{show:Y.value,"onUpdate:show":l[0]||=e=>Y.value=e,type:`delete`,title:`Delete Sale ${J.value.prefix}-${J.value.code}`,message:`Are you sure you want to delete sale '${J.value.prefix}-${J.value.code}'? This action can be undone by restoring from trash.`,"confirm-text":`Delete Sale`,"loading-text":`Deleting...`,loading:X.value,onConfirm:rt,onCancel:nt},null,8,[`show`,`title`,`message`,`loading`])]))}}),H=V;export{H as default};
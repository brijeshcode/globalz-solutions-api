import{F as e,V as t,Y as ee,_ as n,aE as r,aG as te,aH as i,aI as ne,aJ as a,aK as o,aM as s,aN as c,aO as l,aQ as u,aS as d,aT as re,aV as ie,aZ as f,ac as p,as as m,at as h,b0 as g,b1 as _,b4 as v}from"./index-CLYcJcGF.js";import{b as ae}from"./useAuth-zK0GaaBz.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-BFc6-TYF.js";import{c as y,d as b,f as x}from"./common-DNevajli.js";import{b as S,d as C}from"./currencyUtil-Dbdhfz-C.js";import{b as w}from"./DataItems-DPUtFLAv.js";import"./Modal-BVBVvU8j.js";import{b as T,c as E}from"./CustomerReturnMarkReceived-DJKJEczn.js";const D={class:`max-w-7xl mx-auto sm:px-6 lg:px-8 py-6`},O={class:`mb-6`},k={class:`flex items-center justify-between`},A={key:0,class:`mt-1 text-sm text-gray-600 dark:text-gray-400`},j={class:`flex items-center space-x-3`},M={key:0,class:`flex justify-center items-center py-8`},N={key:1,class:`space-y-6`},P={class:`flex items-center space-x-3`},F={key:0,class:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200`},I={key:1,class:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200`},L={class:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200`},R={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},z={class:`px-6 py-4`},B={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2 lg:grid-cols-3`},V={class:`text-sm text-gray-900 dark:text-white font-mono`},H={key:0,class:`mt-6`},U={class:`text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded-md`},W={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},G={class:`px-6 py-4`},K={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2`},q={key:0,class:`mt-6`},J={class:`text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded-md`},oe={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},se={class:`px-6 py-4`},ce={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2`},le={key:0,class:`mt-6`},ue={class:`text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded-md`},de={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},fe={class:`overflow-x-auto`},pe={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},me={class:`bg-gray-50 dark:bg-gray-900`},he={key:0,class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},ge={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},_e={class:`px-6 py-4 whitespace-nowrap`},ve={class:`flex items-center`},ye={class:`flex-shrink-0 h-10 w-10`},be=[`src`,`alt`],xe={key:1,class:`h-10 w-10 rounded bg-gray-200 dark:bg-gray-600 flex items-center justify-center`},Se={class:`ml-4`},Ce={class:`text-sm font-medium text-gray-900 dark:text-white`},we={class:`text-sm text-gray-500 dark:text-gray-400`},Te={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},Ee={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},De={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},Oe={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},ke={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},Ae={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},je={key:0,class:`px-6 py-4 whitespace-nowrap text-right text-sm font-medium text-gray-900 dark:text-white`},Me={class:`px-6 py-4 text-right`},Ne={key:0,class:`px-6 py-4 text-right`},Pe={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},Fe={class:`px-6 py-4`},Ie={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2 lg:grid-cols-4`};var Y=l({__name:`ViewPage`,setup(l){let Y=m(),X=h(),Le=E(),{isWarehouseManager:Re,isSuperAdmin:ze,isAdmin:Be,isSalesman:Ve}=ae(),Z=g(null),Q=g(!0),$=g(!1),He=te(()=>{if(Ve)return!1;if(Re||ze||Be)return!0}),Ue=async()=>{try{Q.value=!0;let e=parseInt(Y.params.id);Z.value=await Le.fetchReturn(e)}catch(e){console.error(`Error fetching customer return:`,e),X.push({name:`customer.returns.index`})}finally{Q.value=!1}},We=e=>{Z.value=e,$.value=!1};return u(()=>{Ue()}),(te,l)=>{let u=ie(`router-link`);return d(),o(`div`,D,[i(`div`,O,[i(`div`,k,[i(`div`,null,[l[2]||=i(`h1`,{class:`text-2xl font-semibold text-gray-900 dark:text-white`},`Customer Return Details`,-1),Z.value?(d(),o(`p`,A,v(Z.value.return_code)+` " `+v(_(y)(Z.value.date)),1)):a(``,!0)]),i(`div`,j,[He.value&&Z.value&&!Z.value.is_received?(d(),o(`button`,{key:0,onClick:l[0]||=e=>$.value=!0,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500`},[c(_(t),{class:`h-4 w-4 mr-2`}),l[3]||=s(` Mark as Received `,-1)])):a(``,!0),c(u,{to:{name:`customer.return.index`},class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600`},{default:f(()=>[c(_(p),{class:`h-4 w-4 mr-2`}),l[4]||=s(` Back to List `,-1)]),_:1,__:[4]})])])]),Q.value?(d(),o(`div`,M,l[5]||=[i(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600`},null,-1)])):Z.value?(d(),o(`div`,N,[i(`div`,P,[Z.value.is_received?(d(),o(`span`,F,[c(_(n),{class:`h-4 w-4 mr-1`}),l[6]||=s(` Received `,-1)])):(d(),o(`span`,I,[c(_(ee),{class:`h-4 w-4 mr-1`}),l[7]||=s(` Not Received `,-1)])),i(`span`,L,[c(_(n),{class:`h-4 w-4 mr-1`}),l[8]||=s(` Approved `,-1)])]),i(`div`,R,[l[9]||=i(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[i(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Return Information`)],-1),i(`div`,z,[i(`div`,B,[c(w,{label:`Return Code`},{default:f(()=>[i(`div`,V,v(Z.value.return_code),1)]),_:1}),c(w,{label:`Date`,value:_(y)(Z.value.date)},null,8,[`value`]),c(w,{label:`Customer`,value:Z.value.customer?.name},null,8,[`value`]),c(w,{label:`Salesperson`,value:Z.value.salesperson?.name},null,8,[`value`]),c(w,{label:`Warehouse`,value:Z.value.warehouse?.name},null,8,[`value`]),c(w,{label:`Currency`,value:Z.value.currency?.code},null,8,[`value`]),Z.value.currency_rate&&!_(C)(Z.value.currency.code)?(d(),ne(w,{key:0,label:`Exchange Rate`,value:Z.value.currency_rate},null,8,[`value`])):a(``,!0)]),Z.value.note?(d(),o(`div`,H,[c(w,{label:`Note`},{default:f(()=>[i(`div`,U,v(Z.value.note),1)]),_:1})])):a(``,!0)])]),i(`div`,W,[l[10]||=i(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[i(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Approval Information`)],-1),i(`div`,G,[i(`div`,K,[c(w,{label:`Approved By`,value:Z.value.approved_by_user?.name},null,8,[`value`]),c(w,{label:`Approved At`,value:_(b)(Z.value.approved_at)},null,8,[`value`])]),Z.value.approve_note?(d(),o(`div`,q,[c(w,{label:`Approval Note`},{default:f(()=>[i(`div`,J,v(Z.value.approve_note),1)]),_:1})])):a(``,!0)])]),Z.value.is_received?(d(),o(`div`,oe,[l[11]||=i(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[i(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Receipt Information`)],-1),i(`div`,se,[i(`div`,ce,[c(w,{label:`Received By`,value:Z.value.return_received_by_user?.name},null,8,[`value`]),c(w,{label:`Received At`,value:_(b)(Z.value.return_received_at)},null,8,[`value`])]),Z.value.return_received_note?(d(),o(`div`,le,[c(w,{label:`Receipt Note`},{default:f(()=>[i(`div`,ue,v(Z.value.return_received_note),1)]),_:1})])):a(``,!0)])])):a(``,!0),i(`div`,de,[l[21]||=i(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[i(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Return Items`)],-1),i(`div`,fe,[i(`table`,pe,[i(`thead`,me,[i(`tr`,null,[l[12]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Item`,-1),l[13]||=i(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Quantity`,-1),l[14]||=i(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Unit Price`,-1),l[15]||=i(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},[i(`abbr`,{title:`Discount %`},`Dis %`)],-1),l[16]||=i(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},[i(`abbr`,{title:`Tax %`},`TAX %`)],-1),l[17]||=i(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},[i(`abbr`,{title:`TTC price`},`TTC`)],-1),l[18]||=i(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Total`,-1),_(C)(Z.value.currency.code)?a(``,!0):(d(),o(`th`,he,`Total USD`))])]),i(`tbody`,ge,[(d(!0),o(r,null,re(Z.value.items,t=>(d(),o(`tr`,{key:t.id},[i(`td`,_e,[i(`div`,ve,[i(`div`,ye,[t.item?.image?(d(),o(`img`,{key:0,src:t.item.image,alt:t.item?.description,class:`h-10 w-10 rounded object-cover`},null,8,be)):(d(),o(`div`,xe,[c(_(e),{class:`h-6 w-6 text-gray-400`})]))]),i(`div`,Se,[i(`div`,Ce,v(t.item?.description),1),i(`div`,we,v(t.item_code),1)])])]),i(`td`,Te,v(_(x)(t.quantity)),1),i(`td`,Ee,v(_(S)(t.price,!0,Z.value.currency)),1),i(`td`,De,v(_(x)(t.discount_percent)),1),i(`td`,Oe,v(_(x)(t.tax_percent)),1),i(`td`,ke,v(_(x)(t.ttc_price)),1),i(`td`,Ae,v(_(S)(t.total_price,!0,Z.value.currency)),1),_(C)(Z.value.currency.code)?a(``,!0):(d(),o(`td`,je,v(_(S)(t.total_price_usd,!0)),1))]))),128))]),i(`tfoot`,null,[l[19]||=i(`td`,{colspan:`5`},null,-1),l[20]||=i(`td`,{class:`px-6 py-4 text-right`},`Total`,-1),i(`td`,Me,v(_(S)(Z.value.total,!0,Z.value.currency)),1),_(C)(Z.value.currency.code)?a(``,!0):(d(),o(`td`,Ne,v(_(S)(Z.value.total_usd)),1))])])])]),i(`div`,Pe,[l[22]||=i(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[i(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Summary`)],-1),i(`div`,Fe,[i(`div`,Ie,[c(w,{label:`Total Volume`,value:`${_(x)(Z.value.total_volume_cbm)} cbm`},null,8,[`value`]),c(w,{label:`Total Weight`,value:`${_(x)(Z.value.total_weight_kg)} kg`},null,8,[`value`]),c(w,{label:`Total Items`,value:Z.value.items?.length||0},null,8,[`value`])])])])])):a(``,!0),c(T,{show:$.value,"onUpdate:show":l[1]||=e=>$.value=e,"return-order":Z.value,onMarkedReceived:We},null,8,[`show`,`return-order`])])}}}),X=Y;export{X as default};
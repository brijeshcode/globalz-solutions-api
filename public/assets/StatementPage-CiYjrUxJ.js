import{D as e,M as t,aC as n,aE as ee,aF as r,aG as i,aI as a,aK as o,aL as te,aR as ne,aS as s,aU as c,aV as l,aW as re,aY as u,ag as ie,ak as ae,al as oe,as as d,aw as se,ay as ce,az as f,o as le,u as ue}from"./index-C4TowTdd.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-jdfVzp2e.js";import{b as de}from"./PageHeader-DDEE0Cko.js";import{b as p,c as fe}from"./common-DPsEy-Xi.js";import{b as m}from"./customersStore-C4tBL41X.js";const h={class:`space-y-6`},g=[`disabled`],_={class:`bg-white dark:bg-gray-800 shadow rounded-lg p-4`},v={class:`grid grid-cols-1 md:grid-cols-6 gap-4`},y={class:`md:col-span-2`},b={class:`relative`},x={class:`bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden`},S={key:0,class:`p-8 text-center`},C={key:1,class:`p-8 text-center`},w={class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},T={key:2,class:`overflow-x-auto`},E={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},D={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},O={class:`px-4 py-1 whitespace-nowrap`},k={class:`text-sm text-gray-900 dark:text-white`},A={class:`px-4 py-1 whitespace-nowrap`},j={class:`px-4 py-1 whitespace-nowrap`},M={class:`text-sm text-gray-900 dark:text-white`},N={class:`px-4 py-1 whitespace-nowrap`},P={class:`text-sm text-gray-900 dark:text-white`},F={class:`px-4 py-1 whitespace-nowrap text-right`},I={class:`text-sm font-medium text-red-600 dark:text-red-400`},pe={class:`px-4 py-1 whitespace-nowrap text-right`},L={class:`text-sm font-medium text-green-600 dark:text-green-400`},R={class:`px-4 py-1 whitespace-nowrap text-right`},z={class:`font-bold`},B={class:`px-4 py-1 whitespace-nowrap text-right`},me={class:`px-4 py-1 whitespace-nowrap text-right`},he={class:`px-4 py-1 whitespace-nowrap text-right`};var V=i({__name:`StatementPage`,setup(i){let V=ae(),H=oe(),ge=ie(),U=m(),W=ce(()=>parseInt(V.params.id)),G=c(!1),K=c([]),q=c([]),J=c(``),Y=c(null),X=c({search:``,from_date:``,to_date:``,transaction_type:``,withPage:!1}),Z=async()=>{try{G.value=!0;let e=await U.fetchCustomerStatements(W.value,X.value);console.log(e),K.value=e.data,q.value=e.stats}catch(e){ge.error(`Failed to load customer statements`,{title:`Error`}),console.error(`Error fetching statements:`,e)}finally{G.value=!1}},_e=()=>{Y.value&&clearTimeout(Y.value),Y.value=setTimeout(()=>{Z()},300)},Q=()=>{Z()},$=()=>{X.value={search:``,from_date:``,to_date:``,transaction_type:``,withPage:!1},Z()},ve=e=>{let t={sales:`Sales`,payments:`Payment`,credit_note:`Credit Note`,debit_note:`Debit Note`,returns:`Return`};return t[e]||e},ye=async()=>{try{let e=await U.fetchCustomer(W.value);J.value=e.name}catch(e){console.error(`Error fetching customer details:`,e)}},be=()=>{H.push({name:`customers.statement.preview`,params:{id:W.value},query:{from_date:X.value.from_date,to_date:X.value.to_date,search:X.value.search,transaction_type:X.value.transaction_type}})};return a(async()=>{try{await Promise.all([ye(),Z()])}catch(e){console.error(`Error loading initial data:`,e)}}),(i,a)=>(o(),n(`div`,h,[r(de,{title:`Customer Statement - ${J.value}`,description:`View customer transaction history including sales, payments, and notes`,showCreateButton:!1},{actions:ne(()=>[f(`button`,{onClick:be,disabled:K.value.length===0,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},[r(l(ue),{class:`w-4 h-4 mr-2`}),a[3]||=ee(` Print Preview `,-1)],8,g)]),_:1},8,[`title`]),f(`div`,_,[f(`div`,v,[f(`div`,y,[a[4]||=f(`label`,{for:`search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Search `,-1),f(`div`,b,[s(f(`input`,{id:`search`,"onUpdate:modelValue":a[0]||=e=>X.value.search=e,type:`text`,placeholder:`Search note...`,class:`block w-full px-3 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 sm:text-sm transition-colors duration-200`,onInput:_e},null,544),[[d,X.value.search]]),r(l(le),{class:`absolute left-3 top-2.5 h-5 w-5 text-gray-400`})])]),f(`div`,null,[a[5]||=f(`label`,{for:`from_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` From Date `,-1),s(f(`input`,{id:`from_date`,"onUpdate:modelValue":a[1]||=e=>X.value.from_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:Q},null,544),[[d,X.value.from_date]])]),f(`div`,null,[a[6]||=f(`label`,{for:`to_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` To Date `,-1),s(f(`input`,{id:`to_date`,"onUpdate:modelValue":a[2]||=e=>X.value.to_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:Q},null,544),[[d,X.value.to_date]])]),f(`div`,{class:`flex items-end`},[f(`button`,{onClick:$,class:`w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200`},` Clear `)])])]),f(`div`,x,[G.value?(o(),n(`div`,S,[r(l(e),{class:`h-8 w-8 animate-spin mx-auto text-blue-600 dark:text-blue-400`}),a[7]||=f(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},`Loading statements...`,-1)])):K.value.length===0?(o(),n(`div`,C,[r(l(t),{class:`h-12 w-12 mx-auto text-gray-400`}),a[8]||=f(`h3`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},` No statements found `,-1),f(`p`,w,u(X.value.search||X.value.transaction_type?`Try adjusting your search criteria.`:`No transactions available for this customer.`),1)])):(o(),n(`div`,T,[f(`table`,E,[a[13]||=f(`thead`,{class:`bg-gray-50 dark:bg-gray-700`},[f(`tr`,null,[f(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Date `),f(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Type `),f(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Transaction ID `),f(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Note `),f(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Debit `),f(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Credit `),f(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Balance `)])],-1),f(`tbody`,D,[a[11]||=f(`tr`,null,[f(`td`,{class:`px-4 py-1 whitespace-nowrap`,colspan:`3`}),f(`td`,{class:`px-4 py-1 whitespace-nowrap`},`Old Balance`),f(`td`,{class:`px-4 py-1 whitespace-nowrap text-right`},`0`),f(`td`,{class:`px-4 py-1 whitespace-nowrap text-right`},`0`),f(`td`,{class:`px-4 py-1 whitespace-nowrap text-right`},`0`)],-1),(o(!0),n(se,null,te(K.value,e=>(o(),n(`tr`,{key:e.id,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[f(`td`,O,[f(`div`,k,u(l(fe)(e.date)),1)]),f(`td`,A,u(ve(e.type)),1),f(`td`,j,[f(`div`,M,u(e.code||`-`),1)]),f(`td`,N,[f(`div`,P,u(e.note||`-`),1)]),f(`td`,F,[f(`div`,I,u(e.debit?l(p)(e.debit,`usd`):`-`),1)]),f(`td`,pe,[f(`div`,L,u(e.credit?l(p)(e.credit,`usd`):`-`),1)]),f(`td`,R,[f(`div`,{class:re([`text-sm font-medium`,e.balance>=0?`text-green-600 dark:text-green-400`:`text-red-600 dark:text-red-400`])},u(l(p)(e.balance,`usd`)),3)])]))),128)),a[12]||=f(`tr`,null,[f(`td`,{class:`px-4 py-2`,colspan:`7`},`\xA0`)],-1),f(`tr`,z,[a[9]||=f(`td`,{class:`px-4 py-1 whitespace-nowrap`,colspan:`3`},null,-1),a[10]||=f(`td`,{class:`px-4 py-1 whitespace-nowrap`},`Total`,-1),f(`td`,B,u(q.value.total_debit),1),f(`td`,me,u(q.value.total_credit),1),f(`td`,he,u(q.value.balance),1)])])])]))])]))}}),H=V;export{H as default};
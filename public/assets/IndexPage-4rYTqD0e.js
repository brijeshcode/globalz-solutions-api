import{F as e,O as t,a$ as n,aB as r,aC as i,aE as a,aF as o,aH as ee,aI as s,aJ as c,aN as l,aO as u,aU as te,aV as d,aX as f,aY as p,aZ as ne,aj as m,ao as re,av as h,az as g,e as ie,f as ae,p as _,u as v,w as oe}from"./index-D8iTb-rV.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-jdfVzp2e.js";import{b as se}from"./PageHeader-CtCtKe2W.js";import{b as y,c as ce,f as b}from"./common-DPsEy-Xi.js";import{b as x}from"./StatCard-CRdDA0z6.js";import{b as le}from"./customersStore-DpEGvB58.js";const ue={class:`space-y-6`},de=[`disabled`],fe={class:`bg-white dark:bg-gray-800 shadow rounded-lg p-4`},pe={class:`grid grid-cols-1 md:grid-cols-3 gap-4`},me={class:`md:col-span-2`},he={class:`relative`},ge={key:0,class:`absolute z-10 mt-1 w-full md:w-2/3 bg-white dark:bg-gray-700 shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm`},S=[`onClick`],C={class:`flex items-center`},w={class:`font-medium block truncate text-gray-900 dark:text-white`},T={class:`text-gray-500 dark:text-gray-400 ml-2 text-xs block truncate`},E={key:0,class:`flex items-end`},D={class:`w-full p-3 bg-blue-50 dark:bg-blue-900 rounded-md`},O={class:`flex justify-between items-start`},k={class:`text-sm font-medium text-blue-900 dark:text-blue-100`},A={class:`text-xs text-blue-700 dark:text-blue-300`},j={key:0,class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6`},M={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg p-4`},N={class:`grid grid-cols-1 md:grid-cols-6 gap-4`},P={class:`md:col-span-2`},F={class:`relative`},I={key:2,class:`bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden`},L={key:0,class:`p-8 text-center`},_e={key:1,class:`p-8 text-center`},ve={class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},ye={key:2,class:`overflow-x-auto`},be={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},xe={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},Se={class:`px-4 py-1 whitespace-nowrap`},Ce={class:`text-sm text-gray-900 dark:text-white`},we={class:`px-4 py-1 whitespace-nowrap`},Te={class:`px-4 py-1 whitespace-nowrap`},Ee=[`onClick`],De={key:1,class:`text-sm text-gray-900 dark:text-white`},Oe={class:`px-4 py-1 whitespace-nowrap`},ke={class:`text-sm text-gray-900 dark:text-white`},Ae={class:`px-4 py-1 whitespace-nowrap text-right`},je={class:`text-sm font-medium text-red-600 dark:text-red-400`},Me={class:`px-4 py-1 whitespace-nowrap text-right`},Ne={class:`text-sm font-medium text-green-600 dark:text-green-400`},Pe={class:`px-4 py-1 whitespace-nowrap text-right`},Fe={key:3,class:`bg-white dark:bg-gray-800 shadow rounded-lg p-12 text-center`};var R=c({__name:`IndexPage`,setup(c){let R=re(),z=m(),B=le(),V=f(!1),H=f([]),U=f({}),W=f(null),G=f(null),K=f(``),q=f([]),J=f(null),Y=f({search:``,from_date:``,to_date:``,transaction_type:``,withPage:!1}),X=r(()=>J.value?.id),Ie=()=>{G.value&&clearTimeout(G.value),G.value=setTimeout(async()=>{K.value.length>=2?await Le():q.value=[]},300)},Le=async()=>{try{await B.fetchCustomers({search:K.value,per_page:10}),q.value=B.customers}catch(e){console.error(`Error searching customers:`,e),z.error(`Failed to search customers`)}},Re=e=>{J.value=e,K.value=`${e.code} - ${e.name}`,q.value=[],Z()},ze=()=>{J.value=null,K.value=``,H.value=[],U.value={},$()},Z=async()=>{if(X.value)try{V.value=!0;let e=await B.fetchCustomerStatements(X.value,Y.value);H.value=e.data,U.value=e.stats}catch(e){z.error(`Failed to load customer statements`,{title:`Error`}),console.error(`Error fetching statements:`,e)}finally{V.value=!1}},Be=()=>{W.value&&clearTimeout(W.value),W.value=setTimeout(()=>{Z()},300)},Q=()=>{Z()},Ve=e=>{if(!e.id||!e.transaction_type)return;let t={sale:`sales.show`,payment:`customer.payments.show`,credit_debit_note:`customer.notes.show`,customer_returns:`customer.return.show`},n=t[e.transaction_type];if(!n)return;let r=R.resolve({name:n,params:{id:e.id}});window.open(r.href,`_blank`)},$=()=>{Y.value={search:``,from_date:``,to_date:``,transaction_type:``,withPage:!1},J.value&&Z()},He=e=>{let t={sales:`Sales`,payments:`Payment`,credit_note:`Credit Note`,debit_note:`Debit Note`,returns:`Return`};return t[e]||e},Ue=()=>{X.value&&R.push({name:`customers.statement.preview`,params:{id:X.value},query:{from_date:Y.value.from_date,to_date:Y.value.to_date,search:Y.value.search,transaction_type:Y.value.transaction_type}})};return(r,c)=>(l(),o(`div`,ue,[s(se,{title:`Customer Statements`,description:`Search and view customer transaction history including sales, payments, and notes`,showCreateButton:!1},{actions:te(()=>[J.value?(l(),o(`button`,{key:0,onClick:Ue,disabled:H.value.length===0,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},[s(p(oe),{class:`w-4 h-4 mr-2`}),c[4]||=ee(` Print Preview `,-1)],8,de)):a(``,!0)]),_:1}),i(`div`,fe,[i(`div`,pe,[i(`div`,me,[c[5]||=i(`label`,{for:`customer-search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Search Customer (by name or code) `,-1),i(`div`,he,[d(i(`input`,{id:`customer-search`,"onUpdate:modelValue":c[0]||=e=>K.value=e,type:`text`,placeholder:`Enter customer name or code...`,class:`block w-full px-3 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 sm:text-sm transition-colors duration-200`,onInput:Ie},null,544),[[h,K.value]]),s(p(_),{class:`absolute left-3 top-2.5 h-5 w-5 text-gray-400`})]),q.value.length>0&&K.value?(l(),o(`div`,ge,[(l(!0),o(g,null,u(q.value,e=>(l(),o(`div`,{key:e.id,onClick:t=>Re(e),class:`cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-gray-100 dark:hover:bg-gray-600`},[i(`div`,C,[i(`span`,w,n(e.code)+` - `+n(e.name),1)]),i(`span`,T,n(e.city),1)],8,S))),128))])):a(``,!0)]),J.value?(l(),o(`div`,E,[i(`div`,D,[i(`div`,O,[i(`div`,null,[i(`p`,k,n(J.value.code)+` - `+n(J.value.name),1),i(`p`,A,n(J.value.city),1)]),i(`button`,{onClick:ze,class:`text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200`},[s(p(ie),{class:`h-4 w-4`})])])])])):a(``,!0)])]),J.value?(l(),o(`div`,j,[s(x,{label:`Balance`,value:p(b)(U.value.balance),icon:p(v),"icon-color":`blue`},null,8,[`value`,`icon`]),s(x,{label:`Credit`,value:p(b)(U.value.total_credit),icon:p(v),"icon-color":`green`},null,8,[`value`,`icon`]),s(x,{label:`Debit`,value:p(b)(U.value.total_debit),icon:p(v),"icon-color":`red`},null,8,[`value`,`icon`])])):a(``,!0),J.value?(l(),o(`div`,M,[i(`div`,N,[i(`div`,P,[c[6]||=i(`label`,{for:`search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Search Note `,-1),i(`div`,F,[d(i(`input`,{id:`search`,"onUpdate:modelValue":c[1]||=e=>Y.value.search=e,type:`text`,placeholder:`Search note...`,class:`block w-full px-3 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 sm:text-sm transition-colors duration-200`,onInput:Be},null,544),[[h,Y.value.search]]),s(p(_),{class:`absolute left-3 top-2.5 h-5 w-5 text-gray-400`})])]),i(`div`,null,[c[7]||=i(`label`,{for:`from_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` From Date `,-1),d(i(`input`,{id:`from_date`,"onUpdate:modelValue":c[2]||=e=>Y.value.from_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:Q},null,544),[[h,Y.value.from_date]])]),i(`div`,null,[c[8]||=i(`label`,{for:`to_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` To Date `,-1),d(i(`input`,{id:`to_date`,"onUpdate:modelValue":c[3]||=e=>Y.value.to_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:Q},null,544),[[h,Y.value.to_date]])]),i(`div`,{class:`flex items-end`},[i(`button`,{onClick:$,class:`w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200`},` Clear `)])])])):a(``,!0),J.value?(l(),o(`div`,I,[V.value?(l(),o(`div`,L,[s(p(e),{class:`h-8 w-8 animate-spin mx-auto text-blue-600 dark:text-blue-400`}),c[9]||=i(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},`Loading statements...`,-1)])):H.value.length===0?(l(),o(`div`,_e,[s(p(t),{class:`h-12 w-12 mx-auto text-gray-400`}),c[10]||=i(`h3`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},` No statements found `,-1),i(`p`,ve,n(Y.value.search||Y.value.transaction_type?`Try adjusting your search criteria.`:`No transactions available for this customer.`),1)])):(l(),o(`div`,ye,[i(`table`,be,[c[14]||=i(`thead`,{class:`bg-gray-50 dark:bg-gray-700`},[i(`tr`,null,[i(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Date `),i(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Type `),i(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Transaction ID `),i(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Note `),i(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Debit `),i(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Credit `),i(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Balance `)])],-1),i(`tbody`,xe,[(l(!0),o(g,null,u(H.value,e=>(l(),o(`tr`,{key:e.id,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[i(`td`,Se,[i(`div`,Ce,n(p(ce)(e.date)),1)]),i(`td`,we,n(He(e.type)),1),i(`td`,Te,[e.code?(l(),o(`div`,{key:0,onClick:t=>Ve(e),class:`text-sm text-blue-600 dark:text-blue-400 cursor-zoom-in hover:underline`},n(e.code),9,Ee)):(l(),o(`div`,De,` - `))]),i(`td`,Oe,[i(`div`,ke,n(e.note||`-`),1)]),i(`td`,Ae,[i(`div`,je,n(e.debit?p(y)(e.debit,`usd`):`-`),1)]),i(`td`,Me,[i(`div`,Ne,n(e.credit?p(y)(e.credit,`usd`):`-`),1)]),i(`td`,Pe,[i(`div`,{class:ne([`text-sm font-medium`,e.balance>=0?`text-green-600 dark:text-green-400`:`text-red-600 dark:text-red-400`])},n(p(y)(e.balance,`usd`)),3)])]))),128)),c[13]||=i(`tr`,null,[i(`td`,{class:`px-4 py-2`,colspan:`7`},`\xA0`)],-1),a(``,!0)])])]))])):(l(),o(`div`,Fe,[s(p(ae),{class:`h-16 w-16 mx-auto text-gray-400 mb-4`}),c[15]||=i(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-2`},` Select a Customer `,-1),c[16]||=i(`p`,{class:`text-sm text-gray-500 dark:text-gray-400`},` Search and select a customer to view their statement `,-1)]))]))}}),z=R;export{z as default};
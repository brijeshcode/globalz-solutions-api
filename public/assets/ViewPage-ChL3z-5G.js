import{$ as e,M as t,R as n,S as r,U as i,V as a,a$ as o,aD as ee,aF as te,aG as s,aH as ne,aI as c,aJ as l,aL as u,aM as d,aN as re,aP as ie,aR as f,aS as ae,aV as oe,aY as p,ab as se,ar as ce,as as le,b0 as m,b1 as h,b3 as g,h as ue,p as de}from"./index-DMU9rpXT.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-BFc6-TYF.js";import{d as _}from"./common-DNevajli.js";import{b as v}from"./currencyUtil-DFY2m5KW.js";import{b as y}from"./DataItems-myrjCmz7.js";import{b as fe,c as b}from"./SystemInfoCard-DXqpeQvm.js";import{b as x}from"./documentService-Cgcy_0n1.js";import{b as pe}from"./customersStore-DmnCoJQX.js";const S={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8`},C={class:`mb-8`},w={class:`flex items-center justify-between`},T={class:`flex items-center space-x-4`},E={class:`text-3xl font-bold text-gray-900 dark:text-gray-100`},D={class:`text-sm text-gray-600 dark:text-gray-400 mt-1`},O={class:`flex items-center space-x-3`},k={key:0,class:`flex items-center justify-center py-12`},A={key:1,class:`bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6`},j={class:`flex items-center`},M={class:`text-red-600 dark:text-red-400 mt-1`},N={key:2,class:`space-y-8`},P=[`href`],F={key:1},I=[`href`],L={key:1},R=[`href`],z={key:1},B=[`href`],me={key:1},he={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},ge={class:`px-6 py-5 border-b border-gray-200 dark:border-gray-700`},_e={class:`flex items-center justify-between`},ve={class:`text-lg font-medium text-gray-900 dark:text-gray-100`},ye={class:`px-6 py-5`},be={class:`grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3`},xe={class:`flex items-start space-x-3`},Se={class:`flex-shrink-0`},Ce={class:`flex-1 min-w-0`},we={class:`text-sm font-medium text-gray-900 dark:text-gray-100 truncate`},Te={class:`text-xs text-gray-500 dark:text-gray-400 mt-1`},Ee={class:`text-xs text-gray-500 dark:text-gray-400`},De={class:`flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity`},Oe={class:`flex space-x-2`},ke=[`onClick`],Ae=[`onClick`],je={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},Me={class:`px-6 py-8 text-center`},Ne={key:3,class:`fixed inset-0 z-50 overflow-y-auto`,"aria-labelledby":`modal-title`,role:`dialog`,"aria-modal":`true`},Pe={class:`flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0`},Fe={class:`inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full sm:p-6`},Ie={class:`absolute top-0 right-0 pt-4 pr-4`},Le={class:`mt-3 text-center sm:mt-5`},Re={class:`text-lg leading-6 font-medium text-gray-900 dark:text-gray-100 mb-4`},ze={key:0,class:`max-h-96 overflow-auto`},Be=[`src`,`alt`],Ve={key:1,class:`flex items-center justify-center py-8`},He={key:1,class:`h-96`},Ue=[`src`],We={key:1,class:`flex items-center justify-center py-8`},Ge={key:2,class:`text-center py-8`},Ke={class:`mt-5 sm:mt-6 flex justify-center space-x-3`};var V=re({__name:`ViewPage`,setup(re){let V=le(),H=ce(),qe=te(()=>parseInt(H.params.id)),Je=pe(),U=o(null),W=o(!1),G=o(``),K=o(!1),q=o(null),J=o(``),Y=async()=>{try{W.value=!0,G.value=``,U.value=await Je.fetchCustomer(qe.value)}catch(e){G.value=e.message||`Failed to load customer details`,console.error(`Error loading customer:`,e)}finally{W.value=!1}},Ye=()=>{V.push({name:`customer.index`})},Xe=()=>{U.value&&V.push({name:`customer.edit`,params:{id:U.value.id.toString()}})},X=async e=>{await x.download(e)},Ze=async e=>{try{q.value=e,K.value=!0;let t=await x.preview(e.id);J.value=t.preview_url}catch(t){console.error(`Error getting preview URL:`,t),J.value=$e(e)}},Z=()=>{K.value=!1,q.value=null,J.value=``},Qe=e=>Q(e)||$(e),Q=e=>{let t=e.file_extension?.toLowerCase();return[`jpg`,`jpeg`,`png`,`gif`,`bmp`,`svg`,`webp`].includes(t||``)},$=e=>{let t=e.file_extension?.toLowerCase();return t===`pdf`},$e=e=>{let t=`https://staging.globalzsolutions.com`;return`${t}/api/documents/${e.id}/preview`},et=e=>{let i=e?.toLowerCase();return[`jpg`,`jpeg`,`png`,`gif`,`bmp`,`svg`].includes(i)?t:[`pdf`].includes(i)?r:n};return ie(()=>{Y()}),(t,n)=>(f(),l(`div`,S,[s(`div`,C,[s(`div`,w,[s(`div`,T,[s(`button`,{onClick:Ye,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[d(m(se),{class:`w-5 h-5`})]),s(`div`,null,[s(`h1`,E,g(U.value?.name||`Customer Details`),1),s(`p`,D,` Customer Code: `+g(U.value?.code),1)])]),s(`div`,O,[U.value?(f(),l(`span`,{key:0,class:h([`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium`,U.value?.is_active?`bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300`:`bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300`])},g(U.value?.is_active?`Active`:`Inactive`),3)):c(``,!0),s(`button`,{onClick:Xe,class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700`},[d(m(de),{class:`w-4 h-4 mr-2`}),n[1]||=u(` Edit `,-1)])])])]),W.value?(f(),l(`div`,k,n[2]||=[s(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mr-4`},null,-1),s(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading customer details...`,-1)])):G.value?(f(),l(`div`,A,[s(`div`,j,[d(m(e),{class:`w-6 h-6 text-red-500 mr-3`}),s(`div`,null,[n[3]||=s(`h3`,{class:`text-lg font-medium text-red-800 dark:text-red-300`},`Error Loading Customer`,-1),s(`p`,M,g(G.value),1)])])])):U.value?(f(),l(`div`,N,[d(b,{title:`General Information`},{default:p(()=>[d(y,{label:`Customer Name`,value:U.value.name},null,8,[`value`]),d(y,{label:`Code`,value:U.value.code},null,8,[`value`]),d(y,{label:`Type`,value:U.value.customer_type?.name},null,8,[`value`]),d(y,{label:`Group`,value:U.value.customer_group?.name},null,8,[`value`]),d(y,{label:`Opening Balance`,value:m(v)(U.value.opening_balance)},null,8,[`value`]),d(y,{label:`Current Balance`,value:m(v)(U.value.current_balance)},null,8,[`value`]),d(y,{label:`Credit Limit`,value:m(v)(U.value.credit_limit)},null,8,[`value`]),d(y,{label:`MOF #`,value:U.value.mof_tax_number},null,8,[`value`]),d(y,{label:`Status`},{default:p(()=>[s(`span`,{class:h([`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium`,U.value.is_active?`bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300`:`bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300`])},g(U.value.is_active?`Active`:`Inactive`),3)]),_:1})]),_:1}),d(b,{title:`Contact Information`},{default:p(()=>[d(y,{label:`Address`,value:U.value.address,class:`sm:col-span-3`},null,8,[`value`]),d(y,{label:`Contact Person`,value:U.value.contact_name},null,8,[`value`]),d(y,{label:`City`,value:U.value.city},null,8,[`value`]),d(y,{label:`Province`,value:U.value.customer_province?.name},null,8,[`value`]),d(y,{label:`GPS`,value:U.value.gps_coordinates},null,8,[`value`]),d(y,{label:`Zone`,value:U.value.customer_zone?.name},null,8,[`value`]),d(y,{label:`Telephone`},{default:p(()=>[U.value.telephone?(f(),l(`a`,{key:0,href:`tel:${U.value.telephone}`,class:`text-indigo-600 hover:text-indigo-500`},g(U.value.telephone),9,P)):(f(),l(`span`,F,`No telephone number`))]),_:1}),d(y,{label:`Mobile`},{default:p(()=>[U.value.mobile?(f(),l(`a`,{key:0,href:`tel:${U.value.mobile}`,class:`text-indigo-600 hover:text-indigo-500`},g(U.value.mobile),9,I)):(f(),l(`span`,L,`No mobile number`))]),_:1}),d(y,{label:`Email`},{default:p(()=>[U.value.email?(f(),l(`a`,{key:0,href:`mailto:${U.value.email}`,class:`text-indigo-600 hover:text-indigo-500`},g(U.value.email),9,R)):(f(),l(`span`,z,`No email`))]),_:1}),d(y,{label:`Website`},{default:p(()=>[U.value.website?(f(),l(`a`,{key:0,href:U.value.website,target:`_blank`,class:`text-indigo-600 hover:text-indigo-500`},g(U.value.website),9,B)):(f(),l(`span`,me,`No website`))]),_:1})]),_:1}),d(b,{title:`Sales Information`,gridCols:`cols-2`},{default:p(()=>[d(y,{label:`Salesperson`,value:U.value.salesperson?`${U.value.salesperson.name} (${U.value.salesperson.code})`:null},null,8,[`value`]),d(y,{label:`Payment Term`,value:U.value.customer_payment_term?.name},null,8,[`value`]),d(y,{label:`Discount Percentage`,value:U.value.discount_percentage?`${U.value.discount_percentage}%`:null},null,8,[`value`]),d(y,{label:`Notes`,value:U.value.notes,class:`sm:col-span-2`},null,8,[`value`])]),_:1}),U.value.documents&&U.value.documents.length>0?(f(),l(`div`,he,[s(`div`,ge,[s(`div`,_e,[s(`h3`,ve,` Documents (`+g(U.value.documents.length)+`) `,1)])]),s(`div`,ye,[s(`div`,be,[(f(!0),l(ee,null,ae(U.value.documents,e=>(f(),l(`div`,{key:e.id,class:`relative group bg-gray-50 dark:bg-gray-700 rounded-lg p-4 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors`},[s(`div`,xe,[s(`div`,Se,[(f(),ne(oe(et(e.file_extension)),{class:`h-8 w-8 text-gray-400`}))]),s(`div`,Ce,[s(`p`,we,g(e.title||e.original_name),1),s(`p`,Te,g(e.file_size_human),1),s(`p`,Ee,g(m(_)(e.created_at)),1)]),s(`div`,De,[s(`div`,Oe,[Qe(e)?(f(),l(`button`,{key:0,onClick:t=>Ze(e),class:`text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300`,title:`Preview`},[d(m(i),{class:`h-5 w-5`})],8,ke)):c(``,!0),s(`button`,{onClick:t=>X(e),class:`text-indigo-600 hover:text-indigo-500 dark:text-indigo-400 dark:hover:text-indigo-300`,title:`Download`},[d(m(a),{class:`h-5 w-5`})],8,Ae)])])])]))),128))])])])):(f(),l(`div`,je,[n[6]||=s(`div`,{class:`px-6 py-5 border-b border-gray-200 dark:border-gray-700`},[s(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-gray-100`},` Documents `)],-1),s(`div`,Me,[d(m(r),{class:`mx-auto h-12 w-12 text-gray-400`}),n[4]||=s(`h3`,{class:`mt-4 text-sm font-medium text-gray-900 dark:text-gray-100`},`No documents`,-1),n[5]||=s(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},` No documents have been uploaded for this customer. `,-1)])])),d(fe,{item:U.value,formatDateTime:m(_)},null,8,[`item`,`formatDateTime`])])):c(``,!0),K.value?(f(),l(`div`,Ne,[s(`div`,Pe,[s(`div`,{class:`fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity`,onClick:Z}),s(`div`,Fe,[s(`div`,Ie,[s(`button`,{onClick:Z,class:`bg-white dark:bg-gray-800 rounded-md text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none`},[d(m(ue),{class:`h-6 w-6`})])]),s(`div`,Le,[s(`h3`,Re,g(q.value?.title||q.value?.original_name),1),q.value&&Q(q.value)?(f(),l(`div`,ze,[J.value?(f(),l(`img`,{key:0,src:J.value,alt:q.value.original_name,class:`max-w-full h-auto mx-auto rounded-lg shadow-lg`},null,8,Be)):(f(),l(`div`,Ve,n[7]||=[s(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mr-4`},null,-1),s(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading preview...`,-1)]))])):q.value&&$(q.value)?(f(),l(`div`,He,[J.value?(f(),l(`iframe`,{key:0,src:J.value,class:`w-full h-full border rounded-lg`,title:`PDF Preview`,frameborder:`0`},null,8,Ue)):(f(),l(`div`,We,n[8]||=[s(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mr-4`},null,-1),s(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading preview...`,-1)]))])):(f(),l(`div`,Ge,[d(m(r),{class:`mx-auto h-12 w-12 text-gray-400 mb-4`}),n[9]||=s(`p`,{class:`text-gray-500 dark:text-gray-400`},`Preview not available for this file type.`,-1)]))]),s(`div`,Ke,[s(`button`,{onClick:n[0]||=e=>X(q.value),class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700`},[d(m(a),{class:`h-4 w-4 mr-2`}),n[10]||=u(` Download `,-1)]),s(`button`,{onClick:Z,class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600`},` Close `)])])])])):c(``,!0)]))}}),H=V;export{H as default};
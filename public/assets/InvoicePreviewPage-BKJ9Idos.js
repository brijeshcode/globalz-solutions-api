import{$ as e,A as t,aA as n,aB as r,aD as i,aF as a,aG as o,aP as s,aQ as c,aT as l,ac as u,ag as d,ah as f,ar as p,at as m,au as h,aw as g,ax as _,ay as v,az as y,s as b}from"./index-DxFhYz3N.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-jdfVzp2e.js";import{b as ee}from"./salesStore-D93nuA4B.js";import{b as x}from"./companyStore-B_FiVisM.js";const S={class:`max-w-4xl mx-auto p-8 bg-white text-gray-900 print:h-full print:p-0 print:max-w-none print:mx-0`},C={class:`header`},w={class:`flex justify-between items-start mb-10 pb-6 border-b-2 border-blue-600 print:border-black print:mb-6`},T={key:0,class:`flex-1`},E={class:`flex items-center mb-3`},te=[`src`,`alt`],D={key:1,class:`text-3xl font-bold text-blue-600 print:text-black print:text-2xl`},O={key:0},k={class:`print:text-black`},A={class:`text-right flex-1 mt-4`},j={class:`text-lg font-semibold text-gray-600 print:text-black print:text-base`},M={class:`grid grid-cols-1 md:grid-cols-2 gap-8 mb-10 print:grid-cols-2 print:gap-6 print:mb-6`},N={class:`space-y-1 print:space-y-0`},P={class:`flex justify-between print:justify-between`},F={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},I={class:`flex justify-between print:justify-between`},L={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},R={key:0,class:`flex justify-between print:justify-between`},z={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},B={key:1,class:`flex justify-between print:justify-between`},V={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},H={key:2,class:`flex justify-between print:justify-between`},U={class:`text-red-600 font-bold print:font-normal print:text-black print:text-xs`},W={class:`space-y-1 print:space-y-0`},G={class:`flex justify-between print:justify-between`},K={class:`text-gray-900 print:text-black print:text-xs`},q={class:`flex justify-between print:justify-between`},J={class:`text-gray-900 print:text-black print:text-xs`},Y={key:0,class:`flex justify-between print:justify-between`},X={class:`text-gray-900 print:text-black print:text-xs`},Z={class:`body`},Q={class:`mb-8 print:mb-4`},ne={class:`overflow-x-auto print:overflow-visible`},re={class:`w-full border-collapse border border-gray-300 print:border-black`},ie={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center print:border-black print:text-black print:text-xs`},ae={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},oe={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},se={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center print:border-black print:text-black print:text-xs`},ce={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center print:border-black print:text-black print:text-xs`},le={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center print:border-black print:text-black print:text-xs`},ue={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center print:border-black print:text-black print:text-xs`},de={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center font-semibold print:border-black print:text-black print:text-xs`},fe={class:`border-t-2 border-gray-400 print:border-t-2 print:border-black`},pe={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-black print:text-xs`},me={colspan:`4`,class:`print:border-black text-center relative`},he=[`src`,`alt`],ge={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-black print:text-xs`},_e={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-black print:text-xs`},ve={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-lg print:border-black print:text-black print:text-xs`},ye={class:`footer print:block hidden print:fixed print:bottom-0 print:left-0 print:right-0`},be={class:`border-t-2 border-gray-300 print:border-black pt-4 pb-2`},xe={key:0,class:`mt-2 print:mt-1`},Se={class:`flex flex-wrap gap-2 text-sm text-gray-600 print:text-black print:text-xs justify-between`},Ce={key:0,class:`flex-1`},we={key:1,class:`flex-1 text-center`},Te={key:2,class:`flex-1 text-center`},Ee={key:3,class:`flex-1 text-right`};var De=r({__name:`SaleInvoice`,props:{saleData:{},customers:{default:()=>[]},warehouses:{default:()=>[]},currencies:{default:()=>[]},salespersons:{default:()=>[]},items:{default:()=>[]}},setup(e,{expose:t}){let n=e,r=x();i(async()=>{try{r.company.name||await r.fetchCompany()}catch(e){console.error(`Failed to fetch company data:`,e)}});let s=m(()=>{let e=n.saleData.items?.length||0,t=20;return e>=t?0:t-e}),u=e=>e?parseFloat(Number(e).toFixed(2)).toString():`0`,d=()=>n.saleData.prefix===`INV`,f=e=>e?Number(e).toLocaleString(`en-US`,{minimumFractionDigits:2,maximumFractionDigits:2}):`0.00`,y=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleDateString(`en-US`,{year:`numeric`,month:`long`,day:`numeric`})},b=()=>{window.print()};return t({printInvoice:b}),(e,t)=>(a(),_(`div`,S,[h(`section`,C,[h(`div`,w,[d()?(a(),_(`div`,T,[h(`div`,E,[c(r).company.logo?.preview_url?(a(),_(`img`,{key:0,src:c(r).company.logo.preview_url,alt:c(r).company.name||`Company Logo`,class:`h-16 w-auto mr-4 print:h-12`},null,8,te)):g(``,!0),c(r).company.logo?.preview_url?g(``,!0):(a(),_(`div`,D,l(c(r).company.name),1))]),c(r).company.tax_number?(a(),_(`div`,O,[h(`p`,k,[h(`b`,null,`Tax Registration #: `+l(c(r).company.tax_number),1)])])):g(``,!0)])):g(``,!0),h(`div`,A,[t[0]||=h(`h1`,{class:`text-2xl font-bold text-blue-600 mb-2 print:text-black print:text-xl`},`SALES INVOICE`,-1),h(`div`,j,l(e.saleData.prefix)+`-`+l(e.saleData.code),1)])]),h(`div`,M,[h(`div`,null,[t[6]||=h(`h3`,{class:`text-lg font-bold text-blue-600 mb-3 print:text-sm border-b border-gray-200 print:text-black print:border-black`},`Customer Information`,-1),h(`div`,N,[h(`div`,P,[t[1]||=h(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Customer:`,-1),h(`span`,F,l(e.saleData.customer?.code)+`, `+l(e.saleData.customer?.name||`Unknown Customer`),1)]),h(`div`,I,[t[2]||=h(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Address:`,-1),h(`span`,L,l(e.saleData.customer?.address)+`, `+l(e.saleData.customer?.city),1)]),e.saleData.customer?.mobile?(a(),_(`div`,R,[t[3]||=h(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Phone:`,-1),h(`span`,z,l(e.saleData.customer?.mobile),1)])):g(``,!0),e.saleData.customer?.mof_tax_number?(a(),_(`div`,B,[t[4]||=h(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Tax #:`,-1),h(`span`,V,l(e.saleData.customer?.mof_tax_number),1)])):g(``,!0),e.saleData.outStanding_balance&&Number(e.saleData.outStanding_balance)>0?(a(),_(`div`,H,[t[5]||=h(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Outstanding Balance:`,-1),h(`span`,U,l(f(e.saleData.outStanding_balance)),1)])):g(``,!0)])]),h(`div`,null,[t[10]||=h(`h3`,{class:`text-lg font-bold text-blue-600 mb-3 print:text-sm border-b border-gray-200 print:text-black print:border-black`},`Invoice Details`,-1),h(`div`,W,[h(`div`,G,[t[7]||=h(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Date:`,-1),h(`span`,K,l(y(e.saleData.date)),1)]),h(`div`,q,[t[8]||=h(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Currency:`,-1),h(`span`,J,l(e.saleData.currency?.code||`N/A`),1)]),e.saleData.salesperson?(a(),_(`div`,Y,[t[9]||=h(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Salesperson:`,-1),h(`span`,X,l(e.saleData.salesperson?.name||`Not assigned`),1)])):g(``,!0)])])])]),h(`section`,Z,[h(`div`,Q,[h(`div`,ne,[h(`table`,re,[t[21]||=h(`thead`,null,[h(`tr`,{class:`bg-gray-100 print:bg-gray-200`},[h(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`#`),h(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-left font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Item Code`),h(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-left font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Description`),h(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Price`),h(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center font-bold text-gray-700 print:border-black print:text-black print:text-xs`},[h(`abbr`,{title:`Discount Percentage`},`Dis. %`)]),h(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center font-bold text-gray-700 print:border-black print:text-black print:text-xs`},[h(`abbr`,{title:`Total Quantity`},`QTY`)]),h(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center font-bold text-gray-700 print:border-black print:text-black print:text-xs`},[h(`abbr`,{title:`Tax Percentage`},`Tax %`)]),h(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Total`)])],-1),h(`tbody`,null,[(a(!0),_(p,null,o(e.saleData.items,(e,t)=>(a(),_(`tr`,{key:t,class:`even:bg-gray-50 print:even:bg-gray-100`},[h(`td`,ie,l(t+1),1),h(`td`,ae,l(e.item_code||``),1),h(`td`,oe,l(e.item?.description||`Unknown Item`),1),h(`td`,se,l(f(e.price)),1),h(`td`,ce,l(u(e.discount_percent))+`%`,1),h(`td`,le,l(u(e.quantity)),1),h(`td`,ue,l(u(e.tax_percent)),1),h(`td`,de,l(f(e.total_price)),1)]))),128)),(a(!0),_(p,null,o(s.value,e=>(a(),_(`tr`,{key:`empty-`+e,class:`even:bg-gray-50 print:even:bg-gray-100`},t[11]||=[h(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center print:border-black print:text-xs`},`\xA0`,-1),h(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1),h(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1),h(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center print:border-black print:text-xs`},`\xA0`,-1),h(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center print:border-black print:text-xs`},`\xA0`,-1),h(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center print:border-black print:text-xs`},`\xA0`,-1),h(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center print:border-black print:text-xs`},`\xA0`,-1),h(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center print:border-black print:text-xs`},`\xA0`,-1)]))),128)),h(`tr`,fe,[t[12]||=h(`td`,{colspan:`6`,class:`print:border-black`},null,-1),t[13]||=h(`td`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 font-bold print:border-black print:text-black print:text-xs`},`Sub Total`,-1),h(`td`,pe,l(f(e.saleData.sub_total)),1)]),h(`tr`,null,[t[14]||=h(`td`,{colspan:`2`,class:`print:text-black print:text-xs`},null,-1),h(`td`,me,[c(r).company.stamp?.preview_url&&d()?(a(),_(`img`,{key:0,src:c(r).company.stamp.preview_url,alt:c(r).company.name||`Company Stamp`,class:`h-16 w-auto mr-4 print:h-8 absolute left-24`},null,8,he)):g(``,!0)]),t[15]||=h(`td`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 font-bold print:border-black print:text-black print:text-xs`},`Add. Discount`,-1),h(`td`,ge,l(f(e.saleData.discount_amount)),1)]),h(`tr`,null,[t[16]||=h(`td`,{colspan:`2`,class:`print:text-black print:text-xs`},null,-1),t[17]||=h(`td`,{colspan:`4`,class:`print:border-black`},null,-1),t[18]||=h(`td`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 font-bold print:border-black print:text-black print:text-xs`},`VAT 11%`,-1),h(`td`,_e,l(f(e.saleData.tax_amount)),1)]),h(`tr`,null,[t[19]||=h(`td`,{colspan:`6`,class:`print:border-black`},null,-1),t[20]||=h(`td`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 font-bold print:border-black print:text-black print:text-xs`},`Net Total`,-1),h(`td`,ve,l(f(e.saleData.total_usd)),1)])])])])]),t[22]||=v(`<div class="text-sm text-gray-600 print:text-xs print:text-black mb-4 print:mb-2"> Payment in USD or Market Price. </div><div class="flex justify-between items-center mb-6 print:mb-3 mt-8 print:mt-6"><div class="flex-1 text-center"><p class="font-semibold text-gray-700 print:text-black print:text-xs">Received By</p><div class="border-b border-gray-400 print:border-black mt-8 print:mt-4"></div></div><div class="flex-1 text-center ml-8"><p class="font-semibold text-gray-700 print:text-black print:text-xs">Signature</p><div class="border-b border-gray-400 print:border-black mt-8 print:mt-4"></div></div></div>`,2)]),h(`section`,ye,[h(`div`,be,[d()?(a(),_(`div`,xe,[h(`div`,Se,[c(r).company.address?(a(),_(`p`,Ce,l(c(r).company.address),1)):g(``,!0),c(r).company.phone?(a(),_(`p`,we,l(c(r).company.phone),1)):g(``,!0),c(r).company.email?(a(),_(`p`,Te,l(c(r).company.email),1)):g(``,!0),c(r).company.website?(a(),_(`p`,Ee,l(c(r).company.website),1)):g(``,!0)])])):g(``,!0)])])]))}}),$=De;const Oe={class:`min-h-screen bg-gray-50 print:bg-white`},ke={class:`bg-white shadow-sm border-b print:hidden`},Ae={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8`},je={class:`flex items-center justify-between h-16`},Me={class:`flex items-center space-x-4`},Ne={class:`text-sm text-gray-500`},Pe={class:`flex items-center space-x-3`},Fe={key:0,class:`flex items-center justify-center min-h-screen`},Ie={class:`text-center`},Le={key:1,class:`py-8 print:py-0`},Re={class:`max-w-6xl mx-auto print:max-w-none`};var ze=r({__name:`InvoicePreviewPage`,setup(r){let o=f(),p=d(),m=u(),g=ee(),v=parseInt(p.params.id),x=s(!0),S=s({}),C=s(null),w=()=>{let e=p.query.from===`view`;e?o.push({name:`sales.show`,params:{id:v.toString()}}):o.push({name:`sales.index`})},T=async()=>{if(C.value)try{await C.value.printInvoice()}catch(e){console.error(`Failed to print invoice:`,e),m.error(`Failed to print invoice`)}},E=async()=>{try{S.value=await g.fetchSale(v)}catch(e){console.error(`Error loading sale:`,e),m.error(`Failed to load sale details`),o.push({name:`sales.index`})}};return i(async()=>{try{x.value=!0,await Promise.all([E()])}catch(e){console.error(`Error initializing invoice preview:`,e)}finally{x.value=!1}}),(r,i)=>(a(),_(`div`,Oe,[h(`div`,ke,[h(`div`,Ae,[h(`div`,je,[h(`div`,Me,[h(`button`,{onClick:w,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100 transition-colors`},[n(c(e),{class:`w-5 h-5`})]),h(`div`,null,[i[0]||=h(`h1`,{class:`text-lg font-semibold text-gray-900`},`Invoice Preview`,-1),h(`p`,Ne,l(S.value.prefix)+`-`+l(S.value.code),1)])]),h(`div`,Pe,[h(`button`,{onClick:T,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`},[n(c(b),{class:`w-4 h-4 mr-2`}),i[1]||=y(` Print Invoice `,-1)])])])])]),x.value?(a(),_(`div`,Fe,[h(`div`,Ie,[n(c(t),{class:`w-8 h-8 animate-spin mx-auto text-blue-600`}),i[2]||=h(`p`,{class:`mt-2 text-gray-600`},`Loading invoice...`,-1)])])):(a(),_(`div`,Le,[h(`div`,Re,[n($,{ref_key:`saleInvoiceRef`,ref:C,"sale-data":S.value},null,8,[`sale-data`])])]))]))}}),Be=ze;export{Be as default};
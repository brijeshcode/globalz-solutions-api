import{aA as e,aB as t,aG as n,aH as r,aI as i,aU as a,ax as o,ay as s,az as c,bb as l,bf as u}from"./index-BogmXPcL.js";import{b as d}from"./tableUtils-dXs1kjAL.js";var f=class{baseUrl=`/setups/price-lists`;async getPriceLists(e){try{let t=this.buildQueryParams(e),n=await s(`${this.baseUrl}?${t}`,{loadingMessage:`Loading price lists...`,showLoading:!0});return{data:n.data.data,pagination:n.data.pagination}}catch(e){throw console.error(`Error fetching price lists:`,e),e}}async getPriceList(e){try{let t=await s(`${this.baseUrl}/${e}`,{loadingMessage:`Loading price list...`});return t.data.data}catch(e){throw console.error(`Error fetching price list:`,e),e}}async createPriceList(t){try{let n=await e(this.baseUrl,t,{loadingMessage:`Creating price list...`,showSuccessNotification:!0,successMessage:`Price list created successfully`});return n.data.data}catch(e){throw console.error(`Error creating price list:`,e),e}}async updatePriceList(e,n){try{let r=await t(`${this.baseUrl}/${e}`,n,{loadingMessage:`Updating price list...`,showSuccessNotification:!0,successMessage:`Price list updated successfully`});return r.data.data}catch(e){throw console.error(`Error updating price list:`,e),e}}async deletePriceList(e){try{await o(`${this.baseUrl}/${e}`,{loadingMessage:`Deleting price list...`,showSuccessNotification:!0,successMessage:`Price list deleted successfully`})}catch(e){throw console.error(`Error deleting price list:`,e),e}}async getTrashedPriceLists(e){try{let t=this.buildQueryParams(e),n=await s(`${this.baseUrl}/trashed?${t}`,{loadingMessage:`Loading trashed price lists...`});return{data:n.data.data,pagination:n.data.pagination}}catch(e){throw console.error(`Error fetching trashed price lists:`,e),e}}async restorePriceList(e){try{let t=await c(`${this.baseUrl}/${e}/restore`,{},{loadingMessage:`Restoring price list...`,showSuccessNotification:!0,successMessage:`Price list restored successfully`});return t.data.data}catch(e){throw console.error(`Error restoring price list:`,e),e}}async forceDeletePriceList(e){try{await o(`${this.baseUrl}/${e}/force-delete`,{loadingMessage:`Permanently deleting price list...`,showSuccessNotification:!0,successMessage:`Price list permanently deleted`})}catch(e){throw console.error(`Error permanently deleting price list:`,e),e}}async setDefaultPriceList(e){try{let t=await c(`${this.baseUrl}/${e}/setdefault`,{},{loadingMessage:`Setting default price list...`,showSuccessNotification:!0,successMessage:`Price list set as default successfully`});return t.data.data}catch(e){throw console.error(`Error setting default price list:`,e),e}}async searchPriceLists(e){try{let t=await s(`${this.baseUrl}/search?query=${encodeURIComponent(e)}`,{showLoading:!1});return t.data.data}catch(e){throw console.error(`Error searching price lists:`,e),e}}async getPriceListItems(e){try{let t=await s(`${this.baseUrl}/${e}/items`,{loadingMessage:`Loading price list items...`,showLoading:!0});return t.data.data}catch(e){throw console.error(`Error fetching price list items:`,e),e}}async addPriceListItem(t,n){try{let r=await e(`${this.baseUrl}/${t}/items`,n,{loadingMessage:`Adding item...`,showSuccessNotification:!1});return r.data.data}catch(e){throw console.error(`Error adding price list item:`,e),e}}async updatePriceListItem(e,n,r){try{let i=await t(`${this.baseUrl}/${e}/items/${n}`,r,{loadingMessage:`Updating item...`,showSuccessNotification:!1});return i.data.data}catch(e){throw console.error(`Error updating price list item:`,e),e}}async deletePriceListItem(e){try{await o(`${this.baseUrl}/items/${e}`,{loadingMessage:`Removing item...`,showSuccessNotification:!1})}catch(e){throw console.error(`Error deleting price list item:`,e),e}}buildQueryParams(e){if(!e)return``;let t=new URLSearchParams;return Object.entries(e).forEach(([e,n])=>{n!=null&&n!==``&&t.append(e,String(n))}),t.toString()}};const p=new f,m=i(`priceList`,()=>{let e=r(),t=n(),i=u([]),o=u(null),s=u([]),c=u(d()),f=u(!1),m=u({per_page:50}),h=a(()=>e=>i.value.filter(t=>t.code.toLowerCase().includes(e.toLowerCase()))),g=a(()=>e=>i.value.filter(t=>t.description.toLowerCase().includes(e.toLowerCase()))),_=a(()=>i.value.length),v=a(()=>({total:i.value.length,totalItems:i.value.reduce((e,t)=>e+t.item_count,0)})),y=a(()=>{let e={};return Object.entries(t.query).forEach(([t,n])=>{n&&typeof n==`string`&&(e[t]=n)}),e}),b=async e=>{try{f.value=!0,e&&(m.value={...m.value,...e});let t=await p.getPriceLists(m.value);i.value=t.data,c.value=t.pagination}catch(e){throw console.error(`Error fetching price lists:`,e),e}finally{f.value=!1}},x=async e=>{try{let t=await p.getPriceList(e);return o.value=t,t}catch(e){throw console.error(`Error fetching price list:`,e),e}},S=async e=>{try{let t=await p.createPriceList(e);return i.value.unshift(t),c.value.total+=1,t}catch(e){throw console.error(`Error creating price list:`,e),e}},C=async(e,t)=>{try{let n=await p.updatePriceList(e,t),r=i.value.findIndex(t=>t.id===e);return r!==-1&&(i.value[r]=n),o.value?.id===e&&(o.value=n),n}catch(e){throw console.error(`Error updating price list:`,e),e}},w=async e=>{try{await p.deletePriceList(e);let t=i.value.findIndex(t=>t.id===e);t!==-1&&i.value.splice(t,1),--c.value.total,o.value?.id===e&&(o.value=null)}catch(e){throw console.error(`Error deleting price list:`,e),e}},T=async e=>{try{f.value=!0;let t=e||{},n=await p.getTrashedPriceLists(t);s.value=n.data}catch(e){throw console.error(`Error fetching trashed price lists:`,e),e}finally{f.value=!1}},E=async e=>{try{let t=await p.restorePriceList(e),n=s.value.findIndex(t=>t.id===e);return n!==-1&&s.value.splice(n,1),i.value.unshift(t),c.value.total+=1,t}catch(e){throw console.error(`Error restoring price list:`,e),e}},D=async e=>{try{await p.forceDeletePriceList(e);let t=s.value.findIndex(t=>t.id===e);t!==-1&&s.value.splice(t,1)}catch(e){throw console.error(`Error permanently deleting price list:`,e),e}},O=async e=>{try{let t=await p.setDefaultPriceList(e);i.value.forEach(t=>{t.is_default=t.id===e});let n=i.value.findIndex(t=>t.id===e);return n!==-1&&(i.value[n]=t),o.value?.id===e&&(o.value=t),t}catch(e){throw console.error(`Error setting default price list:`,e),e}},k=async e=>{try{return await p.searchPriceLists(e)}catch(e){throw console.error(`Error searching price lists:`,e),e}},A=async e=>{try{let t=await p.getPriceListItems(e);return o.value&&o.value.id===e&&(o.value.price_list_items=t,o.value.item_count=t.length),t}catch(e){throw console.error(`Error fetching price list items:`,e),e}},j=async(e,t)=>{try{let n=await p.addPriceListItem(e,t);return o.value&&o.value.id===e&&(o.value.price_list_items||(o.value.price_list_items=[]),o.value.price_list_items.push(n),o.value.item_count=(o.value.item_count||0)+1),n}catch(e){throw console.error(`Error adding price list item:`,e),e}},M=async(e,t,n)=>{try{let r=await p.updatePriceListItem(e,t,n);if(o.value&&o.value.price_list_items){let e=o.value.price_list_items.findIndex(e=>e.id===t);e!==-1&&(o.value.price_list_items[e]=r)}return r}catch(e){throw console.error(`Error updating price list item:`,e),e}},N=async e=>{try{if(await p.deletePriceListItem(e),o.value&&o.value.price_list_items){let t=o.value.price_list_items.findIndex(t=>t.id===e);t!==-1&&(o.value.price_list_items.splice(t,1),o.value.item_count=Math.max(0,(o.value.item_count||0)-1))}}catch(e){throw console.error(`Error deleting price list item:`,e),e}},P=e=>{m.value={...m.value,...e}},F=()=>{m.value={per_page:50}},I=()=>{o.value=null},L=e=>{let t={...m.value,search:e,page:1};m.value=t,V(t),W(t,!1)},R=(e,t)=>{let n={...m.value,sort_by:e,sort_direction:t,page:1};m.value=n,V(n),W(n,!1)},z=e=>{let t={...m.value,page:e};m.value=t,V(t),W(t,!1)},B=e=>{let t={...m.value,per_page:e,page:1};m.value=t,V(t),W(t,!1)},V=(n,r=!1)=>{let i={...t.query};Object.entries(n).forEach(([e,t])=>{t!=null&&t!==``?i[e]=String(t):delete i[e]});let a=r?`replace`:`push`;e[a]({query:i})},H=()=>{e.replace({query:{}})},U=()=>{let e={per_page:50};m.value={...e,...y.value}},W=async(e,t=!0)=>{t&&e&&V(e),await b(e)},G=()=>{i.value=[],o.value=null,s.value=[],c.value=d(),m.value={per_page:50},f.value=!1};return l(()=>t.query,async()=>{if(U(),t.name&&t.name.toString().includes(`price-list`))try{await b(m.value)}catch(e){console.error(`Error fetching price lists on URL change:`,e)}},{immediate:!1,deep:!0}),{priceLists:i,currentPriceList:o,trashedPriceLists:s,pagination:c,loading:f,filters:m,priceListsByCode:h,priceListsByDescription:g,totalPriceLists:_,priceListStats:v,urlParams:y,fetchPriceLists:b,fetchPriceList:x,createPriceList:S,updatePriceList:C,deletePriceList:w,fetchTrashedPriceLists:T,restorePriceList:E,forceDeletePriceList:D,setDefaultPriceList:O,searchPriceLists:k,fetchPriceListItems:A,addPriceListItem:j,updatePriceListItem:M,deletePriceListItem:N,updateFilters:P,clearFilters:F,clearCurrentPriceList:I,setSearch:L,setSort:R,setPage:z,setPerPage:B,updateUrlParams:V,clearUrlParams:H,syncFiltersWithUrl:U,fetchData:W,reset:G}});export{m as b};
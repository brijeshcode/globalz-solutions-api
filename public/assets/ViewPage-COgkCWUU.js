import{A as e,_ as t,aA as ee,aC as n,aE as r,aF as te,aO as i,aP as a,aQ as o,aS as s,ab as ne,af as re,ag as ie,aq as ae,at as c,av as l,aw as u,ay as d,az as f,k as oe,m as se,s as ce,w as le}from"./index-DPZISxi2.js";import{b as ue}from"./useAuth-Ck5Vr8KP.js";import"./GlobalConfig-BnwaQAhg.js";import"./tableUtils-BvWofAYZ.js";import{b as de}from"./ConfirmationModal-BtIeWWv_.js";import{b as p}from"./common-BPa_8IsB.js";import{b as fe}from"./salesStore-DW1zYKAw.js";const pe={class:`max-w-8xl mx-auto py-2`},me={class:``},m={class:`mb-8`},h={class:`flex items-center space-x-4 mb-2`},g={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},_={class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},v={class:`flex items-center justify-between`},y={class:`text-lg font-medium text-gray-900 dark:text-white`},b={class:`text-sm text-gray-500 dark:text-gray-400`},x={class:`flex space-x-3`},S={class:`px-6 py-8`},C={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},w={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6`},T={class:`mt-1 text-sm text-gray-900 dark:text-white`},E={class:`mt-1 text-sm text-gray-900 dark:text-white`},D={class:`mt-1 text-sm text-gray-900 dark:text-white`},O={class:`mt-1 text-sm text-gray-900 dark:text-white`},k={class:`mt-1 text-sm text-gray-900 dark:text-white`},A={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-4`},j={class:`mt-1 text-sm text-gray-900 dark:text-white`},M={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},N={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6`},P={class:`mt-1 text-sm text-gray-900 dark:text-white`},F={class:`mt-1 text-sm text-gray-900 dark:text-white`},I={class:`mt-1 text-sm text-gray-900 dark:text-white`},L={key:0},R={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},z={key:0,class:`text-center py-8 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg`},he={key:1,class:`overflow-x-auto`},ge={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},_e={class:`bg-gray-50 dark:bg-gray-700`},ve={key:0,class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},ye={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},be={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},xe={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Se={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ce={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},we={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Te={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ee={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},De={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Oe={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ke={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ae={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},je={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Me={class:`bg-gray-50 dark:bg-gray-700`},Ne={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Pe={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Fe={key:0},Ie={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Le={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Re={key:0,class:`px-6 py-4`},ze={class:`bg-green-50 dark:bg-green-900`},Be={class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},Ve={class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},He={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},Ue={class:`grid grid-cols-1 md:grid-cols-3 gap-6`},We={class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},Ge={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},Ke={class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},qe={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},Je={class:`mt-1 text-lg font-medium`},Ye={key:0,class:`mb-6`},Xe={class:`bg-gray-50 dark:bg-gray-700 rounded-lg p-4`},Ze={class:`text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap`},Qe={class:`pt-6 border-t border-gray-200 dark:border-gray-700`},$e={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},et={class:`mt-1 text-sm text-gray-900 dark:text-white`},tt={class:`mt-1 text-sm text-gray-900 dark:text-white`},nt={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},rt={class:`px-6 py-8 text-center`};var B=ee({__name:`ViewPage`,setup(ee){let B=ie(),V=re(),H=ne(),U=fe(),{isSalesman:W}=ue(),G=parseInt(V.params.id),K=i(!0),q=i({}),J=i(!1),Y=i(!1),it=()=>{B.push({name:`sales.index`})},at=()=>{B.push({name:`sales.edit`,params:{id:G.toString()}})},ot=()=>{B.push({name:`sales.invoice`,params:{id:G.toString()},query:{from:`view`}})},st=()=>{J.value=!0},X=()=>{J.value=!1,Y.value=!1},ct=async()=>{Y.value=!0;try{await U.deleteSale(G),H.success(`Sale deleted successfully`),B.push({name:`sales.index`})}catch{H.error(`Failed to delete sale`)}finally{Y.value=!1}},lt=async()=>{try{K.value=!0,q.value=await U.fetchSale(G)}catch(e){console.error(`Error loading sale:`,e),H.error(`Failed to load sale details`),B.push({name:`sales.index`})}finally{K.value=!1}},Z=e=>{let t=Number(e||0);return t>0?`text-green-600 dark:text-green-400 font-medium`:t<0?`text-red-600 dark:text-red-400 font-medium`:`text-gray-600 dark:text-gray-400`},ut=e=>{let t=Number(e||0);return t>0?`bg-green-50 dark:bg-green-900 text-green-600 dark:text-green-400`:t<0?`bg-red-50 dark:bg-red-900 text-red-600 dark:text-red-400`:`bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-400`},dt=e=>{let t=Number(e||0);return t>0?`text-red-600 dark:text-red-400 font-medium`:`text-gray-900 dark:text-white`},Q=e=>e?parseFloat(Number(e).toFixed(2)).toString():`0`,ft=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleDateString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`})},$=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`})};return n(async()=>{await lt()}),(ee,n)=>(r(),u(`div`,pe,[c(`div`,me,[c(`div`,m,[c(`div`,h,[c(`button`,{onClick:it,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[f(a(t),{class:`w-5 h-5`})]),n[1]||=c(`div`,null,[c(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},` Sale Details `),c(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},` View sale order information `)],-1)])]),K.value?(r(),u(`div`,nt,[c(`div`,rt,[f(a(e),{class:`w-8 h-8 animate-spin mx-auto text-blue-600`}),n[43]||=c(`p`,{class:`mt-2 text-gray-600 dark:text-gray-400`},`Loading sale details...`,-1)])])):(r(),u(`div`,g,[c(`div`,_,[c(`div`,v,[c(`div`,null,[c(`h3`,y,s(q.value.prefix)+`-`+s(q.value.code),1),c(`p`,b,` Sale ID: `+s(q.value.id),1)]),c(`div`,x,[c(`button`,{onClick:ot,class:`inline-flex items-center px-3 py-2 border border-green-300 dark:border-green-600 text-sm font-medium rounded-md text-green-700 dark:text-green-300 bg-white dark:bg-gray-800 hover:bg-green-50 dark:hover:bg-green-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200`},[f(a(ce),{class:`w-4 h-4 mr-2`}),n[2]||=d(` Print Invoice `,-1)]),c(`button`,{onClick:at,class:`inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200`},[f(a(le),{class:`w-4 h-4 mr-2`}),n[3]||=d(` Edit `,-1)]),c(`button`,{onClick:st,class:`inline-flex items-center px-3 py-2 border border-red-300 dark:border-red-600 text-sm font-medium rounded-md text-red-700 dark:text-red-300 bg-white dark:bg-gray-800 hover:bg-red-50 dark:hover:bg-red-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200`},[f(a(oe),{class:`w-4 h-4 mr-2`}),n[4]||=d(` Delete `,-1)])])])]),c(`div`,S,[c(`div`,C,[n[12]||=c(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Basic Information `,-1),c(`div`,w,[c(`div`,null,[n[5]||=c(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Sale Date`,-1),c(`dd`,T,s(ft(q.value.date)),1)]),c(`div`,null,[n[6]||=c(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Customer`,-1),c(`dd`,E,s(q.value.customer.name),1)]),c(`div`,null,[n[7]||=c(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Salesperson`,-1),c(`dd`,D,s(q.value.salesperson.name),1)]),c(`div`,null,[n[8]||=c(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Warehouse`,-1),c(`dd`,O,s(q.value.warehouse.name),1)]),c(`div`,null,[n[9]||=c(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Currency`,-1),c(`dd`,k,s(q.value.currency.code)+` - `+s(q.value.currency.name),1)])]),c(`div`,A,[c(`div`,null,[n[10]||=c(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Currency Rate`,-1),c(`dd`,j,s(Q(q.value.currency_rate)),1)]),c(`div`,null,[n[11]||=c(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Outstanding Balance`,-1),c(`dd`,{class:o([`mt-1 text-sm`,dt(q.value.outStanding_balance)])},s(a(p)(q.value.outStanding_balance)),3)])])]),c(`div`,M,[n[17]||=c(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Financial Summary `,-1),c(`div`,N,[c(`div`,null,[n[13]||=c(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Sub Total`,-1),c(`dd`,P,s(a(p)(q.value.sub_total)),1)]),c(`div`,null,[n[14]||=c(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Sub Total (USD)`,-1),c(`dd`,F,s(a(p)(q.value.sub_total_usd)),1)]),c(`div`,null,[n[15]||=c(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Discount Amount`,-1),c(`dd`,I,s(a(p)(q.value.discount_amount)),1)]),a(W)?l(``,!0):(r(),u(`div`,L,[n[16]||=c(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Total Profit`,-1),c(`dd`,{class:o([`mt-1 text-sm`,Z(q.value.total_profit)])},s(a(p)(q.value.total_profit)),3)]))])]),c(`div`,R,[n[35]||=c(`div`,{class:`flex items-center justify-between mb-4`},[c(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white`},` Sale Items `)],-1),q.value.items&&q.value.items.length===0?(r(),u(`div`,z,[f(a(se),{class:`mx-auto h-12 w-12 text-gray-400`}),n[18]||=c(`h5`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},`No items found`,-1),n[19]||=c(`p`,{class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},`This sale has no items.`,-1)])):(r(),u(`div`,he,[c(`table`,ge,[c(`thead`,_e,[c(`tr`,null,[n[20]||=c(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`#`,-1),n[21]||=c(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Code`,-1),n[22]||=c(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Item`,-1),n[23]||=c(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Unit`,-1),n[24]||=c(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[c(`abbr`,{title:`Total Quantity`},`QTY`)],-1),n[25]||=c(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Sale Price`,-1),n[26]||=c(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Cost Price`,-1),n[27]||=c(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[c(`abbr`,{title:`Discount Percentage`},`Dis. %`)],-1),n[28]||=c(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[c(`abbr`,{title:`Tax Percentage`},`Tax %`)],-1),n[29]||=c(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[c(`abbr`,{title:`Tax-inclusive Price`},`TTC`)],-1),n[30]||=c(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Total`,-1),n[31]||=c(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`USD`,-1),a(W)?l(``,!0):(r(),u(`th`,ve,`Profit`))])]),c(`tbody`,ye,[(r(!0),u(ae,null,te(q.value.items,(e,t)=>(r(),u(`tr`,{key:t,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[c(`td`,be,s(t+1),1),c(`td`,xe,s(e.item_code),1),c(`td`,Se,s(e.item.description),1),c(`td`,Ce,s(e.item.item_unit.name),1),c(`td`,we,s(Q(e.quantity)),1),c(`td`,Te,s(a(p)(e.price)),1),c(`td`,Ee,s(a(p)(e.cost_price)),1),c(`td`,De,s(Q(e.discount_percent))+`%`,1),c(`td`,Oe,s(Q(e.tax_percent))+`%`,1),c(`td`,ke,s(Q(e.ttc_price)),1),c(`td`,Ae,s(a(p)(e.total_price)),1),c(`td`,je,s(a(p)(e.total_price_usd)),1),a(W)?l(``,!0):(r(),u(`td`,{key:0,class:o([`px-6 py-4 whitespace-nowrap text-sm`,Z(e.unit_profit)])},s(a(p)(e.unit_profit)),3))]))),128))]),c(`tfoot`,Me,[c(`tr`,null,[n[32]||=c(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Sub Total:`,-1),c(`td`,Ne,s(a(p)(q.value.sub_total)),1),c(`td`,Pe,s(a(p)(q.value.sub_total_usd)),1),a(W)?l(``,!0):(r(),u(`td`,{key:0,class:o([`px-6 py-4 text-sm font-medium`,Z(q.value.total_profit)])},s(a(p)(q.value.total_profit)),3))]),q.value.discount_amount&&Number(q.value.discount_amount)>0?(r(),u(`tr`,Fe,[n[33]||=c(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Additional Discount:`,-1),c(`td`,Ie,`-`+s(a(p)(q.value.discount_amount)),1),c(`td`,Le,`-`+s(a(p)(q.value.discount_amount_usd)),1),a(W)?l(``,!0):(r(),u(`td`,Re))])):l(``,!0),c(`tr`,ze,[n[34]||=c(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-bold text-gray-900 dark:text-white`},`Final Total:`,-1),c(`td`,Be,s(a(p)(q.value.total)),1),c(`td`,Ve,s(a(p)(q.value.total_usd)),1),a(W)?l(``,!0):(r(),u(`td`,{key:0,class:o([`px-6 py-4 text-sm font-bold`,Z(q.value.total_profit)])},s(a(p)(q.value.total_profit)),3))])])])]))]),c(`div`,He,[n[39]||=c(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Final Totals `,-1),c(`div`,Ue,[c(`div`,We,[n[36]||=c(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount`,-1),c(`dd`,Ge,s(a(p)(q.value.total)),1)]),c(`div`,Ke,[n[37]||=c(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount (USD)`,-1),c(`dd`,qe,s(a(p)(q.value.total_usd)),1)]),a(W)?l(``,!0):(r(),u(`div`,{key:0,class:o([`rounded-lg p-4`,ut(q.value.total_profit)])},[n[38]||=c(`dt`,{class:`text-sm font-medium`},`Total Profit (USD)`,-1),c(`dd`,Je,s(a(p)(q.value.total_profit)),1)],2))])]),q.value.note?(r(),u(`div`,Ye,[n[40]||=c(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Notes `,-1),c(`div`,Xe,[c(`p`,Ze,s(q.value.note),1)])])):l(``,!0),c(`div`,Qe,[c(`div`,$e,[c(`div`,null,[n[41]||=c(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Created At`,-1),c(`dd`,et,s($(q.value.created_at)),1)]),c(`div`,null,[n[42]||=c(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Last Updated`,-1),c(`dd`,tt,s($(q.value.updated_at)),1)])])])])]))]),f(de,{show:J.value,"onUpdate:show":n[0]||=e=>J.value=e,type:`delete`,title:`Delete Sale ${q.value.prefix}-${q.value.code}`,message:`Are you sure you want to delete sale '${q.value.prefix}-${q.value.code}'? This action can be undone by restoring from trash.`,"confirm-text":`Delete Sale`,"loading-text":`Deleting...`,loading:Y.value,onConfirm:ct,onCancel:X},null,8,[`show`,`title`,`message`,`loading`])]))}}),V=B;export{V as default};
import{D as e,M as t,aB as n,aC as r,aE as ee,aF as i,aG as te,aK as a,aL as o,aR as ne,aS as s,aU as c,aV as l,aW as re,aY as u,ag as ie,al as ae,as as d,aw as f,ay as oe,az as p,e as se,f as ce,o as m,u as le}from"./index-D1LXHm0l.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-jdfVzp2e.js";import{b as ue}from"./PageHeader-CcoX01Fu.js";import{b as h,c as de}from"./common-DPsEy-Xi.js";import{b as fe}from"./customersStore-Boasmqb_.js";const pe={class:`space-y-6`},me=[`disabled`],he={class:`bg-white dark:bg-gray-800 shadow rounded-lg p-4`},ge={class:`grid grid-cols-1 md:grid-cols-3 gap-4`},_e={class:`md:col-span-2`},g={class:`relative`},_={key:0,class:`absolute z-10 mt-1 w-full md:w-2/3 bg-white dark:bg-gray-700 shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm`},v=[`onClick`],y={class:`flex items-center`},b={class:`font-medium block truncate text-gray-900 dark:text-white`},x={class:`text-gray-500 dark:text-gray-400 ml-2 text-xs block truncate`},S={key:0,class:`flex items-end`},C={class:`w-full p-3 bg-blue-50 dark:bg-blue-900 rounded-md`},w={class:`flex justify-between items-start`},T={class:`text-sm font-medium text-blue-900 dark:text-blue-100`},E={class:`text-xs text-blue-700 dark:text-blue-300`},D={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg p-4`},O={class:`grid grid-cols-1 md:grid-cols-6 gap-4`},k={class:`md:col-span-2`},A={class:`relative`},j={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden`},M={key:0,class:`p-8 text-center`},N={key:1,class:`p-8 text-center`},P={class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},F={key:2,class:`overflow-x-auto`},I={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},ve={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},ye={class:`px-4 py-1 whitespace-nowrap`},be={class:`text-sm text-gray-900 dark:text-white`},xe={class:`px-4 py-1 whitespace-nowrap`},Se={class:`px-4 py-1 whitespace-nowrap`},Ce={class:`text-sm text-gray-900 dark:text-white`},we={class:`px-4 py-1 whitespace-nowrap`},Te={class:`text-sm text-gray-900 dark:text-white`},Ee={class:`px-4 py-1 whitespace-nowrap text-right`},De={class:`text-sm font-medium text-red-600 dark:text-red-400`},Oe={class:`px-4 py-1 whitespace-nowrap text-right`},ke={class:`text-sm font-medium text-green-600 dark:text-green-400`},Ae={class:`px-4 py-1 whitespace-nowrap text-right`},je={class:`font-bold`},Me={class:`px-4 py-1 whitespace-nowrap text-right`},Ne={class:`px-4 py-1 whitespace-nowrap text-right`},Pe={class:`px-4 py-1 whitespace-nowrap text-right`},Fe={key:2,class:`bg-white dark:bg-gray-800 shadow rounded-lg p-12 text-center`};var L=te({__name:`IndexPage`,setup(te){let L=ae(),R=ie(),z=fe(),B=c(!1),V=c([]),H=c({}),U=c(null),W=c(null),G=c(``),K=c([]),q=c(null),J=c({search:``,from_date:``,to_date:``,transaction_type:``,withPage:!1}),Y=oe(()=>q.value?.id),Ie=()=>{W.value&&clearTimeout(W.value),W.value=setTimeout(async()=>{G.value.length>=2?await Le():K.value=[]},300)},Le=async()=>{try{await z.fetchCustomers({search:G.value,per_page:10}),K.value=z.customers}catch(e){console.error(`Error searching customers:`,e),R.error(`Failed to search customers`)}},Re=e=>{q.value=e,G.value=`${e.code} - ${e.name}`,K.value=[],X()},ze=()=>{q.value=null,G.value=``,V.value=[],H.value={},$()},X=async()=>{if(Y.value)try{B.value=!0;let e=await z.fetchCustomerStatements(Y.value,J.value);V.value=e.data,H.value=e.stats}catch(e){R.error(`Failed to load customer statements`,{title:`Error`}),console.error(`Error fetching statements:`,e)}finally{B.value=!1}},Z=()=>{U.value&&clearTimeout(U.value),U.value=setTimeout(()=>{X()},300)},Q=()=>{X()},$=()=>{J.value={search:``,from_date:``,to_date:``,transaction_type:``,withPage:!1},q.value&&X()},Be=e=>{let t={sales:`Sales`,payments:`Payment`,credit_note:`Credit Note`,debit_note:`Debit Note`,returns:`Return`};return t[e]||e},Ve=()=>{Y.value&&L.push({name:`customers.statement.preview`,params:{id:Y.value},query:{from_date:J.value.from_date,to_date:J.value.to_date,search:J.value.search,transaction_type:J.value.transaction_type}})};return(te,c)=>(a(),r(`div`,pe,[i(ue,{title:`Customer Statements`,description:`Search and view customer transaction history including sales, payments, and notes`,showCreateButton:!1},{actions:ne(()=>[q.value?(a(),r(`button`,{key:0,onClick:Ve,disabled:V.value.length===0,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},[i(l(le),{class:`w-4 h-4 mr-2`}),c[4]||=ee(` Print Preview `,-1)],8,me)):n(``,!0)]),_:1}),p(`div`,he,[p(`div`,ge,[p(`div`,_e,[c[5]||=p(`label`,{for:`customer-search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Search Customer (by name or code) `,-1),p(`div`,g,[s(p(`input`,{id:`customer-search`,"onUpdate:modelValue":c[0]||=e=>G.value=e,type:`text`,placeholder:`Enter customer name or code...`,class:`block w-full px-3 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 sm:text-sm transition-colors duration-200`,onInput:Ie},null,544),[[d,G.value]]),i(l(m),{class:`absolute left-3 top-2.5 h-5 w-5 text-gray-400`})]),K.value.length>0&&G.value?(a(),r(`div`,_,[(a(!0),r(f,null,o(K.value,e=>(a(),r(`div`,{key:e.id,onClick:t=>Re(e),class:`cursor-pointer select-none relative py-2 pl-3 pr-9 hover:bg-gray-100 dark:hover:bg-gray-600`},[p(`div`,y,[p(`span`,b,u(e.code)+` - `+u(e.name),1)]),p(`span`,x,u(e.city),1)],8,v))),128))])):n(``,!0)]),q.value?(a(),r(`div`,S,[p(`div`,C,[p(`div`,w,[p(`div`,null,[p(`p`,T,u(q.value.code)+` - `+u(q.value.name),1),p(`p`,E,u(q.value.city),1)]),p(`button`,{onClick:ze,class:`text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200`},[i(l(se),{class:`h-4 w-4`})])])])])):n(``,!0)])]),q.value?(a(),r(`div`,D,[p(`div`,O,[p(`div`,k,[c[6]||=p(`label`,{for:`search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Search Note `,-1),p(`div`,A,[s(p(`input`,{id:`search`,"onUpdate:modelValue":c[1]||=e=>J.value.search=e,type:`text`,placeholder:`Search note...`,class:`block w-full px-3 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 sm:text-sm transition-colors duration-200`,onInput:Z},null,544),[[d,J.value.search]]),i(l(m),{class:`absolute left-3 top-2.5 h-5 w-5 text-gray-400`})])]),p(`div`,null,[c[7]||=p(`label`,{for:`from_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` From Date `,-1),s(p(`input`,{id:`from_date`,"onUpdate:modelValue":c[2]||=e=>J.value.from_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:Q},null,544),[[d,J.value.from_date]])]),p(`div`,null,[c[8]||=p(`label`,{for:`to_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` To Date `,-1),s(p(`input`,{id:`to_date`,"onUpdate:modelValue":c[3]||=e=>J.value.to_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:Q},null,544),[[d,J.value.to_date]])]),p(`div`,{class:`flex items-end`},[p(`button`,{onClick:$,class:`w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200`},` Clear `)])])])):n(``,!0),q.value?(a(),r(`div`,j,[B.value?(a(),r(`div`,M,[i(l(e),{class:`h-8 w-8 animate-spin mx-auto text-blue-600 dark:text-blue-400`}),c[9]||=p(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},`Loading statements...`,-1)])):V.value.length===0?(a(),r(`div`,N,[i(l(t),{class:`h-12 w-12 mx-auto text-gray-400`}),c[10]||=p(`h3`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},` No statements found `,-1),p(`p`,P,u(J.value.search||J.value.transaction_type?`Try adjusting your search criteria.`:`No transactions available for this customer.`),1)])):(a(),r(`div`,F,[p(`table`,I,[c[15]||=p(`thead`,{class:`bg-gray-50 dark:bg-gray-700`},[p(`tr`,null,[p(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Date `),p(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Type `),p(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Transaction ID `),p(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Note `),p(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Debit `),p(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Credit `),p(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Balance `)])],-1),p(`tbody`,ve,[c[13]||=p(`tr`,null,[p(`td`,{class:`px-4 py-1 whitespace-nowrap`,colspan:`3`}),p(`td`,{class:`px-4 py-1 whitespace-nowrap`},`Opening Balance`),p(`td`,{class:`px-4 py-1 whitespace-nowrap text-right`},`0`),p(`td`,{class:`px-4 py-1 whitespace-nowrap text-right`},`0`),p(`td`,{class:`px-4 py-1 whitespace-nowrap text-right`},`0`)],-1),(a(!0),r(f,null,o(V.value,e=>(a(),r(`tr`,{key:e.id,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[p(`td`,ye,[p(`div`,be,u(l(de)(e.date)),1)]),p(`td`,xe,u(Be(e.type)),1),p(`td`,Se,[p(`div`,Ce,u(e.code||`-`),1)]),p(`td`,we,[p(`div`,Te,u(e.note||`-`),1)]),p(`td`,Ee,[p(`div`,De,u(e.debit?l(h)(e.debit,`usd`):`-`),1)]),p(`td`,Oe,[p(`div`,ke,u(e.credit?l(h)(e.credit,`usd`):`-`),1)]),p(`td`,Ae,[p(`div`,{class:re([`text-sm font-medium`,e.balance>=0?`text-green-600 dark:text-green-400`:`text-red-600 dark:text-red-400`])},u(l(h)(e.balance,`usd`)),3)])]))),128)),c[14]||=p(`tr`,null,[p(`td`,{class:`px-4 py-2`,colspan:`7`},`\xA0`)],-1),p(`tr`,je,[c[11]||=p(`td`,{class:`px-4 py-1 whitespace-nowrap`,colspan:`3`},null,-1),c[12]||=p(`td`,{class:`px-4 py-1 whitespace-nowrap`},`Total`,-1),p(`td`,Me,u(H.value.total_debit),1),p(`td`,Ne,u(H.value.total_credit),1),p(`td`,Pe,u(H.value.balance),1)])])])]))])):(a(),r(`div`,Fe,[i(l(ce),{class:`h-16 w-16 mx-auto text-gray-400 mb-4`}),c[16]||=p(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-2`},` Select a Customer `,-1),c[17]||=p(`p`,{class:`text-sm text-gray-500 dark:text-gray-400`},` Search and select a customer to view their statement `,-1)]))]))}}),R=L;export{R as default};
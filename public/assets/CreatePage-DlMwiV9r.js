import{H as e,O as t,aE as n,aK as r,aL as i,aO as a,aP as o,aR as s,aS as c,aT as l,aU as u,aV as d,aX as f,aY as p,aZ as ee,al as te,az as ne,b0 as re,b2 as m,b3 as h,b8 as g,ba as _,bb as ie,bc as v,bd as y,be as ae,bg as b,d as oe,s as se,z as ce}from"./index-CPSuq9q8.js";import{b as le}from"./useAuth-CJIoxv3u.js";import"./GlobalConfig-wPgXFcZ5.js";import{c as x}from"./common-CZbH6H1Z.js";import"./tableUtils-dXs1kjAL.js";import{d as S}from"./currencyUtil-CW5chEzz.js";import{b as ue}from"./CurrencyRateInput-CoHKJvYl.js";import{b as de}from"./customerReturnOrdersStore-BE3l0mS0.js";const fe={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8`},pe={class:``},me={class:`mb-8`},he={class:`flex items-center space-x-4 mb-2`},ge={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},_e={class:`px-6 py-8`},ve={class:`border-b border-gray-200 dark:border-gray-700 pb-6`},ye={class:`grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6`},be={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},xe=[`disabled`],Se={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Ce={for:`customer_id`,class:`text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex gap-2`},we=[`disabled`],Te=[`value`],Ee={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},De={key:0},Oe=[`disabled`],ke=[`value`],Ae={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},je=[`disabled`],Me=[`value`],Ne={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Pe=[`disabled`],Fe=[`value`],Ie={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Le={class:`border-b border-gray-200 dark:border-gray-700 pb-6`},Re={id:`item-add-form`,class:`mb-6`},ze={class:`mb-4 w-1/2`},Be={for:`item-select`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},Ve=[`disabled`],He={value:null},Ue=[`value`],We={key:0,class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},Ge={key:0,class:`mb-4`},Ke={class:`bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md p-3`},qe={class:`text-sm text-blue-800 dark:text-blue-200`},Je={class:`ml-2`},Ye={class:`ml-3`},Xe={key:0,class:`text-sm text-amber-700 dark:text-amber-400 mt-1`},Ze={class:`font-medium`},Qe={key:1,class:`mb-4`},$e={class:`overflow-x-auto border border-gray-300 dark:border-gray-600 rounded-md`},et={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},tt={class:`bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600`},nt=[`onClick`],rt={class:`px-3 py-2 whitespace-nowrap text-sm`},it=[`value`,`checked`],at={class:`px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100`},ot={class:`px-3 py-2 whitespace-nowrap text-sm`},st=[`onClick`],ct={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},lt={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},ut={class:`px-3 py-2 whitespace-nowrap text-sm text-right font-medium text-green-600 dark:text-green-400`},dt={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},ft={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},pt={key:2,class:`grid grid-cols-1 md:grid-cols-3 gap-4 mb-4`},mt=[`max`],ht={class:`mt-1 text-xs text-gray-500 dark:text-gray-400`},gt={class:`md:col-span-2`},_t={key:3},vt={key:0,id:`item-list`,class:`mt-6`},yt={class:`overflow-x-auto border border-gray-300 dark:border-gray-600 rounded-md`},bt={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},xt={class:`bg-gray-50 dark:bg-gray-800`},St={key:0,class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},Ct={key:1,class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},wt={class:`bg-white dark:bg-gray-700 divide-y divide-gray-200 dark:divide-gray-600`},Tt={class:`px-3 py-2 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100`},Et={class:`px-3 py-2 text-sm text-gray-900 dark:text-gray-100`},Dt={class:`text-xs text-gray-500 dark:text-gray-400`},Ot={key:0,class:`text-xs text-gray-500 dark:text-gray-400 italic`},kt={class:`px-3 py-2 text-sm text-gray-900 dark:text-gray-100`},C=[`onClick`],At={class:`text-xs text-gray-500 dark:text-gray-400`},jt={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},Mt={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},Nt={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},Pt={key:0,class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},Ft={key:1,class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},It={class:`px-3 py-2 whitespace-nowrap text-sm text-right text-gray-900 dark:text-gray-100`},Lt={class:`px-3 py-2 whitespace-nowrap text-sm text-center`},Rt=[`onClick`],zt={class:`bg-gray-50 dark:bg-gray-800`},Bt={class:`px-3 py-2 whitespace-nowrap text-sm text-right font-bold text-gray-900 dark:text-gray-100`},Vt={class:`border-b border-gray-200 dark:border-gray-700 pb-6`},Ht={class:`grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6`},Ut={class:`pb-6`},Wt={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Gt={class:`flex items-center justify-end space-x-4 pt-6 border-t border-gray-200 dark:border-gray-700`},Kt=[`disabled`],qt=[`disabled`];var w=ee({__name:`CreatePage`,setup(ee){let w=n(),T=ne(),E=de(),D=oe(),{isAdmin:Jt,isSalesman:O,user:Yt}=le(),k=v(!1),A=v(!1),j=v(!1),M=v({}),N=v(null),P=v([]),F=v({selectedItemId:null,selectedSaleItemId:null,quantity:1,note:``}),I=v(!1),L=ie({date:new Date().toISOString().split(`T`)[0],prefix:`RTN`,customer_id:null,salesperson_id:O?Yt.value?.id:null,currency_id:null,warehouse_id:null,currency_rate:1,total:0,total_usd:0,total_volume_cbm:0,total_weight_kg:0,note:``,items:[]}),R=s(()=>D.customers),Xt=s(()=>D.salesEmployees),z=s(()=>D.currencies),B=s(()=>D.warehouses),V=s(()=>F.value.selectedItemId?P.value.find(e=>e.item_id===F.value.selectedItemId):null),H=s(()=>{let e=V.value?.sales||[];return e.filter(e=>e.can_return&&e.available_quantity>0)}),U=s(()=>H.value.filter(e=>e.sale_prefix===`INV`).length),W=s(()=>H.value.filter(e=>e.sale_prefix===`INX`).length),G=s(()=>H.value.filter(e=>!(L.prefix===`RTX`&&e.sale_prefix!==`INX`||L.prefix===`RTN`&&e.sale_prefix!==`INV`))),K=s(()=>F.value.selectedSaleItemId?G.value.find(e=>e.sale_item_id===F.value.selectedSaleItemId):null),Zt=s(()=>S(N.value?.code)),q=s(()=>L.prefix===`RTX`),J=s(()=>!!(L.date&&L.prefix&&L.customer_id&&L.currency_id&&L.warehouse_id&&L.total>=0&&L.total_usd>=0&&L.items.length>0&&L.items.every(e=>e.sale_item_id&&e.quantity>0))),Qt=async()=>{if(!L.customer_id){P.value=[];return}try{j.value=!0;let e=await E.fetchSaleItemsForReturn({customer_id:L.customer_id});P.value=e?.items||[]}catch(e){console.error(`Error fetching sale items:`,e),T.error(`Failed to load sale items for return`),P.value=[]}finally{j.value=!1}},$t=()=>{F.value.selectedItemId?(I.value=!0,F.value.selectedSaleItemId=null,F.value.quantity=1):I.value=!1},en=e=>{F.value.selectedSaleItemId=e,F.value.quantity=1},tn=()=>{if(!K.value){T.error(`Please select a sale transaction`);return}if(F.value.quantity<=0){T.error(`Quantity must be greater than 0`);return}if(F.value.quantity>K.value.available_quantity){T.error(`Quantity cannot exceed available quantity (${K.value.available_quantity})`);return}let e=L.items.filter(e=>e.sale_item_id===F.value.selectedSaleItemId).reduce((e,t)=>e+t.quantity,0);if(e+F.value.quantity>K.value.available_quantity){T.error(`Total quantity for this sale item cannot exceed ${K.value.available_quantity}. Already added: ${e}`);return}let t={sale_item_id:F.value.selectedSaleItemId,item_id:V.value.item_id,item_code:V.value.item_code,quantity:F.value.quantity,price:K.value.price,price_usd:K.value.price_usd,discount_percent:K.value.discount_percent,tax_percent:q.value?0:K.value.tax_percent,tax_label:q.value?null:K.value.tax_label,ttc_price:K.value.ttc_price,ttc_price_usd:K.value.ttc_price_usd,unit_discount_amount:K.value.unit_discount_amount,unit_discount_amount_usd:K.value.unit_discount_amount_usd,total_price:K.value.ttc_price*F.value.quantity,total_price_usd:K.value.ttc_price_usd*F.value.quantity,note:F.value.note||null,sale_code:K.value.sale_code,sale_id:K.value.sale_id,sale_prefix:K.value.sale_prefix,sale_date:x(K.value.sale_date),item_name:V.value.item?.description||V.value.item?.code,item_unit:V.value.item?.itemUnit?.name||``};L.items.length===1&&!L.items[0].sale_item_id&&(L.items=[]),L.items.push(t),F.value={selectedItemId:null,selectedSaleItemId:null,quantity:1,note:``},I.value=!1,X(),T.success(`Item added successfully`)},nn=e=>{L.items.splice(e,1),X()},Y=e=>e?parseFloat(Number(e).toFixed(2)).toString():`0`,X=()=>{let e=L.items.reduce((e,t)=>e+(t.total_price||0),0),t=L.items.reduce((e,t)=>e+(t.total_price_usd||0),0);L.total=e,L.total_usd=t;let n=L.items.reduce((e,t)=>e+(t.total_volume_cbm||0),0),r=L.items.reduce((e,t)=>e+(t.total_weight_kg||0),0);L.total_volume_cbm=n,L.total_weight_kg=r},Z=()=>{N.value=z.value.find(e=>e.id==L.currency_id),N.value&&(L.currency_rate=N.value.active_rate?.rate*1||1)},rn=async()=>{let e=R.value.find(e=>e.id===L.customer_id);e&&e.salesperson_id&&(L.salesperson_id=e.salesperson_id),L.items=[],F.value={selectedItemId:null,selectedSaleItemId:null,quantity:1,note:``},I.value=!1,await Qt(),X()},an=async()=>{if(J.value){k.value=!0,M.value={};try{let e={date:L.date,prefix:L.prefix,customer_id:L.customer_id,salesperson_id:L.salesperson_id,currency_id:L.currency_id,warehouse_id:L.warehouse_id,currency_rate:L.currency_rate,total:L.total,total_usd:L.total_usd,total_volume_cbm:L.total_volume_cbm,total_weight_kg:L.total_weight_kg,note:L.note,items:L.items.map(e=>({sale_item_id:e.sale_item_id,quantity:e.quantity,note:e.note}))},t=await E.createReturnOrder(e);T.success(`Return order created successfully`),w.push({name:`customer.return-orders.show`,params:{id:t.id.toString()}})}catch(e){e.errors&&(M.value=e.errors),console.log(M.value),T.error(`Failed to create return order`)}finally{k.value=!1}}},Q=()=>{w.push({name:`customer.return-orders.index`})},$=e=>{let t=w.resolve({name:`sales.show`,params:{id:e.toString()}});window.open(t.href,`_blank`)};return re(async()=>{A.value=!0;try{let e=[];if(D.customers.length===0&&e.push(D.fetchCustomers()),D.salesEmployees.length===0&&e.push(D.fetchSalesEmployees()),D.currencies.length===0&&e.push(D.fetchCurrencies()),D.warehouses.length===0&&e.push(D.fetchWarehouses()),await Promise.all(e),D.currencies?.length&&!L.currency_id){let e=D.currencies.find(e=>S(e.code));e&&(L.currency_id=e.id,Z())}z.value.length===1&&(L.currency_id=z.value[0].id),B.value.length===1&&(L.warehouse_id=B.value[0].id)}catch{T.error(`Failed to load form data`)}finally{A.value=!1}}),g(()=>L.currency_id,()=>{Z()}),g(()=>L.prefix,()=>{F.value.selectedItemId=null,F.value.selectedSaleItemId=null,F.value.quantity=1,F.value.note=``,I.value=!1,L.items.splice(0,L.items.length),X()}),(n,s)=>(m(),d(`div`,fe,[c(`div`,pe,[c(`div`,me,[c(`div`,he,[c(`button`,{onClick:Q,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[p(y(te),{class:`w-5 h-5`})]),s[13]||=c(`div`,null,[c(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},` Create Return Order `),c(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},` Create a new customer return order request `)],-1)])]),c(`div`,ge,[c(`div`,_e,[c(`form`,{onSubmit:a(an,[`prevent`]),class:`space-y-6`},[c(`div`,ve,[s[26]||=c(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Return Information `,-1),c(`div`,ye,[c(`div`,null,[s[15]||=c(`label`,{for:`prefix`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[f(` Prefix `),c(`span`,{class:`text-red-500 ml-1`},`*`)],-1),_(c(`select`,{id:`prefix`,"onUpdate:modelValue":s[0]||=e=>L.prefix=e,required:``,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},s[14]||=[c(`option`,{value:`RTN`},`RTN`,-1),c(`option`,{value:`RTX`},`RTX`,-1)],512),[[r,L.prefix]]),M.value.prefix?(m(),d(`p`,be,b(M.value.prefix),1)):u(``,!0)]),c(`div`,null,[s[16]||=c(`label`,{for:`date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[f(` Return Date `),c(`span`,{class:`text-red-500 ml-1`},`*`)],-1),_(c(`input`,{id:`date`,"onUpdate:modelValue":s[1]||=e=>L.date=e,type:`date`,disabled:k.value,required:``,class:`block w-full rounded-md border-0 py-2 px-3 text-gray-900 dark:text-gray-100 shadow-sm ring-1 ring-inset ring-gray-300 dark:ring-gray-600 placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6 transition-colors duration-200 bg-white dark:bg-gray-700`},null,8,xe),[[i,L.date]]),M.value.date?(m(),d(`p`,Se,b(M.value.date),1)):u(``,!0)]),c(`div`,null,[c(`label`,Ce,[s[17]||=f(` Customer `,-1),s[18]||=c(`span`,{class:`text-red-500 ml-1`},`*`,-1),c(`span`,null,[k.value||A.value?(m(),l(y(t),{key:0,class:`h-4 w-4 animate-spin mr-2`})):u(``,!0)])]),_(c(`select`,{id:`customer_id`,"onUpdate:modelValue":s[2]||=e=>L.customer_id=e,required:``,onChange:rn,disabled:k.value||A.value,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},[s[19]||=c(`option`,{value:``},`Select Customer`,-1),(m(!0),d(o,null,h(R.value,e=>(m(),d(`option`,{key:e.id,value:e.id},b(e.name),9,Te))),128))],40,we),[[r,L.customer_id]]),M.value.customer_id?(m(),d(`p`,Ee,b(M.value.customer_id),1)):u(``,!0)]),y(O)?u(``,!0):(m(),d(`div`,De,[s[21]||=c(`label`,{for:`salesperson_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Salesperson `,-1),_(c(`select`,{id:`salesperson_id`,"onUpdate:modelValue":s[3]||=e=>L.salesperson_id=e,disabled:k.value||A.value||y(O),class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},[s[20]||=c(`option`,{value:``},`Select Salesperson`,-1),(m(!0),d(o,null,h(Xt.value,e=>(m(),d(`option`,{key:e.id,value:e.id},b(e.name),9,ke))),128))],8,Oe),[[r,L.salesperson_id]]),M.value.salesperson_id?(m(),d(`p`,Ae,b(M.value.salesperson_id),1)):u(``,!0)])),c(`div`,null,[s[23]||=c(`label`,{for:`currency_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[f(` Currency `),c(`span`,{class:`text-red-500 ml-1`},`*`)],-1),_(c(`select`,{id:`currency_id`,"onUpdate:modelValue":s[4]||=e=>L.currency_id=e,required:``,disabled:k.value||A.value,onChange:Z,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},[s[22]||=c(`option`,{value:``},`Select Currency`,-1),(m(!0),d(o,null,h(z.value,e=>(m(),d(`option`,{key:e.id,value:e.id},b(e.name)+` (`+b(e.code)+`) `,9,Me))),128))],40,je),[[r,L.currency_id]]),M.value.currency_id?(m(),d(`p`,Ne,b(M.value.currency_id),1)):u(``,!0)]),N.value&&!Zt.value?(m(),l(ue,{key:1,modelValue:L.currency_rate,"onUpdate:modelValue":s[5]||=e=>L.currency_rate=e,modelModifiers:{number:!0},error:M.value.currency_rate,disabled:k.value,loading:k.value,loadingDropdowns:A.value},null,8,[`modelValue`,`error`,`disabled`,`loading`,`loadingDropdowns`])):u(``,!0),c(`div`,null,[s[25]||=c(`label`,{for:`warehouse_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[f(` Warehouse `),c(`span`,{class:`text-red-500 ml-1`},`*`)],-1),_(c(`select`,{id:`warehouse_id`,"onUpdate:modelValue":s[6]||=e=>L.warehouse_id=e,required:``,disabled:k.value||A.value,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},[s[24]||=c(`option`,{value:``},`Select Warehouse`,-1),(m(!0),d(o,null,h(B.value,e=>(m(),d(`option`,{key:e.id,value:e.id},b(e.name),9,Fe))),128))],8,Pe),[[r,L.warehouse_id]]),M.value.warehouse_id?(m(),d(`p`,Ie,b(M.value.warehouse_id),1)):u(``,!0)])])]),c(`div`,Le,[s[45]||=c(`div`,{class:`flex justify-between items-center mb-4`},[c(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},` Return Items `)],-1),c(`div`,Re,[c(`div`,ze,[c(`label`,Be,[s[27]||=f(` Select Item `,-1),c(`span`,null,[j.value?(m(),l(y(t),{key:0,class:`h-4 w-4 animate-spin inline ml-2`})):u(``,!0)])]),_(c(`select`,{id:`item-select`,"onUpdate:modelValue":s[7]||=e=>F.value.selectedItemId=e,onChange:$t,disabled:!L.customer_id||j.value||P.value.length===0,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},[c(`option`,He,b(L.customer_id?`Select an item`:`Select customer first`),1),(m(!0),d(o,null,h(P.value,e=>(m(),d(`option`,{key:e.item_id,value:e.item_id},b(e.item_code)+` - `+b(e.item?.description||e.item?.short_name)+` (Available: `+b(e.total_available)+`) `,9,Ue))),128))],40,Ve),[[r,F.value.selectedItemId]]),L.customer_id&&P.value.length===0&&!j.value?(m(),d(`p`,We,` No items available for return from this customer `)):u(``,!0)]),I.value&&V.value?(m(),d(`div`,Ge,[c(`div`,Ke,[c(`p`,qe,[s[28]||=c(`span`,{class:`font-medium`},`Available sales for this item:`,-1),c(`span`,Je,`INV: `+b(U.value),1),c(`span`,Ye,`INX: `+b(W.value),1)]),G.value.length===0?(m(),d(`p`,Xe,[c(`span`,Ze,`âš  No `+b(L.prefix===`RTN`?`INV`:`INX`)+` sales found for the selected prefix (`+b(L.prefix)+`).`,1),f(` `+b(L.prefix===`RTN`&&W.value>0?` Try switching to RTX prefix to return INX sales.`:``)+` `+b(L.prefix===`RTX`&&U.value>0?` Try switching to RTN prefix to return INV sales.`:``),1)])):u(``,!0)])])):u(``,!0),I.value&&G.value.length>0?(m(),d(`div`,Qe,[s[30]||=c(`h4`,{class:`text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},`Select Sale Transaction`,-1),c(`div`,$e,[c(`table`,et,[s[29]||=c(`thead`,{class:`bg-gray-50 dark:bg-gray-800`},[c(`tr`,null,[c(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Select`),c(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Date`),c(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Inv Code`),c(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Original Qty`),c(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Returned`),c(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Available`),c(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Price`),c(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Disc. %`)])],-1),c(`tbody`,tt,[(m(!0),d(o,null,h(G.value,e=>(m(),d(`tr`,{key:e.sale_item_id,onClick:t=>en(e.sale_item_id),class:ae({"cursor-pointer hover:bg-blue-50 dark:hover:bg-gray-600":!0,"bg-blue-100 dark:bg-blue-900":F.value.selectedSaleItemId===e.sale_item_id})},[c(`td`,rt,[c(`input`,{type:`radio`,value:e.sale_item_id,checked:F.value.selectedSaleItemId===e.sale_item_id,class:`h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300`},null,8,it)]),c(`td`,at,b(y(x)(e.sale_date)),1),c(`td`,ot,[c(`a`,{onClick:a(t=>$(e.sale_id),[`stop`]),class:`text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 cursor-pointer underline`,title:`View sale details (opens in new tab)`},b(e.sale_prefix)+b(e.sale_code),9,st)]),c(`td`,ct,b(e.quantity),1),c(`td`,lt,b(e.returned_quantity),1),c(`td`,ut,b(e.available_quantity),1),c(`td`,dt,b(Y(e.price)),1),c(`td`,ft,b(e.discount_percent)+`%`,1)],10,nt))),128))])])])])):u(``,!0),F.value.selectedSaleItemId?(m(),d(`div`,pt,[c(`div`,null,[s[31]||=c(`label`,{for:`return-quantity`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[f(` Return Quantity `),c(`span`,{class:`text-red-500 ml-1`},`*`)],-1),_(c(`input`,{id:`return-quantity`,"onUpdate:modelValue":s[8]||=e=>F.value.quantity=e,type:`number`,min:`1`,max:K.value?.available_quantity,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm`},null,8,mt),[[i,F.value.quantity,void 0,{number:!0}]]),c(`p`,ht,`Max: `+b(K.value?.available_quantity),1)]),c(`div`,gt,[s[32]||=c(`label`,{for:`item-note`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Note (Optional) `,-1),_(c(`input`,{id:`item-note`,"onUpdate:modelValue":s[9]||=e=>F.value.note=e,type:`text`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm`,placeholder:`Optional note for this item...`},null,512),[[i,F.value.note]])])])):u(``,!0),F.value.selectedSaleItemId?(m(),d(`div`,_t,[c(`button`,{type:`button`,onClick:tn,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200`},[p(y(e),{class:`h-4 w-4 mr-2`}),s[33]||=f(` Add Item `,-1)])])):u(``,!0)]),L.items.length>0&&L.items[0].sale_item_id?(m(),d(`div`,vt,[s[44]||=c(`h4`,{class:`text-sm font-medium text-gray-700 dark:text-gray-300 mb-3`},`Items to Return`,-1),c(`div`,yt,[c(`table`,bt,[c(`thead`,xt,[c(`tr`,null,[s[34]||=c(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`#`,-1),s[35]||=c(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Item`,-1),s[36]||=c(`th`,{class:`px-3 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Sale`,-1),s[37]||=c(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Quantity`,-1),s[38]||=c(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Price`,-1),s[39]||=c(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Disc %`,-1),q.value?u(``,!0):(m(),d(`th`,St,`TAX %`)),q.value?u(``,!0):(m(),d(`th`,Ct,`TTC Price`)),u(``,!0),s[40]||=c(`th`,{class:`px-3 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Total USD`,-1),s[41]||=c(`th`,{class:`px-3 py-2 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Actions`,-1)])]),c(`tbody`,wt,[(m(!0),d(o,null,h(L.items,(e,t)=>(m(),d(`tr`,{key:t},[c(`td`,Tt,b(t+1),1),c(`td`,Et,[c(`div`,null,b(e.item_code),1),c(`div`,Dt,b(e.item_name),1),e.note?(m(),d(`div`,Ot,`Note: `+b(e.note),1)):u(``,!0)]),c(`td`,kt,[c(`div`,null,[c(`a`,{onClick:a(t=>$(e.sale_id),[`stop`]),class:`text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 cursor-pointer underline`,title:`View sale details (opens in new tab)`},b(e.sale_prefix)+b(e.sale_code),9,C)]),c(`div`,At,b(e.sale_date),1)]),c(`td`,jt,b(e.quantity)+` `+b(e.item_unit),1),c(`td`,Mt,b(Y(e.price)),1),c(`td`,Nt,b(e.discount_percent)+`%`,1),q.value?u(``,!0):(m(),d(`td`,Pt,b(e.tax_percent),1)),q.value?u(``,!0):(m(),d(`td`,Ft,b(Y(e.ttc_price)),1)),u(``,!0),c(`td`,It,b(Y(e.total_price_usd)),1),c(`td`,Lt,[c(`button`,{type:`button`,onClick:e=>nn(t),class:`inline-flex items-center p-1 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300`,title:`Remove item`},[p(y(se),{class:`h-4 w-4`})],8,Rt)])]))),128))]),c(`tfoot`,zt,[c(`tr`,null,[s[42]||=c(`td`,{colspan:`8`,class:`px-3 py-2 text-sm font-medium text-right text-gray-900 dark:text-gray-100`},`Total:`,-1),u(``,!0),c(`td`,Bt,b(Y(L.total_usd)),1),s[43]||=c(`td`,null,null,-1)])])])])])):u(``,!0)]),c(`div`,Vt,[s[48]||=c(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Return Summary `,-1),c(`div`,Ht,[c(`div`,null,[s[46]||=c(`label`,{for:`total_volume_cbm`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Volume (CBM) `,-1),_(c(`input`,{id:`total_volume_cbm`,"onUpdate:modelValue":s[10]||=e=>L.total_volume_cbm=e,type:`number`,min:`0`,step:`0.0001`,readonly:``,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 dark:bg-gray-600 text-gray-900 dark:text-white sm:text-sm`},null,512),[[i,L.total_volume_cbm,void 0,{number:!0}]])]),c(`div`,null,[s[47]||=c(`label`,{for:`total_weight_kg`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Weight (KG) `,-1),_(c(`input`,{id:`total_weight_kg`,"onUpdate:modelValue":s[11]||=e=>L.total_weight_kg=e,type:`number`,min:`0`,step:`0.0001`,readonly:``,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 dark:bg-gray-600 text-gray-900 dark:text-white sm:text-sm`},null,512),[[i,L.total_weight_kg,void 0,{number:!0}]])])])]),c(`div`,Ut,[s[49]||=c(`label`,{for:`note`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Notes `,-1),_(c(`textarea`,{id:`note`,"onUpdate:modelValue":s[12]||=e=>L.note=e,rows:`3`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,placeholder:`Any additional notes about this return...`},null,512),[[i,L.note]]),M.value.note?(m(),d(`p`,Wt,b(M.value.note),1)):u(``,!0)]),c(`div`,Gt,[c(`button`,{type:`button`,onClick:Q,disabled:k.value,class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},` Cancel `,8,Kt),c(`button`,{type:`submit`,disabled:k.value||!J.value,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},[k.value?(m(),l(y(t),{key:0,class:`w-4 h-4 mr-2 animate-spin`})):(m(),l(y(ce),{key:1,class:`w-4 h-4 mr-2`})),f(` `+b(k.value?`Creating...`:`Create Return Order`),1)],8,qt)])],32)])])])]))}}),T=w;export{T as default};
import{G as e,K as t,Q as ee,a$ as n,aC as te,aG as r,aH as ne,aS as re,aU as ie,aV as i,aW as a,aX as o,aY as s,a_ as c,ao as ae,b0 as oe,b3 as se,b5 as l,b6 as ce,bc as u,bf as d,bg as f,bh as p,bj as m,s as le,w as ue}from"./index-BogmXPcL.js";import{b as de}from"./useAuth-B8U5o7Ke.js";import"./GlobalConfig-wPgXFcZ5.js";import"./tableUtils-dXs1kjAL.js";import{b as fe}from"./ConfirmationModal-BSUNOORE.js";import{b as h,d as g}from"./currencyUtil-Bk2vDNVl.js";import{b as _}from"./DataItems-BkLlPyyC.js";import{b as pe}from"./salesStore-BAePzUlW.js";const me={class:`max-w-8xl mx-auto py-2`},he={class:``},v={class:`mb-8`},y={class:`flex items-center space-x-4 mb-2`},b={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},x={class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},S={class:`flex items-center justify-between`},C={class:`text-lg font-medium text-gray-900 dark:text-white`},w={class:`text-sm text-gray-500 dark:text-gray-400`},T={class:`flex space-x-3`},E={class:`px-6 py-8`},D={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},O={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6`},k={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-4`},A={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},j={class:`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6`},M={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},N={key:0,class:`text-center py-8 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg`},P={key:1,class:`overflow-x-auto`},F={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},I={class:`bg-gray-50 dark:bg-gray-700`},L={key:0,class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},R={key:1,class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},ge={key:2,class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},_e={key:3,class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},ve={key:4,class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},ye={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},be={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},xe={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Se={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ce={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},we={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},z={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Te={key:0,class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ee={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},De={key:1,class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Oe={key:2,class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ke={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ae={key:3,class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},je={class:`bg-gray-50 dark:bg-gray-700`},Me=[`colspan`],Ne={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Pe={key:0,class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Fe={key:0},Ie=[`colspan`],Le={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Re={key:0,class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},ze={key:1,class:`px-6 py-4`},Be={class:`bg-green-50 dark:bg-green-900`},Ve=[`colspan`],He={class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},Ue={key:0,class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},We={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},Ge={class:`grid grid-cols-1 md:grid-cols-3 gap-6`},Ke={class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},qe={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},Je={key:0,class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},Ye={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},Xe={class:`mt-1 text-lg font-medium`},Ze={key:0,class:`mb-6`},Qe={class:`bg-gray-50 dark:bg-gray-700 rounded-lg p-4`},$e={class:`text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap`},et={class:`pt-6 border-t border-gray-200 dark:border-gray-700`},tt={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},nt={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},rt={class:`px-6 py-8 text-center`};var B=oe({__name:`ViewPage`,setup(oe){let B=ne(),V=r(),H=te(),U=pe(),{isSalesman:it,isAdmin:W,isWarehouseManager:at}=de(),G=parseInt(V.params.id),K=d(!0),q=d({}),J=d(!1),Y=d(!1),X=ie(()=>{let e=W.value?10:9;return q.value.prefix===`INX`?e-2:e}),ot=()=>{B.push({name:`sales.index`})},st=()=>{B.push({name:`sales.edit`,params:{id:G.toString()}})},ct=()=>{B.push({name:`sales.invoice`,params:{id:G.toString()},query:{from:`view`}})},lt=()=>{J.value=!0},ut=()=>{J.value=!1,Y.value=!1},dt=async()=>{Y.value=!0;try{await U.deleteSale(G),H.success(`Sale deleted successfully`),B.push({name:`sales.index`})}catch{H.error(`Failed to delete sale`)}finally{Y.value=!1}},ft=async()=>{try{K.value=!0,q.value=await U.fetchSale(G)}catch(e){console.error(`Error loading sale:`,e),H.error(`Failed to load sale details`),B.push({name:`sales.index`})}finally{K.value=!1}},Z=e=>{let t=Number(e||0);return t>0?`text-green-600 dark:text-green-400 font-medium`:t<0?`text-red-600 dark:text-red-400 font-medium`:`text-gray-600 dark:text-gray-400`},pt=e=>{let t=Number(e||0);return t>0?`bg-green-50 dark:bg-green-900 text-green-600 dark:text-green-400`:t<0?`bg-red-50 dark:bg-red-900 text-red-600 dark:text-red-400`:`bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-400`},Q=e=>e?parseFloat(Number(e).toFixed(2)).toString():`0`,mt=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleDateString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`})},$=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`})};return se(async()=>{await ft()}),(te,r)=>(l(),s(`div`,me,[i(`div`,he,[i(`div`,v,[i(`div`,y,[i(`button`,{onClick:ot,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[n(f(ae),{class:`w-5 h-5`})]),r[1]||=i(`div`,null,[i(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},` Sale Details `),i(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},` View sale order information `)],-1)])]),K.value?(l(),s(`div`,nt,[i(`div`,rt,[n(f(ee),{class:`w-8 h-8 animate-spin mx-auto text-blue-600`}),r[26]||=i(`p`,{class:`mt-2 text-gray-600 dark:text-gray-400`},`Loading sale details...`,-1)])])):(l(),s(`div`,b,[i(`div`,x,[i(`div`,S,[i(`div`,null,[i(`h3`,C,m(q.value.prefix)+`-`+m(q.value.code),1),i(`p`,w,` Sale ID: `+m(q.value.id),1)]),i(`div`,T,[i(`button`,{onClick:ct,class:`inline-flex items-center px-3 py-2 border border-green-300 dark:border-green-600 text-sm font-medium rounded-md text-green-700 dark:text-green-300 bg-white dark:bg-gray-800 hover:bg-green-50 dark:hover:bg-green-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200`},[n(f(e),{class:`w-4 h-4 mr-2`}),r[2]||=c(` Print Invoice `,-1)]),f(W)?(l(),s(`button`,{key:0,onClick:st,class:`inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200`},[n(f(t),{class:`w-4 h-4 mr-2`}),r[3]||=c(` Edit `,-1)])):o(``,!0),f(W)?(l(),s(`button`,{key:1,onClick:lt,class:`inline-flex items-center px-3 py-2 border border-red-300 dark:border-red-600 text-sm font-medium rounded-md text-red-700 dark:text-red-300 bg-white dark:bg-gray-800 hover:bg-red-50 dark:hover:bg-red-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200`},[n(f(le),{class:`w-4 h-4 mr-2`}),r[4]||=c(` Delete `,-1)])):o(``,!0)])])]),i(`div`,E,[i(`div`,D,[r[5]||=i(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Basic Information `,-1),i(`div`,O,[n(_,{label:`Sale Date`,value:mt(q.value.date)},null,8,[`value`]),n(_,{label:`Customer`,value:q.value.customer.name},null,8,[`value`]),n(_,{label:`Salesperson`,value:q.value.salesperson.name},null,8,[`value`]),n(_,{label:`Warehouse`,value:q.value.warehouse.name},null,8,[`value`]),n(_,{label:`Currency`,value:`${q.value.currency.code} - ${q.value.currency.name}`},null,8,[`value`])]),i(`div`,k,[f(g)(q.value.currency.code)?o(``,!0):(l(),a(_,{key:0,label:`Currency Rate`,value:f(h)(q.value.currency_rate)},null,8,[`value`]))])]),i(`div`,A,[r[6]||=i(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Financial Summary `,-1),i(`div`,j,[n(_,{label:`Sub Total`,value:f(h)(q.value.sub_total,!0,q.value.currency)},null,8,[`value`]),n(_,{label:`Sub Total (USD)`,value:f(h)(q.value.sub_total_usd,!0)},null,8,[`value`]),q.value.discount_amount&&q.value.discount_amount>0?(l(),a(_,{key:0,label:`Discount Amount`,value:f(h)(q.value.discount_amount,!0,q.value.currency)},null,8,[`value`])):o(``,!0),f(W)?(l(),a(_,{key:1,label:`Total Profit`},{default:u(()=>[i(`div`,{class:p([`text-sm`,Z(q.value.total_profit)])},m(f(h)(q.value.total_profit,!0,null)),3)]),_:1})):o(``,!0)])]),i(`div`,M,[r[20]||=i(`div`,{class:`flex items-center justify-between mb-4`},[i(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white`},` Sale Items `)],-1),q.value.items&&q.value.items.length===0?(l(),s(`div`,N,[n(f(ue),{class:`mx-auto h-12 w-12 text-gray-400`}),r[7]||=i(`h5`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},`No items found`,-1),r[8]||=i(`p`,{class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},`This sale has no items.`,-1)])):(l(),s(`div`,P,[i(`table`,F,[i(`thead`,I,[i(`tr`,null,[r[12]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`#`,-1),r[13]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Code`,-1),r[14]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Item`,-1),r[15]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Unit`,-1),r[16]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[i(`abbr`,{title:`Total Quantity`},`QTY`)],-1),r[17]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Sale Price`,-1),f(W)?(l(),s(`th`,L,`Cost Price`)):o(``,!0),r[18]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[i(`abbr`,{title:`Discount Percentage`},`Dis. %`)],-1),q.value.prefix===`INX`?o(``,!0):(l(),s(`th`,R,r[9]||=[i(`abbr`,{title:`Tax Percentage`},`Tax %`,-1)])),q.value.prefix===`INX`?o(``,!0):(l(),s(`th`,ge,r[10]||=[i(`abbr`,{title:`Tax-inclusive Price`},`TTC`,-1)])),r[19]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Total`,-1),f(g)(q.value.currency.code)?o(``,!0):(l(),s(`th`,_e,`USD`)),f(W)?(l(),s(`th`,ve,r[11]||=[i(`abbr`,{title:`Total Profit`},`T.Profit`,-1)])):o(``,!0)])]),i(`tbody`,ye,[(l(!0),s(re,null,ce(q.value.items,(e,t)=>(l(),s(`tr`,{key:t,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[i(`td`,be,m(t+1),1),i(`td`,xe,m(e.item_code),1),i(`td`,Se,m(e.item.description),1),i(`td`,Ce,m(e.item.item_unit.name),1),i(`td`,we,m(Q(e.quantity)),1),i(`td`,z,m(f(h)(e.price,!0,q.value.currency)),1),f(W)?(l(),s(`td`,Te,m(f(h)(e.cost_price,!0)),1)):o(``,!0),i(`td`,Ee,m(Q(e.discount_percent))+`%`,1),q.value.prefix===`INX`?o(``,!0):(l(),s(`td`,De,m(Q(e.tax_percent))+`%`,1)),q.value.prefix===`INX`?o(``,!0):(l(),s(`td`,Oe,m(f(h)(e.ttc_price,!0,q.value.currency)),1)),i(`td`,ke,m(f(h)(e.total_price,!0,q.value.currency)),1),f(g)(q.value.currency.code)?o(``,!0):(l(),s(`td`,Ae,m(f(h)(e.total_price_usd,!0)),1)),f(W)?(l(),s(`td`,{key:4,class:p([`px-6 py-4 whitespace-nowrap text-sm`,Z(e.total_profit)])},m(f(h)(e.total_profit)),3)):o(``,!0)]))),128))]),i(`tfoot`,je,[i(`tr`,null,[i(`td`,{colspan:X.value,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Sub Total:`,8,Me),i(`td`,Ne,m(f(h)(q.value.sub_total,!0,q.value.currency)),1),f(g)(q.value.currency.code)?o(``,!0):(l(),s(`td`,Pe,m(f(h)(q.value.sub_total_usd,!0)),1)),f(W)?(l(),s(`td`,{key:1,class:p([`px-6 py-4 text-sm font-medium`,Z(q.value.total_profit)])},m(f(h)(q.value.total_profit,!0)),3)):o(``,!0)]),q.value.discount_amount&&Number(q.value.discount_amount)>0?(l(),s(`tr`,Fe,[i(`td`,{colspan:X.value,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Additional Discount:`,8,Ie),i(`td`,Le,`-`+m(f(h)(q.value.discount_amount,q.value.currency)),1),f(g)(q.value.currency.code)?o(``,!0):(l(),s(`td`,Re,`-`+m(f(h)(q.value.discount_amount_usd)),1)),f(W)?(l(),s(`td`,ze)):o(``,!0)])):o(``,!0),i(`tr`,Be,[i(`td`,{colspan:X.value,class:`px-6 py-4 text-right text-sm font-bold text-gray-900 dark:text-white`},`Final Total:`,8,Ve),i(`td`,He,m(f(h)(q.value.total,!0,q.value.currency)),1),f(g)(q.value.currency.code)?o(``,!0):(l(),s(`td`,Ue,m(f(h)(q.value.total_usd,!0)),1)),f(W)?(l(),s(`td`,{key:1,class:p([`px-6 py-4 text-sm font-bold`,Z(q.value.total_profit)])},m(f(h)(q.value.total_profit,!0)),3)):o(``,!0)])])])]))]),i(`div`,We,[r[24]||=i(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Final Totals `,-1),i(`div`,Ge,[i(`div`,Ke,[r[21]||=i(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount`,-1),i(`dd`,qe,m(f(h)(q.value.total,!0,q.value.currency)),1)]),f(g)(q.value.currency.code)?o(``,!0):(l(),s(`div`,Je,[r[22]||=i(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount (USD)`,-1),i(`dd`,Ye,m(f(h)(q.value.total_usd,!0)),1)])),f(W)?(l(),s(`div`,{key:1,class:p([`rounded-lg p-4`,pt(q.value.total_profit)])},[r[23]||=i(`dt`,{class:`text-sm font-medium`},`Total Profit`,-1),i(`dd`,Xe,m(f(h)(q.value.total_profit,!0)),1)],2)):o(``,!0)])]),q.value.note?(l(),s(`div`,Ze,[r[25]||=i(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Notes `,-1),n(_,{label:`Note`},{default:u(()=>[i(`div`,Qe,[i(`p`,$e,m(q.value.note),1)])]),_:1})])):o(``,!0),i(`div`,et,[i(`div`,tt,[n(_,{label:`Created At`,value:$(q.value.created_at)},null,8,[`value`]),n(_,{label:`Last Updated`,value:$(q.value.updated_at)},null,8,[`value`])])])])]))]),n(fe,{show:J.value,"onUpdate:show":r[0]||=e=>J.value=e,type:`delete`,title:`Delete Sale ${q.value.prefix}-${q.value.code}`,message:`Are you sure you want to delete sale '${q.value.prefix}-${q.value.code}'? This action can be undone by restoring from trash.`,"confirm-text":`Delete Sale`,"loading-text":`Deleting...`,loading:Y.value,onConfirm:dt,onCancel:ut},null,8,[`show`,`title`,`message`,`loading`])]))}}),V=B;export{V as default};
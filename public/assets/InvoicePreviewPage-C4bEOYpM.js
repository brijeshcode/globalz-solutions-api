import{A as e,_ as t,aA as n,aC as r,aE as i,aF as a,aO as o,aP as s,aS as c,ab as l,af as u,ag as d,aq as f,at as p,av as m,aw as h,ay as g,az as _,s as ee}from"./index-oqf5aoQw.js";import"./GlobalConfig-BnwaQAhg.js";import"./tableUtils-BvWofAYZ.js";import{b as te}from"./salesStore-CHmoHqzH.js";import{b as v}from"./companyStore-T5q_TKQY.js";const y={class:`max-w-4xl mx-auto p-8 bg-white text-gray-900 print:p-0 print:max-w-none print:mx-0`},b={class:`flex justify-between items-start mb-10 pb-6 border-b-2 border-blue-600 print:border-black print:mb-6`},x={key:0,class:`flex-1`},S={class:`flex items-center mb-3`},C=[`src`,`alt`],w={key:1,class:`text-3xl font-bold text-blue-600 print:text-black print:text-2xl`},T={class:`print:text-black`},E={class:`text-right flex-1 mt-4`},D={class:`text-lg font-semibold text-gray-600 print:text-black print:text-base`},O={class:`grid grid-cols-1 md:grid-cols-2 gap-8 mb-10 print:grid-cols-2 print:gap-6 print:mb-6`},k={class:`space-y-1 print:space-y-0`},A={class:`flex justify-between print:justify-between`},j={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},M={class:`flex justify-between print:justify-between`},N={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},P={key:0,class:`flex justify-between print:justify-between`},F={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},I={key:1,class:`flex justify-between print:justify-between`},L={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},R={key:2,class:`flex justify-between print:justify-between`},z={class:`text-red-600 font-bold print:font-normal print:text-black print:text-xs`},B={class:`space-y-1 print:space-y-0`},V={class:`flex justify-between print:justify-between`},H={class:`text-gray-900 print:text-black print:text-xs`},U={class:`flex justify-between print:justify-between`},W={class:`text-gray-900 print:text-black print:text-xs`},G={key:0,class:`flex justify-between print:justify-between`},K={class:`text-gray-900 print:text-black print:text-xs`},q={class:`mb-8 print:mb-4`},J={class:`overflow-x-auto print:overflow-visible`},Y={class:`w-full border-collapse border border-gray-300 print:border-black`},X={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center print:border-black print:text-black print:text-xs`},Z={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},Q={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},ne={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},re={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},ie={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},ae={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},oe={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-black print:text-xs`},se={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-black print:text-xs`},ce={class:`print:text-black print:text-xs`},le={class:`print:text-black print:text-xs`},ue={colspan:`4`,class:`print:border-black text-center relative`},de=[`src`,`alt`],fe={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-black print:text-xs`},pe={class:`print:text-black print:text-xs`},me={class:`print:text-black print:text-xs`},he={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-black print:text-xs`},ge={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-black print:text-xs`},_e={key:0,class:`mt-4 print:mt-2`},ve={class:`flex gap-x-4 text-sm text-gray-600 print:text-black print:text-xs print:gap-x-4`},ye={key:0,class:`flex-2 text-left print:flex-2`},be={key:1,class:`flex-1 text-center print:flex-1`},xe={key:2,class:`flex-1 text-center print:flex-1`},Se={key:3,class:`flex-1 text-right print:flex-1`};var Ce=n({__name:`SaleInvoice`,props:{saleData:{},customers:{default:()=>[]},warehouses:{default:()=>[]},currencies:{default:()=>[]},salespersons:{default:()=>[]},items:{default:()=>[]}},setup(e,{expose:t}){let n=e,o=v();r(async()=>{try{o.company.name||await o.fetchCompany()}catch(e){console.error(`Failed to fetch company data:`,e)}});let l=e=>e?parseFloat(Number(e).toFixed(2)).toString():`0`,u=()=>n.saleData.prefix===`INV`,d=e=>e?Number(e).toLocaleString(`en-US`,{minimumFractionDigits:2,maximumFractionDigits:2}):`0.00`,g=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleDateString(`en-US`,{year:`numeric`,month:`long`,day:`numeric`})},_=()=>{window.print()};return t({printInvoice:_}),(e,t)=>(i(),h(`div`,y,[p(`div`,b,[u()?(i(),h(`div`,x,[p(`div`,S,[s(o).company.logo?.preview_url?(i(),h(`img`,{key:0,src:s(o).company.logo.preview_url,alt:s(o).company.name||`Company Logo`,class:`h-16 w-auto mr-4 print:h-12`},null,8,C)):m(``,!0),s(o).company.logo?.preview_url?m(``,!0):(i(),h(`div`,w,c(s(o).company.name),1))]),p(`div`,null,[p(`p`,T,[p(`b`,null,`Tax Registration #: `+c(s(o).company.tax_number),1)])])])):m(``,!0),p(`div`,E,[t[0]||=p(`h1`,{class:`text-2xl font-bold text-blue-600 mb-2 print:text-black print:text-xl`},`SALES INVOICE`,-1),p(`div`,D,c(e.saleData.prefix)+`-`+c(e.saleData.code),1)]),m(``,!0)]),p(`div`,O,[p(`div`,null,[t[7]||=p(`h3`,{class:`text-lg font-bold text-blue-600 mb-3 print:text-sm border-b border-gray-200 print:text-black print:border-black`},`Customer Information`,-1),p(`div`,k,[p(`div`,A,[t[2]||=p(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Customer:`,-1),p(`span`,j,c(e.saleData.customer?.code)+`, `+c(e.saleData.customer?.name||`Unknown Customer`),1)]),p(`div`,M,[t[3]||=p(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Address:`,-1),p(`span`,N,c(e.saleData.customer?.address)+`, `+c(e.saleData.customer?.city),1)]),e.saleData.customer?.mobile?(i(),h(`div`,P,[t[4]||=p(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Phone:`,-1),p(`span`,F,c(e.saleData.customer?.mobile),1)])):m(``,!0),e.saleData.customer?.mof_tax_number?(i(),h(`div`,I,[t[5]||=p(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Tax #:`,-1),p(`span`,L,c(e.saleData.customer?.mof_tax_number),1)])):m(``,!0),e.saleData.outStanding_balance&&Number(e.saleData.outStanding_balance)>0?(i(),h(`div`,R,[t[6]||=p(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Outstanding Balance:`,-1),p(`span`,z,c(d(e.saleData.outStanding_balance)),1)])):m(``,!0)])]),p(`div`,null,[t[11]||=p(`h3`,{class:`text-lg font-bold text-blue-600 mb-3 print:text-sm border-b border-gray-200 print:text-black print:border-black`},`Invoice Details`,-1),p(`div`,B,[p(`div`,V,[t[8]||=p(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Date:`,-1),p(`span`,H,c(g(e.saleData.date)),1)]),p(`div`,U,[t[9]||=p(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Currency:`,-1),p(`span`,W,c(e.saleData.currency?.code||`N/A`),1)]),e.saleData.salesperson?(i(),h(`div`,G,[t[10]||=p(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Salesperson:`,-1),p(`span`,K,c(e.saleData.salesperson?.name||`Not assigned`),1)])):m(``,!0)])])]),p(`div`,q,[p(`div`,J,[p(`table`,Y,[t[19]||=p(`thead`,null,[p(`tr`,{class:`bg-gray-100 print:bg-gray-200`},[p(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`#`),p(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-left font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Item Code`),p(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-left font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Description`),p(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Price`),p(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},[p(`abbr`,{title:`Discount Percentage`},`Dis. %`)]),p(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},[p(`abbr`,{title:`Total Quantity`},`QTY`)]),p(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},[p(`abbr`,{title:`Tax Percentage`},`Tax %`)]),p(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Total`)])],-1),p(`tbody`,null,[(i(!0),h(f,null,a(e.saleData.items,(e,t)=>(i(),h(`tr`,{key:t,class:`even:bg-gray-50 print:even:bg-gray-100`},[p(`td`,X,c(t+1),1),p(`td`,Z,c(e.item_code||``),1),p(`td`,Q,c(e.item?.description||`Unknown Item`),1),p(`td`,ne,c(d(e.price)),1),p(`td`,re,c(l(e.discount_percent))+`%`,1),p(`td`,ie,c(l(e.quantity)),1),p(`td`,ae,c(l(e.tax_percent)),1),p(`td`,oe,c(d(e.total_price)),1)]))),128)),p(`tr`,null,[t[12]||=p(`td`,{colspan:`6`,class:`print:border-black`},null,-1),t[13]||=p(`td`,{class:`border border-gray-300 print:border-black print:text-black print:text-xs`},` Sub Total`,-1),p(`td`,se,c(d(e.saleData.sub_total)),1)]),p(`tr`,null,[p(`td`,ce,[m(``,!0)]),p(`td`,le,[m(``,!0)]),p(`td`,ue,[s(o).company.stamp?.preview_url&&u()?(i(),h(`img`,{key:0,src:s(o).company.stamp.preview_url,alt:s(o).company.name||`Company Logo`,class:`h-16 w-auto mr-4 -rotate-6 print:h-8 absolute left-24`},null,8,de)):m(``,!0)]),t[14]||=p(`td`,{class:`border border-gray-300 print:border-black print:text-black print:text-xs`},`Add. Discount`,-1),p(`td`,fe,c(d(e.saleData.discount_amount)),1)]),p(`tr`,null,[p(`td`,pe,[m(``,!0)]),p(`td`,me,[m(``,!0)]),t[15]||=p(`td`,{colspan:`4`,class:`print:border-black`},null,-1),t[16]||=p(`td`,{class:`border border-gray-300 print:border-black print:text-black print:text-xs`},` Vat 11`,-1),p(`td`,he,c(d(e.saleData.sub_total)),1)]),p(`tr`,null,[t[17]||=p(`td`,{colspan:`6`,class:`print:border-black`},null,-1),t[18]||=p(`td`,{class:`border border-gray-300 print:border-black print:text-black print:text-xs`},` Net Total USD`,-1),p(`td`,ge,c(d(e.saleData.total_usd)),1)])])])])]),t[20]||=p(`div`,{class:`max-w-4xl mx-auto pt-2 pb-12 px-8 border-1 border-t flex text-center print:text-sm`},[p(`div`,{class:`flex-1`},`Receved By`),p(`div`,{class:`flex-1`},`Signature By`)],-1),u()?(i(),h(`div`,_e,[p(`div`,ve,[s(o).company.address?(i(),h(`p`,ye,c(s(o).company.address),1)):m(``,!0),s(o).company.phone?(i(),h(`p`,be,c(s(o).company.phone),1)):m(``,!0),s(o).company.email?(i(),h(`p`,xe,c(s(o).company.email),1)):m(``,!0),s(o).company.website?(i(),h(`p`,Se,c(s(o).company.website),1)):m(``,!0)])])):m(``,!0)]))}}),we=Ce;const Te={class:`min-h-screen bg-gray-50 print:bg-white`},Ee={class:`bg-white shadow-sm border-b print:hidden`},De={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8`},$={class:`flex items-center justify-between h-16`},Oe={class:`flex items-center space-x-4`},ke={class:`text-sm text-gray-500`},Ae={class:`flex items-center space-x-3`},je={key:0,class:`flex items-center justify-center min-h-screen`},Me={class:`text-center`},Ne={key:1,class:`py-8 print:py-0`},Pe={class:`max-w-6xl mx-auto print:max-w-none`};var Fe=n({__name:`InvoicePreviewPage`,setup(n){let a=d(),f=u(),m=l(),v=te(),y=parseInt(f.params.id),b=o(!0),x=o({}),S=o(null),C=()=>{let e=f.query.from===`view`;e?a.push({name:`sales.show`,params:{id:y.toString()}}):a.push({name:`sales.index`})},w=async()=>{if(S.value)try{await S.value.printInvoice()}catch(e){console.error(`Failed to print invoice:`,e),m.error(`Failed to print invoice`)}},T=async()=>{try{x.value=await v.fetchSale(y)}catch(e){console.error(`Error loading sale:`,e),m.error(`Failed to load sale details`),a.push({name:`sales.index`})}};return r(async()=>{try{b.value=!0,await Promise.all([T()])}catch(e){console.error(`Error initializing invoice preview:`,e)}finally{b.value=!1}}),(n,r)=>(i(),h(`div`,Te,[p(`div`,Ee,[p(`div`,De,[p(`div`,$,[p(`div`,Oe,[p(`button`,{onClick:C,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100 transition-colors`},[_(s(t),{class:`w-5 h-5`})]),p(`div`,null,[r[0]||=p(`h1`,{class:`text-lg font-semibold text-gray-900`},`Invoice Preview`,-1),p(`p`,ke,c(x.value.prefix)+`-`+c(x.value.code),1)])]),p(`div`,Ae,[p(`button`,{onClick:w,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`},[_(s(ee),{class:`w-4 h-4 mr-2`}),r[1]||=g(` Print Invoice `,-1)])])])])]),b.value?(i(),h(`div`,je,[p(`div`,Me,[_(s(e),{class:`w-8 h-8 animate-spin mx-auto text-blue-600`}),r[2]||=p(`p`,{class:`mt-2 text-gray-600`},`Loading invoice...`,-1)])])):(i(),h(`div`,Ne,[p(`div`,Pe,[_(we,{ref_key:`saleInvoiceRef`,ref:S,"sale-data":x.value},null,8,[`sale-data`])])]))]))}}),Ie=Fe;export{Ie as default};
import{a$ as e,aF as t,aX as n,ai as r,aj as i,ak as a,al as o,am as s,ar as c,as as l,at as u}from"./index-DMU9rpXT.js";import{b as d}from"./tableUtils-BFc6-TYF.js";var f=class{baseUrl=`/setups/price-lists`;async getPriceLists(e){try{let t=this.buildQueryParams(e),n=await i(`${this.baseUrl}?${t}`,{loadingMessage:`Loading price lists...`,showLoading:!0});return{data:n.data.data,pagination:n.data.pagination}}catch(e){throw console.error(`Error fetching price lists:`,e),e}}async getPriceList(e){try{let t=await i(`${this.baseUrl}/${e}`,{loadingMessage:`Loading price list...`});return t.data.data}catch(e){throw console.error(`Error fetching price list:`,e),e}}async createPriceList(e){try{let t=await o(this.baseUrl,e,{loadingMessage:`Creating price list...`,showSuccessNotification:!0,successMessage:`Price list created successfully`});return t.data.data}catch(e){throw console.error(`Error creating price list:`,e),e}}async updatePriceList(e,t){try{let n=await s(`${this.baseUrl}/${e}`,t,{loadingMessage:`Updating price list...`,showSuccessNotification:!0,successMessage:`Price list updated successfully`});return n.data.data}catch(e){throw console.error(`Error updating price list:`,e),e}}async deletePriceList(e){try{await r(`${this.baseUrl}/${e}`,{loadingMessage:`Deleting price list...`,showSuccessNotification:!0,successMessage:`Price list deleted successfully`})}catch(e){throw console.error(`Error deleting price list:`,e),e}}async getTrashedPriceLists(e){try{let t=this.buildQueryParams(e),n=await i(`${this.baseUrl}/trashed?${t}`,{loadingMessage:`Loading trashed price lists...`});return{data:n.data.data,pagination:n.data.pagination}}catch(e){throw console.error(`Error fetching trashed price lists:`,e),e}}async restorePriceList(e){try{let t=await a(`${this.baseUrl}/${e}/restore`,{},{loadingMessage:`Restoring price list...`,showSuccessNotification:!0,successMessage:`Price list restored successfully`});return t.data.data}catch(e){throw console.error(`Error restoring price list:`,e),e}}async forceDeletePriceList(e){try{await r(`${this.baseUrl}/${e}/force-delete`,{loadingMessage:`Permanently deleting price list...`,showSuccessNotification:!0,successMessage:`Price list permanently deleted`})}catch(e){throw console.error(`Error permanently deleting price list:`,e),e}}async searchPriceLists(e){try{let t=await i(`${this.baseUrl}/search?query=${encodeURIComponent(e)}`,{showLoading:!1});return t.data.data}catch(e){throw console.error(`Error searching price lists:`,e),e}}async getPriceListItems(e){try{let t=await i(`${this.baseUrl}/${e}/items`,{loadingMessage:`Loading price list items...`,showLoading:!0});return t.data.data}catch(e){throw console.error(`Error fetching price list items:`,e),e}}async addPriceListItem(e,t){try{let n=await o(`${this.baseUrl}/${e}/items`,t,{loadingMessage:`Adding item...`,showSuccessNotification:!1});return n.data.data}catch(e){throw console.error(`Error adding price list item:`,e),e}}async updatePriceListItem(e,t,n){try{let r=await s(`${this.baseUrl}/${e}/items/${t}`,n,{loadingMessage:`Updating item...`,showSuccessNotification:!1});return r.data.data}catch(e){throw console.error(`Error updating price list item:`,e),e}}async deletePriceListItem(e){try{await r(`${this.baseUrl}/items/${e}`,{loadingMessage:`Removing item...`,showSuccessNotification:!1})}catch(e){throw console.error(`Error deleting price list item:`,e),e}}buildQueryParams(e){if(!e)return``;let t=new URLSearchParams;return Object.entries(e).forEach(([e,n])=>{n!=null&&n!==``&&t.append(e,String(n))}),t.toString()}};const p=new f,m=u(`priceList`,()=>{let r=l(),i=c(),a=e([]),o=e(null),s=e([]),u=e(d()),f=e(!1),m=e({per_page:50}),h=t(()=>e=>a.value.filter(t=>t.code.toLowerCase().includes(e.toLowerCase()))),g=t(()=>e=>a.value.filter(t=>t.description.toLowerCase().includes(e.toLowerCase()))),_=t(()=>a.value.length),v=t(()=>({total:a.value.length,totalItems:a.value.reduce((e,t)=>e+t.item_count,0)})),y=t(()=>{let e={};return Object.entries(i.query).forEach(([t,n])=>{n&&typeof n==`string`&&(e[t]=n)}),e}),b=async e=>{try{f.value=!0,e&&(m.value={...m.value,...e});let t=await p.getPriceLists(m.value);a.value=t.data,u.value=t.pagination}catch(e){throw console.error(`Error fetching price lists:`,e),e}finally{f.value=!1}},x=async e=>{try{let t=await p.getPriceList(e);return o.value=t,t}catch(e){throw console.error(`Error fetching price list:`,e),e}},S=async e=>{try{let t=await p.createPriceList(e);return a.value.unshift(t),u.value.total+=1,t}catch(e){throw console.error(`Error creating price list:`,e),e}},C=async(e,t)=>{try{let n=await p.updatePriceList(e,t),r=a.value.findIndex(t=>t.id===e);return r!==-1&&(a.value[r]=n),o.value?.id===e&&(o.value=n),n}catch(e){throw console.error(`Error updating price list:`,e),e}},w=async e=>{try{await p.deletePriceList(e);let t=a.value.findIndex(t=>t.id===e);t!==-1&&a.value.splice(t,1),--u.value.total,o.value?.id===e&&(o.value=null)}catch(e){throw console.error(`Error deleting price list:`,e),e}},T=async e=>{try{f.value=!0;let t=e||{},n=await p.getTrashedPriceLists(t);s.value=n.data}catch(e){throw console.error(`Error fetching trashed price lists:`,e),e}finally{f.value=!1}},E=async e=>{try{let t=await p.restorePriceList(e),n=s.value.findIndex(t=>t.id===e);return n!==-1&&s.value.splice(n,1),a.value.unshift(t),u.value.total+=1,t}catch(e){throw console.error(`Error restoring price list:`,e),e}},D=async e=>{try{await p.forceDeletePriceList(e);let t=s.value.findIndex(t=>t.id===e);t!==-1&&s.value.splice(t,1)}catch(e){throw console.error(`Error permanently deleting price list:`,e),e}},O=async e=>{try{return await p.searchPriceLists(e)}catch(e){throw console.error(`Error searching price lists:`,e),e}},k=async e=>{try{let t=await p.getPriceListItems(e);return o.value&&o.value.id===e&&(o.value.price_list_items=t,o.value.item_count=t.length),t}catch(e){throw console.error(`Error fetching price list items:`,e),e}},A=async(e,t)=>{try{let n=await p.addPriceListItem(e,t);return o.value&&o.value.id===e&&(o.value.price_list_items||(o.value.price_list_items=[]),o.value.price_list_items.push(n),o.value.item_count=(o.value.item_count||0)+1),n}catch(e){throw console.error(`Error adding price list item:`,e),e}},j=async(e,t,n)=>{try{let r=await p.updatePriceListItem(e,t,n);if(o.value&&o.value.price_list_items){let e=o.value.price_list_items.findIndex(e=>e.id===t);e!==-1&&(o.value.price_list_items[e]=r)}return r}catch(e){throw console.error(`Error updating price list item:`,e),e}},M=async e=>{try{if(await p.deletePriceListItem(e),o.value&&o.value.price_list_items){let t=o.value.price_list_items.findIndex(t=>t.id===e);t!==-1&&(o.value.price_list_items.splice(t,1),o.value.item_count=Math.max(0,(o.value.item_count||0)-1))}}catch(e){throw console.error(`Error deleting price list item:`,e),e}},N=e=>{m.value={...m.value,...e}},P=()=>{m.value={per_page:50}},F=()=>{o.value=null},I=e=>{let t={...m.value,search:e,page:1};m.value=t,B(t),U(t,!1)},L=(e,t)=>{let n={...m.value,sort_by:e,sort_direction:t,page:1};m.value=n,B(n),U(n,!1)},R=e=>{let t={...m.value,page:e};m.value=t,B(t),U(t,!1)},z=e=>{let t={...m.value,per_page:e,page:1};m.value=t,B(t),U(t,!1)},B=(e,t=!1)=>{let n={...i.query};Object.entries(e).forEach(([e,t])=>{t!=null&&t!==``?n[e]=String(t):delete n[e]});let a=t?`replace`:`push`;r[a]({query:n})},V=()=>{r.replace({query:{}})},H=()=>{let e={per_page:50};m.value={...e,...y.value}},U=async(e,t=!0)=>{t&&e&&B(e),await b(e)},W=()=>{a.value=[],o.value=null,s.value=[],u.value=d(),m.value={per_page:50},f.value=!1};return n(()=>i.query,async()=>{if(H(),i.name&&i.name.toString().includes(`price-list`))try{await b(m.value)}catch(e){console.error(`Error fetching price lists on URL change:`,e)}},{immediate:!1,deep:!0}),{priceLists:a,currentPriceList:o,trashedPriceLists:s,pagination:u,loading:f,filters:m,priceListsByCode:h,priceListsByDescription:g,totalPriceLists:_,priceListStats:v,urlParams:y,fetchPriceLists:b,fetchPriceList:x,createPriceList:S,updatePriceList:C,deletePriceList:w,fetchTrashedPriceLists:T,restorePriceList:E,forceDeletePriceList:D,searchPriceLists:O,fetchPriceListItems:k,addPriceListItem:A,updatePriceListItem:j,deletePriceListItem:M,updateFilters:N,clearFilters:P,clearCurrentPriceList:F,setSearch:I,setSort:L,setPage:R,setPerPage:z,updateUrlParams:B,clearUrlParams:V,syncFiltersWithUrl:H,fetchData:U,reset:W}});export{m as b};
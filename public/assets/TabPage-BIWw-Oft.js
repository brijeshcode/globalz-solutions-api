import{D as e,F as t,K as n,N as r,W as i,a4 as a,a5 as o,a6 as s,a7 as c,a8 as l,aA as u,aE as d,aG as f,aH as p,aK as m,aL as h,aN as g,aO as _,aP as v,aQ as y,aR as b,aS as x,aT as S,aU as C,aV as w,aX as ee,aZ as T,a_ as E,ae as D,ah as O,av as k,b3 as A,b4 as j,b5 as M,b6 as N,b7 as P,b8 as F,b9 as I,bb as L,f as R,p as z,u as B}from"./index-KopOJhzy.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-jdfVzp2e.js";import{b as V}from"./PageHeader-BUdMn1ih.js";import{b as te}from"./ConfirmationModal-_8dfXadx.js";import{d as H}from"./common-CAcZd9q3.js";import{b as ne}from"./StatusBadge-RMx1qNV3.js";import"./currencyUtil-4fjG38Kn.js";import{c as U}from"./departmentsStore-DqPQaOh0.js";import{b as W}from"./Tabs-DnMPQr9u.js";import{b as G}from"./DetailsModal-B71xy5fq.js";const re={class:`space-y-6`},ie={class:`bg-white dark:bg-gray-800 shadow rounded-lg p-4`},ae={class:`grid grid-cols-1 md:grid-cols-4 gap-4`},oe={class:`md:col-span-2`},se={class:`relative`},ce={class:`bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden`},le={key:0,class:`p-8 text-center`},ue={key:1,class:`p-8 text-center`},de={class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},fe={key:0,class:`mt-6`},pe={key:2,class:`overflow-x-auto`},me={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},he={class:`bg-gray-50 dark:bg-gray-700`},ge={class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},_e={class:`flex flex-col`},ve={class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},ye={class:`flex flex-col`},be={class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},xe={class:`flex flex-col`},Se={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},Ce={class:`px-6 py-4 whitespace-nowrap`},we={class:`flex items-center`},Te={class:`flex-shrink-0 h-10 w-10`},Ee={class:`h-10 w-10 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center`},De={class:`ml-4`},Oe={class:`text-sm font-medium text-gray-900 dark:text-white`},ke={class:`text-sm text-gray-500 dark:text-gray-400`},Ae={class:`px-6 py-4 whitespace-nowrap`},je={class:`px-6 py-4 whitespace-nowrap`},Me={class:`text-sm text-gray-900 dark:text-white`},Ne={class:`text-sm text-gray-600 dark:text-gray-400`},Pe={class:`text-xs text-gray-500 dark:text-gray-500`},Fe={class:`px-6 py-4 whitespace-nowrap text-right text-sm font-medium`},Ie={class:`flex items-center justify-end space-x-2`},Le=[`onClick`],Re=[`onClick`],ze=[`onClick`],Be={key:3,class:`bg-white dark:bg-gray-800 px-4 py-3 border-t border-gray-200 dark:border-gray-700 sm:px-6`},Ve={class:`flex items-center justify-between`},He={class:`flex-1 flex justify-between sm:hidden`},Ue=[`disabled`],We=[`disabled`],Ge={class:`hidden sm:flex-1 sm:flex sm:items-center sm:justify-between`},Ke={class:`text-sm text-gray-700 dark:text-gray-300`},qe={class:`font-medium`},Je={class:`font-medium`},Ye={class:`font-medium`},Xe={class:`relative z-0 inline-flex rounded-md shadow-sm -space-x-px`},Ze=[`disabled`],Qe=[`disabled`];var K=w({__name:`IndexPage`,emits:[`create`,`edit`],setup(r,{expose:a,emit:d}){u();let m=k(),v=U(),x=d,w=P(!1),O=P(!1),j=P(null),R=P(null),W=P(null),K=P(!1),q=N({search:``,is_active:``,per_page:15,sort_by:``,sort_direction:`asc`,page:1}),J=P({title:``,message:``,buttonText:``,loadingText:``,buttonClass:``,action:``}),Y=g(()=>v.departments),X=g(()=>v.pagination),$e=g(()=>v.loading),et=g(()=>[{key:`name`,label:`Department Name`,type:`text`},{key:`description`,label:`Description`,type:`text`,fallback:`No description`},{key:`is_active`,label:`Status`,type:`status`},{key:`created_by.name`,label:`Created By`,type:`text`,subKey:`created_at`},{key:`updated_by.name`,label:`Last Updated By`,type:`text`,subKey:`updated_at`}]);A(()=>({...q}),e=>{let{page:t,...n}=e;v.updateFilters(n)},{deep:!0});let Z=async(e=1)=>{try{let t={...q,page:e};await v.fetchDepartments(t)}catch{m.error(`Failed to load departments`,{title:`Error`})}},tt=()=>{Z(q.page||1)},nt=()=>{R.value&&clearTimeout(R.value),R.value=setTimeout(()=>{Z(1)},300)},Q=e=>{q.sort_by===e?q.sort_direction=q.sort_direction===`asc`?`desc`:`asc`:(q.sort_by=e,q.sort_direction=`asc`),Z(1)},$=e=>{e>=1&&X.value&&e<=X.value.last_page&&(q.page=e,Z(e))},rt=e=>{W.value=e,K.value=!0},it=e=>{j.value=e,J.value={title:`Delete Department`,message:`Are you sure you want to delete "${e.name}"? This action can be undone from the trash.`,buttonText:`Delete`,loadingText:`Deleting...`,buttonClass:`w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`,action:`delete`},O.value=!0},at=async()=>{j.value&&(await v.deleteDepartment(j.value.id),ot())},ot=()=>{O.value=!1,j.value=null,J.value={title:``,message:``,buttonText:``,loadingText:``,buttonClass:``,action:``}},st=()=>{x(`create`)},ct=e=>{x(`edit`,e)};return ee(()=>{Z()}),a({refreshData:tt}),(r,a)=>(T(),b(`div`,re,[C(V,{title:`Departments`,description:`Manage company departments and organizational structure`,"create-button-text":`Create New Department`,onCreate:st}),_(`div`,ie,[_(`div`,ae,[_(`div`,oe,[a[12]||=_(`label`,{for:`search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Search Departments `,-1),_(`div`,se,[M(_(`input`,{id:`search`,"onUpdate:modelValue":a[0]||=e=>q.search=e,type:`text`,placeholder:`Search by name, code, or description...`,class:`block w-full px-3 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 sm:text-sm transition-colors duration-200`,onInput:nt},null,544),[[p,q.search]]),C(F(B),{class:`absolute left-3 top-2.5 h-5 w-5 text-gray-400`})])]),_(`div`,null,[a[14]||=_(`label`,{for:`status`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Status `,-1),M(_(`select`,{id:`status`,"onUpdate:modelValue":a[1]||=e=>q.is_active=e,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:Z},a[13]||=[_(`option`,{value:``},`All Status`,-1),_(`option`,{value:`true`},`Active`,-1),_(`option`,{value:`false`},`Inactive`,-1)],544),[[f,q.is_active]])]),_(`div`,null,[a[16]||=_(`label`,{for:`per-page`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Per Page `,-1),M(_(`select`,{id:`per-page`,"onUpdate:modelValue":a[2]||=e=>q.per_page=e,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:Z},a[15]||=[_(`option`,{value:15},`15`,-1),_(`option`,{value:25},`25`,-1),_(`option`,{value:50},`50`,-1),_(`option`,{value:100},`100`,-1)],544),[[f,q.per_page]])])])]),_(`div`,ce,[$e.value?(T(),b(`div`,le,[C(F(n),{class:`h-8 w-8 animate-spin mx-auto text-blue-600 dark:text-blue-400`}),a[17]||=_(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},`Loading departments...`,-1)])):Y.value.length===0?(T(),b(`div`,ue,[C(F(D),{class:`h-12 w-12 mx-auto text-gray-400`}),a[19]||=_(`h3`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},` No departments found `,-1),_(`p`,de,L(q.search?`Try adjusting your search criteria.`:`Get started by creating your first department.`),1),q.search?y(``,!0):(T(),b(`div`,fe,[_(`button`,{onClick:st,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors duration-200`},[C(F(e),{class:`h-5 w-5 mr-2`}),a[18]||=S(` Add Your First Department `,-1)])]))])):(T(),b(`div`,pe,[_(`table`,me,[_(`thead`,he,[_(`tr`,null,[_(`th`,ge,[_(`button`,{onClick:a[3]||=e=>Q(`name`),class:`flex items-center space-x-1 hover:text-gray-700 dark:hover:text-gray-100 transition-colors duration-200`},[a[20]||=_(`span`,null,`Department`,-1),_(`div`,_e,[C(F(o),{class:I([`h-3 w-3`,q.sort_by===`name`&&q.sort_direction===`asc`?`text-blue-600 dark:text-blue-400`:`text-gray-400`])},null,8,[`class`]),C(F(l),{class:I([`h-3 w-3 -mt-1`,q.sort_by===`name`&&q.sort_direction===`desc`?`text-blue-600 dark:text-blue-400`:`text-gray-400`])},null,8,[`class`])])])]),_(`th`,ve,[_(`button`,{onClick:a[4]||=e=>Q(`is_active`),class:`flex items-center space-x-1 hover:text-gray-700 dark:hover:text-gray-100 transition-colors duration-200`},[a[21]||=_(`span`,null,`Status`,-1),_(`div`,ye,[C(F(o),{class:I([`h-3 w-3`,q.sort_by===`is_active`&&q.sort_direction===`asc`?`text-blue-600 dark:text-blue-400`:`text-gray-400`])},null,8,[`class`]),C(F(l),{class:I([`h-3 w-3 -mt-1`,q.sort_by===`is_active`&&q.sort_direction===`desc`?`text-blue-600 dark:text-blue-400`:`text-gray-400`])},null,8,[`class`])])])]),_(`th`,be,[_(`button`,{onClick:a[5]||=e=>Q(`created_at`),class:`flex items-center space-x-1 hover:text-gray-700 dark:hover:text-gray-100 transition-colors duration-200`},[a[22]||=_(`span`,null,`Created`,-1),_(`div`,xe,[C(F(o),{class:I([`h-3 w-3`,q.sort_by===`created_at`&&q.sort_direction===`asc`?`text-blue-600 dark:text-blue-400`:`text-gray-400`])},null,8,[`class`]),C(F(l),{class:I([`h-3 w-3 -mt-1`,q.sort_by===`created_at`&&q.sort_direction===`desc`?`text-blue-600 dark:text-blue-400`:`text-gray-400`])},null,8,[`class`])])])]),a[23]||=_(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Actions `,-1)])]),_(`tbody`,Se,[(T(!0),b(h,null,E(Y.value,e=>(T(),b(`tr`,{key:e.id,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[_(`td`,Ce,[_(`div`,we,[_(`div`,Te,[_(`div`,Ee,[C(F(D),{class:`h-5 w-5 text-blue-600 dark:text-blue-400`})])]),_(`div`,De,[_(`div`,Oe,L(e.name),1),_(`div`,ke,L(e.description||`No description`),1)])])]),_(`td`,Ae,[C(ne,{active:e.is_active},null,8,[`active`])]),_(`td`,je,[_(`div`,Me,[_(`div`,Ne,L(e.created_by?.name||`-`),1),_(`div`,Pe,L(F(H)(e.created_at)),1)])]),_(`td`,Fe,[_(`div`,Ie,[_(`button`,{onClick:t=>rt(e),class:`text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 transition-colors duration-200`,title:`View details`},[C(F(i),{class:`w-4 h-4`})],8,Le),_(`button`,{onClick:t=>ct(e),class:`text-indigo-600 dark:text-indigo-400 hover:text-indigo-900 dark:hover:text-indigo-300 transition-colors duration-200`,title:`Edit Department`},[C(F(t),{class:`h-4 w-4`})],8,Re),_(`button`,{onClick:t=>it(e),class:`text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300 transition-colors duration-200`,title:`Delete Department`},[C(F(z),{class:`h-4 w-4`})],8,ze)])])]))),128))])])])),X.value&&X.value.total>0?(T(),b(`div`,Be,[_(`div`,Ve,[_(`div`,He,[_(`button`,{onClick:a[6]||=e=>$(X.value.current_page-1),disabled:X.value.current_page<=1,class:`relative inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},` Previous `,8,Ue),_(`button`,{onClick:a[7]||=e=>$(X.value.current_page+1),disabled:X.value.current_page>=X.value.last_page,class:`ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},` Next `,8,We)]),_(`div`,Ge,[_(`div`,null,[_(`p`,Ke,[a[24]||=S(` Showing `,-1),_(`span`,qe,L(X.value.from),1),a[25]||=S(` to `,-1),_(`span`,Je,L(X.value.to),1),a[26]||=S(` of `,-1),_(`span`,Ye,L(X.value.total),1),a[27]||=S(` results `,-1)])]),_(`div`,null,[_(`nav`,Xe,[_(`button`,{onClick:a[8]||=e=>$(X.value.current_page-1),disabled:X.value.current_page<=1,class:`relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm font-medium text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},[C(F(c),{class:`h-5 w-5`})],8,Ze),_(`button`,{onClick:a[9]||=e=>$(X.value.current_page+1),disabled:X.value.current_page>=X.value.last_page,class:`relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm font-medium text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},[C(F(s),{class:`h-5 w-5`})],8,Qe)])])])])])):y(``,!0)]),C(te,{show:O.value,"onUpdate:show":a[10]||=e=>O.value=e,type:`delete`,title:J.value.title,message:J.value.message,"confirm-text":J.value.buttonText,"loading-text":J.value.loadingText,loading:w.value,onConfirm:at,onCancel:ot},null,8,[`show`,`title`,`message`,`confirm-text`,`loading-text`,`loading`]),C(G,{show:K.value,"onUpdate:show":a[11]||=e=>K.value=e,item:W.value,title:`Department Details`,"display-fields":et.value,size:`lg`},null,8,[`show`,`item`,`display-fields`])]))}}),q=K;function J(){let e=P({}),t=g(()=>Object.keys(e.value).length>0),n=t=>e.value[t]?.[0],r=n=>{let r={};return!n.name||n.name.trim().length===0?r.name=[`Department name is required`]:n.name.trim().length>255&&(r.name=[`Department name must not exceed 255 characters`]),n.code!==void 0&&n.code!==null&&n.code.trim().length>0&&(n.code.trim().length>10?r.code=[`Department code must not exceed 10 characters`]:/^[A-Z0-9_-]+$/.test(n.code.trim())||(r.code=[`Department code must contain only uppercase letters, numbers, underscores, and hyphens`])),n.description!==void 0&&n.description!==null&&n.description.trim().length>0&&n.description.trim().length>1e3&&(r.description=[`Department description must not exceed 1000 characters`]),n.parent_id!==void 0&&n.parent_id!==null&&(typeof n.parent_id!=`number`||n.parent_id<=0)&&(r.parent_id=[`Parent department must be a valid department`]),n.is_active!==void 0&&typeof n.is_active!=`boolean`&&(r.is_active=[`Status must be either active or inactive`]),e.value=r,!t.value},i=n=>{let r={};return n.name!==void 0&&(!n.name||n.name.trim().length===0?r.name=[`Department name is required`]:n.name.trim().length>255&&(r.name=[`Department name must not exceed 255 characters`])),n.code!==void 0&&n.code!==null&&n.code.trim().length>0&&(n.code.trim().length>10?r.code=[`Department code must not exceed 10 characters`]:/^[A-Z0-9_-]+$/.test(n.code.trim())||(r.code=[`Department code must contain only uppercase letters, numbers, underscores, and hyphens`])),n.description!==void 0&&n.description!==null&&n.description.trim().length>0&&n.description.trim().length>1e3&&(r.description=[`Department description must not exceed 1000 characters`]),n.parent_id!==void 0&&n.parent_id!==null&&(typeof n.parent_id!=`number`||n.parent_id<=0)&&(r.parent_id=[`Parent department must be a valid department`]),n.is_active!==void 0&&typeof n.is_active!=`boolean`&&(r.is_active=[`Status must be either active or inactive`]),e.value=r,!t.value},a=()=>{e.value={}},o=t=>{e.value[t]&&delete e.value[t]},s=t=>{e.value=t};return{errors:e,hasErrors:t,getFieldError:n,validateCreateRequest:r,validateUpdateRequest:i,clearErrors:a,clearFieldError:o,setServerErrors:s}}const Y={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8`},X={class:`max-w-4xl mx-auto`},$e={class:`mb-8`},et={class:`flex items-center space-x-4 mb-2`},Z={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},tt={class:`px-6 py-8`},nt={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},Q={class:`md:col-span-2`},$={key:0,class:`mt-1 text-xs text-gray-500`},rt={class:`md:col-span-2`},it={class:`flex items-start`},at={class:`flex items-center h-5`},ot=[`disabled`],st=[`disabled`],ct={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},lt={key:1,class:`mt-1 text-xs text-gray-500`},ut={key:0,class:`p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg`},dt={class:`space-y-2`},ft={class:`text-sm text-blue-700 dark:text-blue-400`},pt={key:0,class:`text-sm text-blue-700 dark:text-blue-400`},mt={class:`text-sm text-blue-700 dark:text-blue-400`},ht={key:1,class:`text-sm text-blue-700 dark:text-blue-400`},gt={class:`text-sm text-blue-700 dark:text-blue-400`},_t={class:`flex flex-col sm:flex-row sm:justify-end space-y-3 sm:space-y-0 sm:space-x-3 pt-6 border-t border-gray-200 dark:border-gray-700`},vt=[`disabled`],yt=[`disabled`],bt={key:0,class:`flex items-center justify-center`},xt={key:1},St={class:`mt-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4`},Ct={class:`flex`},wt={class:`flex-shrink-0`};var Tt=w({__name:`CreatePage`,emits:[`back`,`success`,`cancel`],setup(e,{emit:t}){let n=t,i=U(),{errors:a,hasErrors:o,getFieldError:s,validateCreateRequest:c,clearFieldError:l,setServerErrors:u,clearErrors:f}=J(),h=P(!1),v=P(!1),w=P([]),E=P({name:``,code:``,description:``,is_active:!0,parent_id:void 0}),D=g(()=>E.value.name.trim().length>0&&E.value.name.length<=255&&(!E.value.code||E.value.code.length<=10&&/^[A-Z0-9_-]+$/.test(E.value.code))&&(!E.value.description||E.value.description.length<=1e3)),k=g(()=>E.value.parent_id&&w.value.find(e=>e.id===E.value.parent_id)||null),A=async()=>{try{v.value=!0,await i.fetchDepartments({is_active:!0,per_page:1e3,sort_by:`name`,sort_direction:`asc`}),w.value=i.departments}catch(e){console.error(`Failed to fetch parent departments:`,e)}finally{v.value=!1}},j=()=>{E.value={name:``,code:``,description:``,is_active:!0,parent_id:void 0},f()},N=async()=>{if(f(),c(E.value))try{h.value=!0;let e={name:E.value.name.trim(),is_active:E.value.is_active,...E.value.code&&{code:E.value.code.trim()},description:E.value.description?.trim()??``,...E.value.parent_id&&{parent_id:E.value.parent_id}};await i.createDepartment(e),j(),n(`success`)}catch(e){e.response?.status===422&&e.response?.data?.errors&&u(e.response.data.errors)}finally{h.value=!1}},z=()=>{j(),n(`cancel`)},B=()=>{n(`back`)};return ee(()=>{j(),A()}),(e,t)=>(T(),b(`div`,Y,[_(`div`,X,[_(`div`,$e,[_(`div`,et,[_(`button`,{onClick:B,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[C(F(O),{class:`w-5 h-5`})]),t[5]||=_(`div`,null,[_(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},` Create Department `),_(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},` Add a new department to the organization `)],-1)])]),_(`div`,Z,[_(`div`,tt,[_(`form`,{onSubmit:m(N,[`prevent`]),class:`space-y-8`},[_(`div`,null,[t[7]||=_(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-gray-100 mb-4`},` Basic Information `,-1),_(`div`,nt,[_(`div`,Q,[C(R,{type:`text`,maxlength:255,disabled:h.value,onBlur:t[0]||=()=>F(l)(`name`),modelValue:E.value.name,"onUpdate:modelValue":t[1]||=e=>E.value.name=e,placeholder:`Enter department name (e.g., Human Resources)`,error:F(s)(`name`),required:``,label:`Department Name`},null,8,[`disabled`,`modelValue`,`error`]),E.value.name.length>0?(T(),b(`p`,$,L(E.value.name.length)+`/255 characters `,1)):y(``,!0)]),_(`div`,rt,[_(`div`,it,[_(`div`,at,[M(_(`input`,{id:`is_active`,"onUpdate:modelValue":t[2]||=e=>E.value.is_active=e,type:`checkbox`,disabled:h.value,class:`h-4 w-4 text-indigo-600 focus:ring-indigo-600 border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800`},null,8,ot),[[d,E.value.is_active]])]),t[6]||=_(`div`,{class:`ml-3`},[_(`label`,{for:`is_active`,class:`text-sm font-medium text-gray-700 dark:text-gray-300`},` Active `),_(`p`,{class:`text-xs text-gray-500 dark:text-gray-400`},` When enabled, this department will be available for selection `)],-1)])])])]),_(`div`,null,[t[9]||=_(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-gray-100 mb-4`},` Description `,-1),_(`div`,null,[t[8]||=_(`label`,{class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Department Description `,-1),M(_(`textarea`,{"onUpdate:modelValue":t[3]||=e=>E.value.description=e,disabled:h.value,maxlength:1e3,rows:`4`,placeholder:`Enter department description and responsibilities (optional)`,class:I([`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500`,F(s)(`description`)?`border-red-300 text-red-900`:`border-gray-300 dark:border-gray-600`,`bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100`]),onBlur:t[4]||=()=>F(l)(`description`)},null,42,st),[[p,E.value.description]]),F(s)(`description`)?(T(),b(`p`,ct,L(F(s)(`description`)),1)):y(``,!0),E.value.description&&E.value.description.length>0?(T(),b(`p`,lt,L(E.value.description.length)+`/1000 characters `,1)):y(``,!0)])]),E.value.name?(T(),b(`div`,ut,[t[15]||=_(`h4`,{class:`text-sm font-medium text-blue-800 dark:text-blue-300 mb-2`},`Department Preview`,-1),_(`div`,dt,[_(`p`,ft,[t[10]||=_(`strong`,null,`Name:`,-1),S(` `+L(E.value.name),1)]),E.value.code?(T(),b(`p`,pt,[t[11]||=_(`strong`,null,`Code:`,-1),S(` `+L(E.value.code),1)])):y(``,!0),_(`p`,mt,[t[12]||=_(`strong`,null,`Type:`,-1),S(` `+L(k.value?`Sub-department of ${k.value.name}`:`Root Department`),1)]),E.value.description?(T(),b(`p`,ht,[t[13]||=_(`strong`,null,`Description:`,-1),S(` `+L(E.value.description),1)])):y(``,!0),_(`p`,gt,[t[14]||=_(`strong`,null,`Status:`,-1),_(`span`,{class:I(E.value.is_active?`text-green-600 dark:text-green-400`:`text-red-600 dark:text-red-400`)},L(E.value.is_active?`Active`:`Inactive`),3)])])])):y(``,!0),_(`div`,_t,[_(`button`,{type:`button`,onClick:z,disabled:h.value,class:`w-full sm:w-auto px-6 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors`},` Cancel `,8,vt),_(`button`,{type:`submit`,disabled:h.value||F(o)||!D.value,class:`w-full sm:w-auto px-6 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors`},[h.value?(T(),b(`div`,bt,t[16]||=[_(`div`,{class:`animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2`},null,-1),S(` Creating... `,-1)])):(T(),b(`span`,xt,`Create Department`))],8,yt)])],32)])]),_(`div`,St,[_(`div`,Ct,[_(`div`,wt,[C(F(r),{class:`h-5 w-5 text-blue-400`})]),t[17]||=x(`<div class="ml-3"><h3 class="text-sm font-medium text-blue-800 dark:text-blue-300"> About Departments </h3><div class="mt-2 text-sm text-blue-700 dark:text-blue-400"><p class="mb-2"> Departments are used to organize employees and define organizational structure: </p><ul class="list-disc list-inside space-y-1"><li><strong>Name:</strong> Full department name (e.g., &quot;Human Resources&quot;)</li><li><strong>Code:</strong> Short identifier for the department (e.g., &quot;HR&quot;, &quot;IT&quot;)</li><li><strong>Parent:</strong> Create hierarchical structure by selecting a parent department</li><li><strong>Description:</strong> Additional details about the department&#39;s role</li><li><strong>Status:</strong> Active departments appear in employee assignment lists</li></ul></div></div>`,1)])])])]))}}),Et=Tt;const Dt={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8`},Ot={class:`max-w-4xl mx-auto`},kt={class:`mb-8`},At={class:`flex items-center space-x-4 mb-2`},jt={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg p-8`},Mt={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},Nt={class:`px-6 py-8`},Pt={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},Ft={class:`md:col-span-2`},It={key:0,class:`mt-1 text-xs text-gray-500`},Lt={class:`md:col-span-2`},Rt={class:`flex items-start`},zt={class:`flex items-center h-5`},Bt=[`disabled`],Vt=[`disabled`],Ht={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},Ut={key:1,class:`mt-1 text-xs text-gray-500`},Wt={key:0,class:`p-4 bg-gray-50 dark:bg-gray-700 rounded-lg`},Gt={class:`text-sm text-gray-600 dark:text-gray-400`},Kt={key:0},qt={class:`text-gray-900 dark:text-gray-100`},Jt={key:1},Yt={key:1,class:`p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg`},Xt={class:`space-y-2`},Zt={class:`text-sm text-blue-700 dark:text-blue-400`},Qt={key:0,class:`text-sm text-blue-700 dark:text-blue-400`},$t={class:`text-sm text-blue-700 dark:text-blue-400`},en={key:1,class:`text-sm text-blue-700 dark:text-blue-400`},tn={class:`text-sm text-blue-700 dark:text-blue-400`},nn={class:`flex flex-col sm:flex-row sm:justify-end space-y-3 sm:space-y-0 sm:space-x-3 pt-6 border-t border-gray-200 dark:border-gray-700`},rn=[`disabled`],an=[`disabled`],on={key:0,class:`flex items-center justify-center`},sn={key:1},cn={key:2,class:`bg-white dark:bg-gray-800 shadow rounded-lg p-8`},ln={class:`flex flex-col items-center`},un={key:3,class:`mt-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4`},dn={class:`flex`},fn={class:`flex-shrink-0`};var pn=w({__name:`EditPage`,props:{id:{},department:{}},emits:[`back`,`success`,`cancel`],setup(e,{emit:t}){let n=e,i=t,o=U(),{errors:s,hasErrors:c,getFieldError:l,validateUpdateRequest:u,clearFieldError:f,setServerErrors:h,clearErrors:v}=J(),w=P(!1),E=P(!1),D=P(!1),k=P([]),j=P(null),N=P({name:``,code:``,description:``,is_active:!0,parent_id:void 0}),z=P({name:``,code:``,description:``,is_active:!0,parent_id:void 0}),B=g(()=>N.value.name.trim().length>0&&N.value.name.length<=255&&(!N.value.code||N.value.code.length<=10&&/^[A-Z0-9_-]+$/.test(N.value.code))&&(!N.value.description||N.value.description.length<=1e3)),V=g(()=>N.value.parent_id&&k.value.find(e=>e.id===N.value.parent_id)||null);g(()=>{if(!j.value)return k.value;let e=new Set([j.value.id]),t=n=>{n.children&&n.children.forEach(n=>{e.add(n.id),t(n)})};return t(j.value),k.value.filter(t=>!e.has(t.id))});let te=async()=>{try{D.value=!0,await o.fetchDepartments({is_active:!0,per_page:1e3,sort_by:`name`,sort_direction:`asc`}),k.value=o.departments}catch(e){console.error(`Failed to fetch parent departments:`,e)}finally{D.value=!1}},H=async()=>{try{E.value=!0;let e=n.department||await o.fetchDepartment(n.id);e&&(j.value=e,N.value={name:e.name,code:e.code||``,description:e.description||``,is_active:e.is_active,parent_id:e.parent_id||void 0},z.value={name:e.name,code:e.code||``,description:e.description||``,is_active:e.is_active,parent_id:e.parent_id||void 0},v())}catch(e){console.error(`Error loading department:`,e)}finally{E.value=!1}},ne=async()=>{if(v(),u(N.value))try{w.value=!0;let e={name:N.value.name.trim(),is_active:N.value.is_active,...N.value.code&&{code:N.value.code.trim()},description:N.value.description?.trim()??``,...N.value.parent_id&&{parent_id:N.value.parent_id}};N.value.parent_id||(e.parent_id=null),await o.updateDepartment(n.id,e),z.value={...N.value},i(`success`)}catch(e){e.response?.status===422&&e.response?.data?.errors&&h(e.response.data.errors)}finally{w.value=!1}},W=()=>{i(`cancel`)},G=()=>{i(`back`)};return ee(()=>{Promise.all([H(),te()])}),A(()=>n.id,()=>{n.id&&H()}),(e,t)=>(T(),b(`div`,Dt,[_(`div`,Ot,[_(`div`,kt,[_(`div`,At,[_(`button`,{onClick:G,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[C(F(O),{class:`w-5 h-5`})]),t[5]||=_(`div`,null,[_(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},` Edit Department `),_(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},` Update department information and settings `)],-1)])]),E.value?(T(),b(`div`,jt,t[6]||=[_(`div`,{class:`flex items-center justify-center`},[_(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mr-4`}),_(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading department...`)],-1)])):N.value?(T(),b(`div`,Mt,[_(`div`,Nt,[_(`form`,{onSubmit:m(ne,[`prevent`]),class:`space-y-8`},[_(`div`,null,[t[8]||=_(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-gray-100 mb-4`},` Basic Information `,-1),_(`div`,Pt,[_(`div`,Ft,[C(R,{type:`text`,maxlength:255,disabled:w.value,onBlur:t[0]||=()=>F(f)(`name`),modelValue:N.value.name,"onUpdate:modelValue":t[1]||=e=>N.value.name=e,placeholder:`Enter department name (e.g., Human Resources)`,error:F(l)(`name`),required:``,label:`Department Name`},null,8,[`disabled`,`modelValue`,`error`]),N.value.name.length>0?(T(),b(`p`,It,L(N.value.name.length)+`/255 characters `,1)):y(``,!0)]),_(`div`,Lt,[_(`div`,Rt,[_(`div`,zt,[M(_(`input`,{id:`is_active`,"onUpdate:modelValue":t[2]||=e=>N.value.is_active=e,type:`checkbox`,disabled:w.value,class:`h-4 w-4 text-indigo-600 focus:ring-indigo-600 border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800`},null,8,Bt),[[d,N.value.is_active]])]),t[7]||=_(`div`,{class:`ml-3`},[_(`label`,{for:`is_active`,class:`text-sm font-medium text-gray-700 dark:text-gray-300`},` Active `),_(`p`,{class:`text-xs text-gray-500 dark:text-gray-400`},` When enabled, this department will be available for selection `)],-1)])])])]),_(`div`,null,[t[10]||=_(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-gray-100 mb-4`},` Description `,-1),_(`div`,null,[t[9]||=_(`label`,{class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Department Description `,-1),M(_(`textarea`,{"onUpdate:modelValue":t[3]||=e=>N.value.description=e,disabled:w.value,maxlength:1e3,rows:`4`,placeholder:`Enter department description and responsibilities (optional)`,class:I([`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500`,F(l)(`description`)?`border-red-300 text-red-900`:`border-gray-300 dark:border-gray-600`,`bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100`]),onBlur:t[4]||=()=>F(f)(`description`)},null,42,Vt),[[p,N.value.description]]),F(l)(`description`)?(T(),b(`p`,Ht,L(F(l)(`description`)),1)):y(``,!0),N.value.description&&N.value.description.length>0?(T(),b(`p`,Ut,L(N.value.description.length)+`/1000 characters `,1)):y(``,!0)])]),j.value?(T(),b(`div`,Wt,[t[11]||=_(`h4`,{class:`text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},`Current Department Hierarchy`,-1),_(`div`,Gt,[j.value.parent?(T(),b(`span`,Kt,L(j.value.parent.name)+` → `,1)):y(``,!0),_(`strong`,qt,L(j.value.name),1),j.value.children&&j.value.children.length>0?(T(),b(`span`,Jt,` → `+L(j.value.children.length)+` sub-department`+L(j.value.children.length===1?``:`s`),1)):y(``,!0)])])):y(``,!0),N.value.name?(T(),b(`div`,Yt,[t[17]||=_(`h4`,{class:`text-sm font-medium text-blue-800 dark:text-blue-300 mb-2`},`Department Preview`,-1),_(`div`,Xt,[_(`p`,Zt,[t[12]||=_(`strong`,null,`Name:`,-1),S(` `+L(N.value.name),1)]),N.value.code?(T(),b(`p`,Qt,[t[13]||=_(`strong`,null,`Code:`,-1),S(` `+L(N.value.code),1)])):y(``,!0),_(`p`,$t,[t[14]||=_(`strong`,null,`Type:`,-1),S(` `+L(V.value?`Sub-department of ${V.value.name}`:`Root Department`),1)]),N.value.description?(T(),b(`p`,en,[t[15]||=_(`strong`,null,`Description:`,-1),S(` `+L(N.value.description),1)])):y(``,!0),_(`p`,tn,[t[16]||=_(`strong`,null,`Status:`,-1),_(`span`,{class:I(N.value.is_active?`text-green-600 dark:text-green-400`:`text-red-600 dark:text-red-400`)},L(N.value.is_active?`Active`:`Inactive`),3)])])])):y(``,!0),_(`div`,nn,[_(`button`,{type:`button`,onClick:W,disabled:w.value,class:`w-full sm:w-auto px-6 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors`},` Cancel `,8,rn),_(`button`,{type:`submit`,disabled:w.value||F(c)||!B.value,class:`w-full sm:w-auto px-6 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors`},[w.value?(T(),b(`div`,on,t[18]||=[_(`div`,{class:`animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2`},null,-1),S(` Updating... `,-1)])):(T(),b(`span`,sn,`Update Department`))],8,an)])],32)])])):(T(),b(`div`,cn,[_(`div`,ln,[C(F(a),{class:`w-12 h-12 text-red-400 mb-4`}),t[19]||=_(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-gray-100 mb-2`},` Department Not Found `,-1),t[20]||=_(`p`,{class:`text-gray-500 dark:text-gray-400 mb-6`},` The department you're trying to edit could not be found. `,-1),_(`button`,{onClick:G,class:`px-4 py-2 text-sm font-medium text-indigo-600 dark:text-indigo-400 hover:text-indigo-900 dark:hover:text-indigo-300`},` ← Back to Departments `)])])),N.value?(T(),b(`div`,un,[_(`div`,dn,[_(`div`,fn,[C(F(r),{class:`h-5 w-5 text-blue-400`})]),t[21]||=x(`<div class="ml-3"><h3 class="text-sm font-medium text-blue-800 dark:text-blue-300"> Editing Department Information </h3><div class="mt-2 text-sm text-blue-700 dark:text-blue-400"><p class="mb-2"> Update department details carefully as this information affects: </p><ul class="list-disc list-inside space-y-1"><li>Employee assignment and organizational charts</li><li>Department hierarchies and reporting structure</li><li>Access permissions and role assignments</li><li>Reporting and analytics groupings</li></ul><p class="mt-2 text-xs"><strong>Note:</strong> Changing the parent department will affect the organizational hierarchy. </p></div></div>`,1)])])):y(``,!0)])]))}}),mn=pn;const hn={class:`min-h-screen`};var gn=w({__name:`TabPage`,setup(e){let t=P([{id:`departments`,label:`Departments`,icon:{type:`lucide`,name:`building-2`},color:`blue`}]),n=P(`departments`),r=P(`departmentindex`),i=P(null),a=P(),o={departments:{index:`departmentindex`,create:`departmentcreate`,edit:`departmentedit`}},s=e=>{let t=o[e];t&&(r.value=t.create)},c=(e,t)=>{let n=o[e];n&&(i.value={type:e,id:t.id,data:t},r.value=n.edit)},l=e=>{let t=o[e];t&&(r.value=t.index,i.value=null)},u=e=>{let t=o[e];if(t){r.value=t.index,i.value=null;let n={departments:a},o=n[e];o?.value?.refreshData&&o.value.refreshData()}},d=(e,t)=>{n.value=e;let a={departments:`departmentindex`},o=a[e];o&&(r.value=o,i.value=null),console.log(`Switched to tab: ${e}`,t)};return(e,n)=>(T(),b(`div`,hn,[C(W,{title:``,tabs:t.value,"default-tab":`departments`,onTabChange:d},{departments:j(()=>[r.value===`departmentindex`?(T(),v(q,{key:0,onCreate:n[0]||=e=>s(`departments`),onEdit:n[1]||=e=>c(`departments`,e),ref_key:`departmentIndexRef`,ref:a},null,512)):y(``,!0),r.value===`departmentcreate`?(T(),v(Et,{key:1,onBack:n[2]||=e=>l(`departments`),onSuccess:n[3]||=e=>u(`departments`),onCancel:n[4]||=e=>l(`departments`)})):y(``,!0),r.value===`departmentedit`?(T(),v(mn,{key:2,onBack:n[5]||=e=>l(`departments`),onSuccess:n[6]||=e=>u(`departments`),onCancel:n[7]||=e=>l(`departments`),id:i.value.id,department:i.value.data},null,8,[`id`,`department`])):y(``,!0)]),_:1},8,[`tabs`])]))}}),_n=gn;export{_n as default};
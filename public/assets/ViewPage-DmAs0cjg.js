import{L as e,a1 as t,a7 as n,aD as r,aE as i,aO as ee,aP as a,aR as o,aS as s,aT as c,aU as l,aV as u,aX as d,aY as f,aZ as te,al as ne,b0 as re,b2 as p,b3 as ie,b5 as ae,b9 as m,bc as h,bd as g,bg as _,v as oe}from"./index-t4abR9zw.js";import{b as se}from"./useAuth-CGkvpNr1.js";import"./GlobalConfig-wPgXFcZ5.js";import{c as v,d as y,f as b}from"./common-CZbH6H1Z.js";import"./tableUtils-dXs1kjAL.js";import"./Modal-YeKx3Yre.js";import"./StatusBadge-CCvLFYg0.js";import{b as x,d as S}from"./currencyUtil-2Kp5H1rX.js";import{b as C}from"./DataItems-vRbDVmOU.js";import{b as w}from"./CustomerReturnMarkReceived-DDks9NU9.js";import{b as T}from"./customerReturnOrdersStore-DJlXeq10.js";import{b as E}from"./CustomerReturnApprove-CFZavErU.js";const D={class:`max-w-7xl mx-auto sm:px-6 lg:px-8 py-6`},O={class:`mb-6`},k={class:`flex items-center justify-between`},A={key:0,class:`mt-1 text-sm text-gray-600 dark:text-gray-400`},j={class:`flex items-center space-x-3`},M={key:0,class:`flex justify-center items-center py-8`},N={key:1,class:`space-y-6`},P={class:`flex items-center space-x-3`},F={key:0,class:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200`},I={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},L={class:`px-6 py-4`},R={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2 lg:grid-cols-3`},z={class:`text-sm text-gray-900 dark:text-white font-mono`},B={key:0,class:`mt-6`},V={class:`text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded-md`},H={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},U={class:`px-6 py-4`},W={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2`},G={key:0,class:`mt-6`},K={class:`text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded-md`},ce={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},le={class:`px-6 py-4`},ue={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2`},de={key:0,class:`mt-6`},fe={class:`text-sm text-gray-900 dark:text-white bg-gray-50 dark:bg-gray-700 p-3 rounded-md`},pe={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},me={class:`overflow-x-auto`},he={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},ge={class:`bg-gray-50 dark:bg-gray-900`},_e={key:0,class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},ve={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},ye={class:`px-6 py-4 whitespace-nowrap`},be={class:`flex items-center`},xe={class:`flex-shrink-0 h-10 w-10`},Se=[`src`,`alt`],Ce={key:1,class:`h-10 w-10 rounded bg-gray-200 dark:bg-gray-600 flex items-center justify-center`},we={class:`ml-4`},Te={class:`text-sm font-medium text-gray-900 dark:text-white`},Ee={class:`text-sm text-gray-500 dark:text-gray-400`},De={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},Oe=[`onClick`],ke={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},Ae={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},je={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},Me={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},Ne={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},Pe={class:`px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900 dark:text-white`},Fe={key:0,class:`px-6 py-4 whitespace-nowrap text-right text-sm font-medium text-gray-900 dark:text-white`},Ie={class:`px-6 py-4 text-right`},Le={key:0,class:`px-6 py-4 text-right`},Re={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},ze={class:`px-6 py-4`},Be={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2 lg:grid-cols-4`};var q=te({__name:`ViewPage`,setup(te){let q=r(),J=i(),Ve=T(),{isAdmin:He,isWarehouseManager:Ue,hasAnyRole:We}=se(),Y=h(null),X=h(!0),Z=h(!1),Q=h(!1),$=o(()=>We([`admin`,`salesman`])),Ge=o(()=>!0),Ke=async()=>{try{X.value=!0;let e=parseInt(q.params.id);Y.value=await Ve.fetchReturnOrder(e)}catch(e){console.error(`Error fetching return order:`,e),J.push({name:`customer.return-orders.index`})}finally{X.value=!1}},qe=e=>{let t=J.resolve({name:`sales.show`,params:{id:e.toString()}});window.open(t.href,`_blank`)},Je=e=>{Y.value=e,Z.value=!1},Ye=e=>{Y.value=e,Q.value=!1};return re(()=>{Ke()}),(r,i)=>{let o=ae(`router-link`);return p(),u(`div`,D,[s(`div`,O,[s(`div`,k,[s(`div`,null,[i[4]||=s(`h1`,{class:`text-2xl font-semibold text-gray-900 dark:text-white`},`Return Order Details`,-1),Y.value?(p(),u(`p`,A,_(Y.value.return_code)+` " `+_(g(v)(Y.value.date)),1)):l(``,!0)]),s(`div`,j,[Y.value&&!Y.value.is_approved&&$.value?(p(),c(o,{key:0,to:{name:`customer.return-orders.edit`,params:{id:Y.value?.id}},class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`},{default:m(()=>[f(g(oe),{class:`h-4 w-4 mr-2`}),i[5]||=d(` Edit `,-1)]),_:1,__:[5]},8,[`to`])):l(``,!0),Y.value&&Y.value.is_pending&&g(He)?(p(),u(`button`,{key:1,onClick:i[0]||=e=>Z.value=!0,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500`},[f(g(n),{class:`h-4 w-4 mr-2`}),i[6]||=d(` Approve `,-1)])):l(``,!0),Y.value&&Y.value.is_approved&&!Y.value.is_received&&Ge.value?(p(),u(`button`,{key:2,onClick:i[1]||=e=>Q.value=!0,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500`},[f(g(t),{class:`h-4 w-4 mr-2`}),i[7]||=d(` Mark as Received `,-1)])):l(``,!0),f(o,{to:{name:`customer.return-orders.index`},class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600`},{default:m(()=>[f(g(ne),{class:`h-4 w-4 mr-2`}),i[8]||=d(` Back to List `,-1)]),_:1,__:[8]})])])]),X.value?(p(),u(`div`,M,i[9]||=[s(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600`},null,-1)])):Y.value?(p(),u(`div`,N,[s(`div`,P,[Y.value.is_received?(p(),u(`span`,F,[f(g(n),{class:`h-4 w-4 mr-1`}),i[10]||=d(` Received `,-1)])):l(``,!0)]),s(`div`,I,[i[11]||=s(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[s(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Return Order Information`)],-1),s(`div`,L,[s(`div`,R,[f(C,{label:`Return Code`},{default:m(()=>[s(`div`,z,_(Y.value.return_code),1)]),_:1}),f(C,{label:`Date`,value:g(v)(Y.value.date)},null,8,[`value`]),f(C,{label:`Customer`,value:Y.value.customer?.name},null,8,[`value`]),f(C,{label:`Salesperson`,value:Y.value.salesperson?.name},null,8,[`value`]),f(C,{label:`Warehouse`,value:Y.value.warehouse?.name},null,8,[`value`]),f(C,{label:`Currency`,value:Y.value.currency?.code},null,8,[`value`]),Y.value.currency_rate&&!g(S)(Y.value.currency.code)?(p(),c(C,{key:0,label:`Exchange Rate`,value:Y.value.currency_rate},null,8,[`value`])):l(``,!0)]),Y.value.note?(p(),u(`div`,B,[f(C,{label:`Note`},{default:m(()=>[s(`div`,V,_(Y.value.note),1)]),_:1})])):l(``,!0)])]),Y.value.is_approved?(p(),u(`div`,H,[i[12]||=s(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[s(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Approval Information`)],-1),s(`div`,U,[s(`div`,W,[f(C,{label:`Approved By`,value:Y.value.approved_by_user?.name},null,8,[`value`]),f(C,{label:`Approved At`,value:g(y)(Y.value.approved_at)},null,8,[`value`])]),Y.value.approve_note?(p(),u(`div`,G,[f(C,{label:`Approval Note`},{default:m(()=>[s(`div`,K,_(Y.value.approve_note),1)]),_:1})])):l(``,!0)])])):l(``,!0),Y.value.is_received?(p(),u(`div`,ce,[i[13]||=s(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[s(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Receipt Information`)],-1),s(`div`,le,[s(`div`,ue,[f(C,{label:`Received By`,value:Y.value.return_received_by_user?.name},null,8,[`value`]),f(C,{label:`Received At`,value:g(y)(Y.value.return_received_at)},null,8,[`value`])]),Y.value.return_received_note?(p(),u(`div`,de,[f(C,{label:`Receipt Note`},{default:m(()=>[s(`div`,fe,_(Y.value.return_received_note),1)]),_:1})])):l(``,!0)])])):l(``,!0),s(`div`,pe,[i[24]||=s(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[s(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Return Items`)],-1),s(`div`,me,[s(`table`,he,[s(`thead`,ge,[s(`tr`,null,[i[14]||=s(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`item`,-1),i[15]||=s(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Return from`,-1),i[16]||=s(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Quantity`,-1),i[17]||=s(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Unit Price`,-1),i[18]||=s(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},[s(`abbr`,{title:`Discount %`},`Dis %`)],-1),i[19]||=s(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},[s(`abbr`,{title:`Tax %`},`TAX %`)],-1),i[20]||=s(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},[s(`abbr`,{title:`ttc price`},`TTC`)],-1),i[21]||=s(`th`,{class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider`},`Total`,-1),g(S)(Y.value.currency.code)?l(``,!0):(p(),u(`th`,_e,`Total USD`))])]),s(`tbody`,ve,[(p(!0),u(a,null,ie(Y.value.items,t=>(p(),u(`tr`,{key:t.id},[s(`td`,ye,[s(`div`,be,[s(`div`,xe,[t.item?.image?(p(),u(`img`,{key:0,src:t.item.image,alt:t.item.name,class:`h-10 w-10 rounded object-cover`},null,8,Se)):(p(),u(`div`,Ce,[f(g(e),{class:`h-6 w-6 text-gray-400`})]))]),s(`div`,we,[s(`div`,Te,_(t.item?.name),1),s(`div`,Ee,_(t.item_code),1)])])]),s(`td`,De,[s(`a`,{onClick:ee(e=>qe(t.sale.id),[`stop`]),class:`text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 cursor-pointer underline`,title:`View sale details (opens in new tab)`},_(t.sale.sale_code),9,Oe)]),s(`td`,ke,_(g(b)(t.quantity)),1),s(`td`,Ae,_(g(x)(t.price,!0,Y.value.currency)),1),s(`td`,je,_(g(b)(t.discount_percent)),1),s(`td`,Me,_(g(b)(t.tax_percent)),1),s(`td`,Ne,_(g(b)(t.ttc_price)),1),s(`td`,Pe,_(g(x)(t.total_price,!0,Y.value.currency)),1),g(S)(Y.value.currency.code)?l(``,!0):(p(),u(`td`,Fe,_(g(x)(t.total_price_usd,!0)),1))]))),128))]),s(`tfoot`,null,[i[22]||=s(`td`,{colspan:`6`},null,-1),i[23]||=s(`td`,{class:`px-6 py-4 text-right`},`Total`,-1),s(`td`,Ie,_(g(x)(Y.value.total,Y.value.currency?.code)),1),g(S)(Y.value.currency.code)?l(``,!0):(p(),u(`td`,Le,_(g(x)(Y.value.total_usd,`usd`)),1))])])])]),s(`div`,Re,[i[25]||=s(`div`,{class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},[s(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white`},`Summary`)],-1),s(`div`,ze,[s(`div`,Be,[f(C,{label:`Total Volume`,value:`${g(b)(Y.value.total_volume_cbm)} cbm`},null,8,[`value`]),f(C,{label:`Total Weight`,value:`${g(b)(Y.value.total_weight_kg)} kg`},null,8,[`value`]),f(C,{label:`Total Items`,value:Y.value.items?.length||0},null,8,[`value`])])])])])):l(``,!0),f(E,{show:Z.value,"onUpdate:show":i[2]||=e=>Z.value=e,"return-order":Y.value,onApproved:Je},null,8,[`show`,`return-order`]),f(w,{show:Q.value,"onUpdate:show":i[3]||=e=>Q.value=e,"return-order":Y.value,onMarkedReceived:Ye},null,8,[`show`,`return-order`])])}}}),J=q;export{J as default};
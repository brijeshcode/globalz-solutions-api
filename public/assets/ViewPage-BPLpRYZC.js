import{M as e,N as t,P as n,Q as r,W as ee,a6 as te,a7 as ne,aA as i,aB as a,aC as o,aD as s,aE as c,aG as l,aH as u,aI as re,aK as ie,aM as d,aN as f,aQ as p,aT as m,aW as h,aX as g,aY as ae,a_ as _,am as oe,an as se,ax as v,ay as y,e as ce,z as le}from"./index-7--PgFgh.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-jdfVzp2e.js";import{d as b,g as ue}from"./common-DPsEy-Xi.js";import{b as de,c as x,d as S}from"./SystemInfoCard-BTuun-od.js";import{b as C}from"./documentService-mNfVFqfh.js";import{c as fe}from"./itemsStore-CuYxGK1E.js";const pe={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8`},me={class:`max-w-4xl mx-auto`},he={class:`mb-8`},ge={class:`flex items-center justify-between mb-2`},_e={class:`flex items-center space-x-4`},ve={class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},ye={key:0,class:`flex items-center space-x-3`},be={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg p-8`},w={key:1,class:`space-y-6`},T={class:`flex items-center justify-between`},E={class:`text-sm text-gray-500 dark:text-gray-400`},D={class:`col-span-3 grid grid-cols-3`},O={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},k={class:`px-6 py-6`},A={class:`text-lg font-medium text-gray-900 dark:text-white mb-6`},j={key:0,class:`mb-8`},M={class:`text-md font-medium text-gray-700 dark:text-gray-300 mb-4`},N={class:`grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4`},xe={class:`aspect-square overflow-hidden rounded-lg bg-gray-200 dark:bg-gray-700`},Se=[`src`,`alt`,`onClick`,`onLoad`],Ce={key:0,class:`absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-gray-600`},we={class:`mt-2`},Te={class:`text-xs text-gray-500 dark:text-gray-400 truncate`},Ee={class:`text-xs text-gray-400 dark:text-gray-500`},De={class:`absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-25 transition-all duration-200 rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100`},Oe={class:`flex space-x-2`},ke=[`onClick`],Ae=[`onClick`],je={key:1},Me={class:`text-md font-medium text-gray-700 dark:text-gray-300 mb-4`},Ne={class:`grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3`},Pe={class:`flex items-start space-x-3`},Fe={class:`flex-shrink-0`},Ie={key:0,class:`w-12 h-12 relative`},Le=[`src`,`alt`],Re={key:1,class:`w-12 h-12 flex items-center justify-center bg-gray-200 dark:bg-gray-600 rounded`},ze={class:`flex-1 min-w-0`},Be={class:`text-sm font-medium text-gray-900 dark:text-gray-100 truncate`},Ve={class:`text-xs text-gray-500 dark:text-gray-400 mt-1`},He={class:`text-xs text-gray-500 dark:text-gray-400`},Ue={class:`flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity`},We={class:`flex space-x-2`},Ge=[`onClick`],Ke=[`onClick`],qe={key:2,class:`bg-white dark:bg-gray-800 shadow rounded-lg p-8`},Je={class:`flex flex-col items-center`},Ye={class:`flex min-h-screen items-center justify-center p-4`},Xe={class:`p-4 border-b border-gray-200 dark:border-gray-700`},Ze={class:`text-lg font-medium text-gray-900 dark:text-gray-100`},Qe={class:`p-4`},$e={key:0,class:`max-h-[80vh] overflow-auto`},et=[`src`,`alt`],tt={key:1,class:`h-[80vh]`},nt=[`src`],rt={key:2,class:`text-center py-8`},it={class:`text-lg font-medium text-gray-900 dark:text-gray-100 mb-2`};var P=re({__name:`ViewPage`,setup(re){let P=se(),F=oe(),I=fe(),L=h(!1),R=h(null),z=h({}),B=h(``),V=i(()=>parseInt(F.params.id)),H=i(()=>I.currentItem),U=i(()=>H.value?.documents?H.value.documents.filter(e=>J(e)):[]),W=i(()=>H.value?.documents?H.value.documents.filter(e=>!J(e)):[]),at=async()=>{try{L.value=!0,await I.fetchItem(V.value)}catch(e){console.error(`Error loading item:`,e)}finally{L.value=!1}},G=()=>{P.push({name:`items.index`})},ot=()=>{P.push({name:`items.edit`,params:{id:V.value.toString()}})},K=e=>{R.value=e,B.value=e.thumbnail_url},q=()=>{R.value=null,B.value=``},J=e=>{let t=e.file_extension?.toLowerCase();return[`jpg`,`jpeg`,`png`,`gif`,`bmp`,`svg`,`webp`].includes(t||``)},st=e=>{z.value[e]=!0},Y=e=>{let t=e.target;t.style.display=`none`,console.error(`Failed to load image:`,t.src)},ct=async e=>{try{await C.download(e)}catch(t){console.error(`Error downloading document:`,t),window.open(e.download_url,`_blank`)}},lt=e=>{R.value=e,B.value=e.preview_url},X=n=>{let r=n?.toLowerCase();switch(r){case`pdf`:case`doc`:case`docx`:case`xls`:case`xlsx`:case`txt`:return t;case`zip`:case`rar`:return ne;default:return e}},ut=e=>{let t=e.target;t.style.display=`none`},Z=async e=>{try{await C.download(e)}catch(e){console.error(`Error downloading document:`,e)}},Q=e=>e?Number(e).toLocaleString(`en-US`,{minimumFractionDigits:2,maximumFractionDigits:2}):`0.00`,$=e=>e?Number(e).toLocaleString(`en-US`):`0`,dt=e=>e.low_quantity_alert?e.starting_quantity<=e.low_quantity_alert?`text-red-600 dark:text-red-400`:`text-green-600 dark:text-green-400`:`text-gray-900 dark:text-white`,ft=e=>e.low_quantity_alert?e.starting_quantity<=e.low_quantity_alert?`text-red-600 dark:text-red-400`:`text-orange-600 dark:text-orange-400`:`text-gray-500 dark:text-gray-400`;return ie(()=>{at()}),(e,t)=>(d(),c(`div`,pe,[a(`div`,me,[a(`div`,he,[a(`div`,ge,[a(`div`,_e,[a(`button`,{onClick:G,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[u(g(te),{class:`w-5 h-5`})]),a(`div`,null,[a(`h2`,ve,_(H.value?`Item: ${H.value.code}`:`Item Details`),1),t[2]||=a(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},` View item information and inventory details `,-1)])]),H.value?(d(),c(`div`,ye,[a(`button`,{onClick:ot,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors`},[u(g(le),{class:`w-4 h-4 mr-2`}),t[3]||=l(` Edit Item `,-1)])])):s(``,!0)])]),L.value?(d(),c(`div`,be,t[4]||=[a(`div`,{class:`flex items-center justify-center`},[a(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-4`}),a(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading item...`)],-1)])):H.value?(d(),c(`div`,w,[a(`div`,T,[a(`span`,{class:ae([`inline-flex px-3 py-1 text-sm font-semibold rounded-full`,g(ue)(H.value.is_active)])},_(H.value.is_active?`Active`:`Inactive`),3),a(`div`,E,` ID: `+_(H.value.id),1)]),u(x,{title:`Basic Information`,gridCols:`cols-2`,data:[{label:`Item Code`,value:H.value.code,mono:!0,darkBG:!0},{label:`Short Name`,value:H.value.code},{label:`Description`,value:H.value.description}]},{default:m(()=>[u(S,{label:`Barcode`,value:H.value.barcode,mono:!0,darkBG:!0,class:`md:col-span-2`},null,8,[`value`])]),_:1},8,[`data`]),u(x,{title:`Classification`},{default:m(()=>[u(S,{label:`Item Type`,value:H.value.item_type?.name,fallback:`No item type set`},null,8,[`value`]),u(S,{label:`Item Unit`,value:H.value.item_unit?.name,fallback:`No item unit set`},null,8,[`value`]),u(S,{label:`Tax Code`,value:H.value.tax_code?`${H.value.tax_code.name} (${H.value.tax_code.rate}%)`:`-`},null,8,[`value`]),u(S,{label:`Item Family`,value:H.value.item_family?.name},null,8,[`value`]),u(S,{label:`Item Category`,value:H.value.item_category?.name},null,8,[`value`]),u(S,{label:`Supplier`,value:H.value.supplier?.name},null,8,[`value`]),u(S,{label:`Profit Margin`,value:H.value.item_profit_margin?.name},null,8,[`value`])]),_:1}),u(x,{title:`Pricing & Inventory`,data:[{label:`Base Cost`,value:`$${Q(H.value.base_cost)}`},{label:`Base Selling Price`,value:`$${Q(H.value.base_sell)}`},{label:`Starting Price`,value:`$${Q(H.value.starting_price)}`},{label:`Current Quantity`,value:`${$(H.value.starting_quantity)}`,valueClass:dt(H.value),mono:!0},{label:`Low Stock Alert`,value:`${$(H.value.low_quantity_alert)}`,valueClass:ft(H.value),mono:!0},{label:`Cost Calculation Method`,value:H.value.cost_calculation===`weighted_average`?`Weighted Average`:`Last Cost`}]},null,8,[`data`]),u(x,{title:`Additional Information`},{default:m(()=>[a(`div`,D,[u(S,{label:`Volume`,mono:!0,value:H.value.volume},null,8,[`value`]),u(S,{label:`Weight`,mono:!0,value:H.value.weight},null,8,[`value`])]),u(S,{class:`col-span-3`,label:`Notes`,value:H.value.notes,darkBG:!0},null,8,[`value`])]),_:1}),H.value.documents&&H.value.documents.length>0?(d(),c(`div`,O,[a(`div`,k,[a(`h3`,A,` Documents (`+_(H.value.documents.length)+`) `,1),U.value.length>0?(d(),c(`div`,j,[a(`h4`,M,` Images (`+_(U.value.length)+`) `,1),a(`div`,N,[(d(!0),c(y,null,f(U.value,e=>(d(),c(`div`,{key:e.id,class:`group relative`},[a(`div`,xe,[a(`img`,{src:e.thumbnail_url,alt:e.title||e.original_name||`Product image`,class:`h-full w-full object-cover object-center group-hover:opacity-75 transition-opacity cursor-pointer`,onClick:t=>K(e),onLoad:t=>st(e.id),onError:Y,loading:`lazy`},null,40,Se),z.value[e.id]?s(``,!0):(d(),c(`div`,Ce,t[5]||=[a(`div`,{class:`animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600`},null,-1)]))]),a(`div`,we,[a(`p`,Te,_(e.original_name),1),a(`p`,Ee,_(e.file_size_human),1)]),a(`div`,De,[a(`div`,Oe,[a(`button`,{onClick:v(t=>K(e),[`stop`]),class:`p-2 bg-white dark:bg-gray-800 rounded-full shadow-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors`,title:`View Full Size`},[u(g(n),{class:`h-4 w-4 text-gray-700 dark:text-gray-300`})],8,ke),a(`button`,{onClick:v(t=>ct(e),[`stop`]),class:`p-2 bg-white dark:bg-gray-800 rounded-full shadow-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors`,title:`Download`},[u(g(r),{class:`h-4 w-4 text-gray-700 dark:text-gray-300`})],8,Ae)])])]))),128))])])):s(``,!0),W.value.length>0?(d(),c(`div`,je,[a(`h4`,Me,` Other Files (`+_(W.value.length)+`) `,1),a(`div`,Ne,[(d(!0),c(y,null,f(W.value,e=>(d(),c(`div`,{key:e.id,class:`relative group bg-gray-50 dark:bg-gray-700 rounded-lg p-4 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors`},[a(`div`,Pe,[a(`div`,Fe,[e.file_extension?.toLowerCase()===`pdf`?(d(),c(`div`,Ie,[a(`img`,{src:e.thumbnail_url,alt:e.title||e.original_name,class:`w-12 h-12 object-cover rounded border`,onError:ut},null,40,Le)])):(d(),c(`div`,Re,[(d(),o(p(X(e.file_extension)),{class:`h-6 w-6 text-gray-400`}))]))]),a(`div`,ze,[a(`p`,Be,_(e.title||e.original_name),1),a(`p`,Ve,_(e.file_size_human),1),a(`p`,He,_(g(b)(e.created_at)),1)]),a(`div`,Ue,[a(`div`,We,[e.file_extension?.toLowerCase()===`pdf`?(d(),c(`button`,{key:0,onClick:t=>lt(e),class:`text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300`,title:`Preview`},[u(g(n),{class:`h-4 w-4`})],8,Ge)):s(``,!0),a(`button`,{onClick:t=>Z(e),class:`text-indigo-600 hover:text-indigo-500 dark:text-indigo-400 dark:hover:text-indigo-300`,title:`Download`},[u(g(r),{class:`h-4 w-4`})],8,Ke)])])])]))),128))])])):s(``,!0)])])):s(``,!0),u(de,{item:H.value,formatDateTime:g(b)},null,8,[`item`,`formatDateTime`])])):(d(),c(`div`,qe,[a(`div`,Je,[u(g(ee),{class:`w-12 h-12 text-red-400 mb-4`}),t[6]||=a(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-gray-100 mb-2`},` Item Not Found `,-1),t[7]||=a(`p`,{class:`text-gray-500 dark:text-gray-400 mb-6`},` The item you're looking for could not be found. `,-1),a(`button`,{onClick:G,class:`px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300`},` ← Back to Items `)])]))]),R.value?(d(),c(`div`,{key:0,class:`fixed inset-0 z-50 overflow-y-auto`,onClick:q},[a(`div`,Ye,[t[10]||=a(`div`,{class:`fixed inset-0 bg-black opacity-75`},null,-1),a(`div`,{class:`relative bg-white dark:bg-gray-800 rounded-lg max-w-6xl max-h-full w-full`,onClick:t[1]||=v(()=>{},[`stop`])},[a(`button`,{onClick:q,class:`absolute top-4 right-4 z-10 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 bg-white dark:bg-gray-800 rounded-full p-1`},[u(g(ce),{class:`w-6 h-6`})]),a(`div`,Xe,[a(`h3`,Ze,_(R.value.title||R.value.original_name),1)]),a(`div`,Qe,[J(R.value)?(d(),c(`div`,$e,[a(`img`,{src:B.value||R.value.thumbnail_url,alt:R.value.title||R.value.original_name,class:`max-w-full h-auto mx-auto rounded-lg shadow-lg`},null,8,et)])):R.value.file_extension?.toLowerCase()===`pdf`?(d(),c(`div`,tt,[a(`iframe`,{src:B.value,class:`w-full h-full border rounded-lg`,title:`PDF Preview`,frameborder:`0`},null,8,nt)])):(d(),c(`div`,rt,[(d(),o(p(X(R.value.file_extension)),{class:`mx-auto h-16 w-16 text-gray-400 mb-4`})),a(`h3`,it,_(R.value.original_name),1),t[9]||=a(`p`,{class:`text-gray-500 dark:text-gray-400 mb-4`},` Preview not available for this file type `,-1),a(`button`,{onClick:t[0]||=e=>Z(R.value),class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700`},[u(g(r),{class:`h-4 w-4 mr-2`}),t[8]||=l(` Download File `,-1)])]))])])])])):s(``,!0)]))}}),F=P;export{F as default};
import{I as e,S as t,aA as n,aE as r,aG as ee,aH as i,aI as te,aJ as ne,aK as a,aM as o,aN as s,aO as c,aQ as re,aS as l,aT as ie,aZ as ae,a_ as u,ao as d,as as oe,at as se,b0 as f,b1 as p,b2 as ce,b4 as m,s as le,x as h,z as ue}from"./index-DbpeR0dl.js";import"./GlobalConfig-Dep5CV3r.js";import{c as de}from"./accountsStore-CE-MSo-F.js";import"./tableUtils-BFc6-TYF.js";import{b as fe}from"./PageHeader-DKmzd2ru.js";import{c as pe,f as g}from"./common-DNevajli.js";import{b as _}from"./StatCard-ClnB4osx.js";import{b as v,d as y}from"./currencyUtil-K-N-GJVn.js";const b={class:`space-y-6`},x=[`disabled`],S={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6`},C={class:`bg-white dark:bg-gray-800 shadow rounded-lg p-4`},w={class:`grid grid-cols-1 md:grid-cols-6 gap-4`},T={class:`md:col-span-2`},E={class:`relative`},D={class:`bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden`},O={key:0,class:`p-8 text-center`},k={key:1,class:`p-8 text-center`},A={class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},j={key:2,class:`overflow-x-auto`},M={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},N={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},P={class:`px-4 py-1 whitespace-nowrap`},F={class:`text-sm text-gray-900 dark:text-white`},I={class:`px-4 py-1 whitespace-nowrap`},L={class:`px-4 py-1 whitespace-nowrap`},R=[`onClick`],z={key:1,class:`text-sm text-gray-900 dark:text-white`},B={class:`px-4 py-1 whitespace-nowrap`},me={class:`text-sm text-gray-900 dark:text-white`},he={class:`px-4 py-1 whitespace-nowrap text-right`},ge={class:`text-sm font-medium text-red-600 dark:text-red-400`},_e={class:`px-4 py-1 whitespace-nowrap text-right`},ve={class:`text-sm font-medium text-green-600 dark:text-green-400`},ye={class:`px-4 py-1 whitespace-nowrap text-right`};var V=c({__name:`StatmentPage`,setup(c){let V=oe(),H=se(),be=d(),U=de(),W=ee(()=>parseInt(V.params.id)),G=f(!1),K=f([]),q=f({}),J=f({}),Y=f(``),X=f(null),Z=f({search:``,from_date:``,to_date:``,withPage:!1}),Q=async()=>{try{G.value=!0;let e=await U.getAccountStatements(W.value,Z.value);K.value=e.data,q.value=e.stats}catch(e){be.error(`Failed to load account statements`,{title:`Error`}),console.error(`Error fetching statements:`,e)}finally{G.value=!1}},xe=()=>{X.value&&clearTimeout(X.value),X.value=setTimeout(()=>{Q()},300)},$=()=>{Q()},Se=()=>{Z.value={search:``,from_date:``,to_date:``,withPage:!1},Q()},Ce=e=>{let t={sales:`Sales`,payments:`Payment`,credit_note:`Credit Note`,debit_note:`Debit Note`,returns:`Return`,journal:`Journal Entry`,opening_balance:`Opening Balance`};return t[e]||e},we=async()=>{try{J.value=await U.fetchAccount(W.value),Y.value=J.value.name}catch(e){console.error(`Error fetching account details:`,e)}},Te=()=>{H.push({name:`accounts.statement.preview`,params:{id:W.value},query:{from_date:Z.value.from_date,to_date:Z.value.to_date,search:Z.value.search}})},Ee=e=>{if(!e.id||!e.transaction_type)return;let t={customer_payment:`customer.payments.show`,expense:`expenses.transactions.view`,purchase:`purchases.view`,opening_balance:``},n=t[e.transaction_type];if(!n)return;let r=H.resolve({name:n,params:{id:e.id}});window.open(r.href,`_blank`)};return re(async()=>{try{await Promise.all([we(),Q()])}catch(e){console.error(`Error loading initial data:`,e)}}),(ee,c)=>(l(),a(`div`,b,[s(fe,{title:`Account Statement - ${Y.value}`,description:`View account transaction history including debits, credits, and balance`,showCreateButton:!1},{actions:ae(()=>[i(`button`,{onClick:Te,disabled:K.value.length===0,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},[s(p(ue),{class:`w-4 h-4 mr-2`}),c[3]||=o(` Print Preview `,-1)],8,x)]),_:1},8,[`title`]),i(`div`,S,[p(y)(J.value.currency?.code)?ne(``,!0):(l(),te(_,{key:0,label:`USD Value`,value:p(g)(q.value.balance_in_usd),icon:p(h),"icon-color":`blue`},null,8,[`value`,`icon`])),s(_,{label:`Balance`,value:p(g)(q.value.balance),icon:p(h),"icon-color":`blue`},null,8,[`value`,`icon`]),s(_,{label:`Credit`,value:p(g)(q.value.total_credit),icon:p(h),"icon-color":`green`},null,8,[`value`,`icon`]),s(_,{label:`Debit`,value:p(g)(q.value.total_debit),icon:p(h),"icon-color":`red`},null,8,[`value`,`icon`])]),i(`div`,C,[i(`div`,w,[i(`div`,T,[c[4]||=i(`label`,{for:`search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Search `,-1),i(`div`,E,[u(i(`input`,{id:`search`,"onUpdate:modelValue":c[0]||=e=>Z.value.search=e,type:`text`,placeholder:`Search note...`,class:`block w-full px-3 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 sm:text-sm transition-colors duration-200`,onInput:xe},null,544),[[n,Z.value.search]]),s(p(le),{class:`absolute left-3 top-2.5 h-5 w-5 text-gray-400`})])]),i(`div`,null,[c[5]||=i(`label`,{for:`from_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` From Date `,-1),u(i(`input`,{id:`from_date`,"onUpdate:modelValue":c[1]||=e=>Z.value.from_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:$},null,544),[[n,Z.value.from_date]])]),i(`div`,null,[c[6]||=i(`label`,{for:`to_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` To Date `,-1),u(i(`input`,{id:`to_date`,"onUpdate:modelValue":c[2]||=e=>Z.value.to_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:$},null,544),[[n,Z.value.to_date]])]),i(`div`,{class:`flex items-end`},[i(`button`,{onClick:Se,class:`w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200`},` Clear `)])])]),i(`div`,D,[G.value?(l(),a(`div`,O,[s(p(e),{class:`h-8 w-8 animate-spin mx-auto text-blue-600 dark:text-blue-400`}),c[7]||=i(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},`Loading statements...`,-1)])):K.value.length===0?(l(),a(`div`,k,[s(p(t),{class:`h-12 w-12 mx-auto text-gray-400`}),c[8]||=i(`h3`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},` No statements found `,-1),i(`p`,A,m(Z.value.search?`Try adjusting your search criteria.`:`No transactions available for this account.`),1)])):(l(),a(`div`,j,[i(`table`,M,[c[9]||=i(`thead`,{class:`bg-gray-50 dark:bg-gray-700`},[i(`tr`,null,[i(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Date `),i(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Type `),i(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Transaction ID `),i(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Note `),i(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Debit `),i(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Credit `),i(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Balance `)])],-1),i(`tbody`,N,[(l(!0),a(r,null,ie(K.value,e=>(l(),a(`tr`,{key:e.id,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[i(`td`,P,[i(`div`,F,m(p(pe)(e.date)),1)]),i(`td`,I,m(Ce(e.type)),1),i(`td`,L,[e.code?(l(),a(`div`,{key:0,onClick:t=>Ee(e),class:`text-sm text-blue-600 dark:text-blue-400 cursor-zoom-in hover:underline`},m(e.code),9,R)):(l(),a(`div`,z,` - `))]),i(`td`,B,[i(`div`,me,m(e.note||`-`),1)]),i(`td`,he,[i(`div`,ge,m(e.debit?p(v)(e.debit,!0):`-`),1)]),i(`td`,_e,[i(`div`,ve,m(e.credit?p(v)(e.credit,!0):`-`),1)]),i(`td`,ye,[i(`div`,{class:ce([`text-sm font-medium`,e.balance>=0?`text-green-600 dark:text-green-400`:`text-red-600 dark:text-red-400`])},m(p(v)(e.balance,!0)),3)])]))),128))])])]))])]))}}),H=V;export{H as default};
import{E as e,a6 as t,aB as n,aD as r,aE as i,aG as a,aH as o,aI as ee,aK as s,aM as c,aN as te,aW as l,aX as u,aY as d,a_ as f,ai as ne,am as re,an as ie,ay as ae,l as oe,n as se,v as ce,z as le}from"./index-7--PgFgh.js";import{b as ue}from"./useAuth-DrV2p0In.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-jdfVzp2e.js";import{b as de}from"./ConfirmationModal-C2JqgI22.js";import{b as p}from"./common-DPsEy-Xi.js";import{b as fe}from"./salesStore-BP4UKXK9.js";const pe={class:`max-w-8xl mx-auto py-2`},me={class:``},m={class:`mb-8`},h={class:`flex items-center space-x-4 mb-2`},g={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},_={class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},v={class:`flex items-center justify-between`},y={class:`text-lg font-medium text-gray-900 dark:text-white`},b={class:`text-sm text-gray-500 dark:text-gray-400`},x={class:`flex space-x-3`},S={class:`px-6 py-8`},C={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},w={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6`},T={class:`mt-1 text-sm text-gray-900 dark:text-white`},E={class:`mt-1 text-sm text-gray-900 dark:text-white`},D={class:`mt-1 text-sm text-gray-900 dark:text-white`},O={class:`mt-1 text-sm text-gray-900 dark:text-white`},k={class:`mt-1 text-sm text-gray-900 dark:text-white`},A={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-4`},j={class:`mt-1 text-sm text-gray-900 dark:text-white`},M={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},N={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6`},P={class:`mt-1 text-sm text-gray-900 dark:text-white`},F={class:`mt-1 text-sm text-gray-900 dark:text-white`},I={class:`mt-1 text-sm text-gray-900 dark:text-white`},L={key:0},R={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},z={key:0,class:`text-center py-8 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg`},he={key:1,class:`overflow-x-auto`},ge={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},_e={class:`bg-gray-50 dark:bg-gray-700`},ve={key:0,class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},ye={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},be={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},xe={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Se={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ce={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},we={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Te={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ee={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},De={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Oe={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ke={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ae={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},je={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Me={class:`bg-gray-50 dark:bg-gray-700`},B={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Ne={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Pe={key:0},Fe={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Ie={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Le={key:0,class:`px-6 py-4`},Re={class:`bg-green-50 dark:bg-green-900`},ze={class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},Be={class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},Ve={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},He={class:`grid grid-cols-1 md:grid-cols-3 gap-6`},Ue={class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},We={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},Ge={class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},Ke={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},qe={class:`mt-1 text-lg font-medium`},Je={key:0,class:`mb-6`},Ye={class:`bg-gray-50 dark:bg-gray-700 rounded-lg p-4`},Xe={class:`text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap`},Ze={class:`pt-6 border-t border-gray-200 dark:border-gray-700`},Qe={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},$e={class:`mt-1 text-sm text-gray-900 dark:text-white`},et={class:`mt-1 text-sm text-gray-900 dark:text-white`},tt={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},nt={class:`px-6 py-8 text-center`};var V=ee({__name:`ViewPage`,setup(ee){let V=ie(),H=re(),U=ne(),W=fe(),{isSalesman:rt,isAdmin:G,isWarehouseManager:it}=ue(),K=parseInt(H.params.id),q=l(!0),J=l({}),Y=l(!1),X=l(!1),at=()=>{V.push({name:`sales.index`})},ot=()=>{V.push({name:`sales.edit`,params:{id:K.toString()}})},st=()=>{V.push({name:`sales.invoice`,params:{id:K.toString()},query:{from:`view`}})},ct=()=>{Y.value=!0},lt=()=>{Y.value=!1,X.value=!1},ut=async()=>{X.value=!0;try{await W.deleteSale(K),U.success(`Sale deleted successfully`),V.push({name:`sales.index`})}catch{U.error(`Failed to delete sale`)}finally{X.value=!1}},dt=async()=>{try{q.value=!0,J.value=await W.fetchSale(K)}catch(e){console.error(`Error loading sale:`,e),U.error(`Failed to load sale details`),V.push({name:`sales.index`})}finally{q.value=!1}},Z=e=>{let t=Number(e||0);return t>0?`text-green-600 dark:text-green-400 font-medium`:t<0?`text-red-600 dark:text-red-400 font-medium`:`text-gray-600 dark:text-gray-400`},ft=e=>{let t=Number(e||0);return t>0?`bg-green-50 dark:bg-green-900 text-green-600 dark:text-green-400`:t<0?`bg-red-50 dark:bg-red-900 text-red-600 dark:text-red-400`:`bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-400`},pt=e=>{let t=Number(e||0);return t>0?`text-red-600 dark:text-red-400 font-medium`:`text-gray-900 dark:text-white`},Q=e=>e?parseFloat(Number(e).toFixed(2)).toString():`0`,mt=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleDateString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`})},$=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`})};return s(async()=>{await dt()}),(ee,s)=>(c(),i(`div`,pe,[n(`div`,me,[n(`div`,m,[n(`div`,h,[n(`button`,{onClick:at,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[o(u(t),{class:`w-5 h-5`})]),s[1]||=n(`div`,null,[n(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},` Sale Details `),n(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},` View sale order information `)],-1)])]),q.value?(c(),i(`div`,tt,[n(`div`,nt,[o(u(e),{class:`w-8 h-8 animate-spin mx-auto text-blue-600`}),s[43]||=n(`p`,{class:`mt-2 text-gray-600 dark:text-gray-400`},`Loading sale details...`,-1)])])):(c(),i(`div`,g,[n(`div`,_,[n(`div`,v,[n(`div`,null,[n(`h3`,y,f(J.value.prefix)+`-`+f(J.value.code),1),n(`p`,b,` Sale ID: `+f(J.value.id),1)]),n(`div`,x,[n(`button`,{onClick:st,class:`inline-flex items-center px-3 py-2 border border-green-300 dark:border-green-600 text-sm font-medium rounded-md text-green-700 dark:text-green-300 bg-white dark:bg-gray-800 hover:bg-green-50 dark:hover:bg-green-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200`},[o(u(ce),{class:`w-4 h-4 mr-2`}),s[2]||=a(` Print Invoice `,-1)]),u(G)?(c(),i(`button`,{key:0,onClick:ot,class:`inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200`},[o(u(le),{class:`w-4 h-4 mr-2`}),s[3]||=a(` Edit `,-1)])):r(``,!0),u(G)?(c(),i(`button`,{key:1,onClick:ct,class:`inline-flex items-center px-3 py-2 border border-red-300 dark:border-red-600 text-sm font-medium rounded-md text-red-700 dark:text-red-300 bg-white dark:bg-gray-800 hover:bg-red-50 dark:hover:bg-red-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200`},[o(u(oe),{class:`w-4 h-4 mr-2`}),s[4]||=a(` Delete `,-1)])):r(``,!0)])])]),n(`div`,S,[n(`div`,C,[s[12]||=n(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Basic Information `,-1),n(`div`,w,[n(`div`,null,[s[5]||=n(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Sale Date`,-1),n(`dd`,T,f(mt(J.value.date)),1)]),n(`div`,null,[s[6]||=n(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Customer`,-1),n(`dd`,E,f(J.value.customer.name),1)]),n(`div`,null,[s[7]||=n(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Salesperson`,-1),n(`dd`,D,f(J.value.salesperson.name),1)]),n(`div`,null,[s[8]||=n(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Warehouse`,-1),n(`dd`,O,f(J.value.warehouse.name),1)]),n(`div`,null,[s[9]||=n(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Currency`,-1),n(`dd`,k,f(J.value.currency.code)+` - `+f(J.value.currency.name),1)])]),n(`div`,A,[n(`div`,null,[s[10]||=n(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Currency Rate`,-1),n(`dd`,j,f(Q(J.value.currency_rate)),1)]),n(`div`,null,[s[11]||=n(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Outstanding Balance`,-1),n(`dd`,{class:d([`mt-1 text-sm`,pt(J.value.outStanding_balance)])},f(u(p)(J.value.outStanding_balance)),3)])])]),n(`div`,M,[s[17]||=n(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Financial Summary `,-1),n(`div`,N,[n(`div`,null,[s[13]||=n(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Sub Total`,-1),n(`dd`,P,f(u(p)(J.value.sub_total)),1)]),n(`div`,null,[s[14]||=n(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Sub Total (USD)`,-1),n(`dd`,F,f(u(p)(J.value.sub_total_usd)),1)]),n(`div`,null,[s[15]||=n(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Discount Amount`,-1),n(`dd`,I,f(u(p)(J.value.discount_amount)),1)]),u(G)?(c(),i(`div`,L,[s[16]||=n(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Total Profit`,-1),n(`dd`,{class:d([`mt-1 text-sm`,Z(J.value.total_profit)])},f(u(p)(J.value.total_profit)),3)])):r(``,!0)])]),n(`div`,R,[s[35]||=n(`div`,{class:`flex items-center justify-between mb-4`},[n(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white`},` Sale Items `)],-1),J.value.items&&J.value.items.length===0?(c(),i(`div`,z,[o(u(se),{class:`mx-auto h-12 w-12 text-gray-400`}),s[18]||=n(`h5`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},`No items found`,-1),s[19]||=n(`p`,{class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},`This sale has no items.`,-1)])):(c(),i(`div`,he,[n(`table`,ge,[n(`thead`,_e,[n(`tr`,null,[s[20]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`#`,-1),s[21]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Code`,-1),s[22]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Item`,-1),s[23]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Unit`,-1),s[24]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[n(`abbr`,{title:`Total Quantity`},`QTY`)],-1),s[25]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Sale Price`,-1),s[26]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Cost Price`,-1),s[27]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[n(`abbr`,{title:`Discount Percentage`},`Dis. %`)],-1),s[28]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[n(`abbr`,{title:`Tax Percentage`},`Tax %`)],-1),s[29]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[n(`abbr`,{title:`Tax-inclusive Price`},`TTC`)],-1),s[30]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Total`,-1),s[31]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`USD`,-1),u(G)?(c(),i(`th`,ve,`Profit`)):r(``,!0)])]),n(`tbody`,ye,[(c(!0),i(ae,null,te(J.value.items,(e,t)=>(c(),i(`tr`,{key:t,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[n(`td`,be,f(t+1),1),n(`td`,xe,f(e.item_code),1),n(`td`,Se,f(e.item.description),1),n(`td`,Ce,f(e.item.item_unit.name),1),n(`td`,we,f(Q(e.quantity)),1),n(`td`,Te,f(u(p)(e.price)),1),n(`td`,Ee,f(u(p)(e.cost_price)),1),n(`td`,De,f(Q(e.discount_percent))+`%`,1),n(`td`,Oe,f(Q(e.tax_percent))+`%`,1),n(`td`,ke,f(Q(e.ttc_price)),1),n(`td`,Ae,f(u(p)(e.total_price)),1),n(`td`,je,f(u(p)(e.total_price_usd)),1),u(G)?(c(),i(`td`,{key:0,class:d([`px-6 py-4 whitespace-nowrap text-sm`,Z(e.unit_profit)])},f(u(p)(e.unit_profit)),3)):r(``,!0)]))),128))]),n(`tfoot`,Me,[n(`tr`,null,[s[32]||=n(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Sub Total:`,-1),n(`td`,B,f(u(p)(J.value.sub_total)),1),n(`td`,Ne,f(u(p)(J.value.sub_total_usd)),1),u(G)?(c(),i(`td`,{key:0,class:d([`px-6 py-4 text-sm font-medium`,Z(J.value.total_profit)])},f(u(p)(J.value.total_profit)),3)):r(``,!0)]),J.value.discount_amount&&Number(J.value.discount_amount)>0?(c(),i(`tr`,Pe,[s[33]||=n(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Additional Discount:`,-1),n(`td`,Fe,`-`+f(u(p)(J.value.discount_amount)),1),n(`td`,Ie,`-`+f(u(p)(J.value.discount_amount_usd)),1),u(G)?(c(),i(`td`,Le)):r(``,!0)])):r(``,!0),n(`tr`,Re,[s[34]||=n(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-bold text-gray-900 dark:text-white`},`Final Total:`,-1),n(`td`,ze,f(u(p)(J.value.total)),1),n(`td`,Be,f(u(p)(J.value.total_usd)),1),u(G)?(c(),i(`td`,{key:0,class:d([`px-6 py-4 text-sm font-bold`,Z(J.value.total_profit)])},f(u(p)(J.value.total_profit)),3)):r(``,!0)])])])]))]),n(`div`,Ve,[s[39]||=n(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Final Totals `,-1),n(`div`,He,[n(`div`,Ue,[s[36]||=n(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount`,-1),n(`dd`,We,f(u(p)(J.value.total)),1)]),n(`div`,Ge,[s[37]||=n(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount (USD)`,-1),n(`dd`,Ke,f(u(p)(J.value.total_usd)),1)]),u(G)?(c(),i(`div`,{key:0,class:d([`rounded-lg p-4`,ft(J.value.total_profit)])},[s[38]||=n(`dt`,{class:`text-sm font-medium`},`Total Profit (USD)`,-1),n(`dd`,qe,f(u(p)(J.value.total_profit)),1)],2)):r(``,!0)])]),J.value.note?(c(),i(`div`,Je,[s[40]||=n(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Notes `,-1),n(`div`,Ye,[n(`p`,Xe,f(J.value.note),1)])])):r(``,!0),n(`div`,Ze,[n(`div`,Qe,[n(`div`,null,[s[41]||=n(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Created At`,-1),n(`dd`,$e,f($(J.value.created_at)),1)]),n(`div`,null,[s[42]||=n(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Last Updated`,-1),n(`dd`,et,f($(J.value.updated_at)),1)])])])])]))]),o(de,{show:Y.value,"onUpdate:show":s[0]||=e=>Y.value=e,type:`delete`,title:`Delete Sale ${J.value.prefix}-${J.value.code}`,message:`Are you sure you want to delete sale '${J.value.prefix}-${J.value.code}'? This action can be undone by restoring from trash.`,"confirm-text":`Delete Sale`,"loading-text":`Deleting...`,loading:X.value,onConfirm:ut,onCancel:lt},null,8,[`show`,`title`,`message`,`loading`])]))}}),H=V;export{H as default};
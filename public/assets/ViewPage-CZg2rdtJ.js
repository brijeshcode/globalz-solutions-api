import{$ as e,R as t,W as n,X as r,Z as i,a$ as ee,a7 as te,aC as ne,aD as re,aO as ie,aQ as ae,aR as a,aS as oe,aT as o,aU as s,aW as c,aX as l,aY as se,ak as ce,b1 as u,b2 as le,b5 as ue,b8 as d,bb as f,bc as p,bd as m,bf as h,i as de,u as fe}from"./index-BsiRFf-z.js";import"./GlobalConfig-wPgXFcZ5.js";import{d as g}from"./common-CZbH6H1Z.js";import"./tableUtils-dXs1kjAL.js";import{b as _}from"./currencyUtil-BgG2HgTe.js";import{b as v}from"./DataItems-QEpYvm7C.js";import{b as pe,c as y}from"./SystemInfoCard-C2_MfbQl.js";import{b}from"./documentService-BED-VTcD.js";import{b as x}from"./customersStore-FNAApxA4.js";const S={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8`},C={class:`mb-8`},w={class:`flex items-center justify-between`},T={class:`flex items-center space-x-4`},E={class:`text-3xl font-bold text-gray-900 dark:text-gray-100`},D={class:`text-sm text-gray-600 dark:text-gray-400 mt-1`},O={class:`flex items-center space-x-3`},k={key:0,class:`flex items-center justify-center py-12`},A={key:1,class:`bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6`},j={class:`flex items-center`},M={class:`text-red-600 dark:text-red-400 mt-1`},N={key:2,class:`space-y-8`},P=[`href`],F={key:1},I=[`href`],L={key:1},R=[`href`],z={key:1},B={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},me={class:`px-6 py-5 border-b border-gray-200 dark:border-gray-700`},he={class:`flex items-center justify-between`},ge={class:`text-lg font-medium text-gray-900 dark:text-gray-100`},_e={class:`px-6 py-5`},ve={class:`grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3`},ye={class:`flex items-start space-x-3`},be={class:`flex-shrink-0`},xe={class:`flex-1 min-w-0`},Se={class:`text-sm font-medium text-gray-900 dark:text-gray-100 truncate`},Ce={class:`text-xs text-gray-500 dark:text-gray-400 mt-1`},we={class:`text-xs text-gray-500 dark:text-gray-400`},V={class:`flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity`},Te={class:`flex space-x-2`},Ee=[`onClick`],De=[`onClick`],Oe={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},ke={class:`px-6 py-8 text-center`},Ae={key:3,class:`fixed inset-0 z-50 overflow-y-auto`,"aria-labelledby":`modal-title`,role:`dialog`,"aria-modal":`true`},je={class:`flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0`},Me={class:`inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full sm:p-6`},Ne={class:`absolute top-0 right-0 pt-4 pr-4`},Pe={class:`mt-3 text-center sm:mt-5`},Fe={class:`text-lg leading-6 font-medium text-gray-900 dark:text-gray-100 mb-4`},Ie={key:0,class:`max-h-96 overflow-auto`},Le=[`src`,`alt`],Re={key:1,class:`flex items-center justify-center py-8`},ze={key:1,class:`h-96`},Be=[`src`],Ve={key:1,class:`flex items-center justify-center py-8`},He={key:2,class:`text-center py-8`},Ue={class:`mt-5 sm:mt-6 flex justify-center space-x-3`};var H=se({__name:`ViewPage`,setup(se){let H=re(),U=ne(),We=ae(()=>parseInt(U.params.id)),Ge=x(),W=f(null),G=f(!1),K=f(``),q=f(!1),J=f(null),Y=f(``),Ke=async()=>{try{G.value=!0,K.value=``,W.value=await Ge.fetchCustomer(We.value)}catch(e){K.value=e.message||`Failed to load customer details`,console.error(`Error loading customer:`,e)}finally{G.value=!1}},qe=()=>{H.push({name:`customer.index`})},Je=()=>{W.value&&H.push({name:`customer.edit`,params:{id:W.value.id.toString()}})},X=async e=>{await b.download(e)},Ye=async e=>{try{J.value=e,q.value=!0;let t=await b.preview(e.id);Y.value=t.preview_url}catch(t){console.error(`Error getting preview URL:`,t),Y.value=Ze(e)}},Z=()=>{q.value=!1,J.value=null,Y.value=``},Xe=e=>Q(e)||$(e),Q=e=>{let t=e.file_extension?.toLowerCase();return[`jpg`,`jpeg`,`png`,`gif`,`bmp`,`svg`,`webp`].includes(t||``)},$=e=>{let t=e.file_extension?.toLowerCase();return t===`pdf`},Ze=e=>{let t=`https://staging.globalzsolutions.com`;return`${t}/api/documents/${e.id}/preview`},Qe=e=>{let i=e?.toLowerCase();return[`jpg`,`jpeg`,`png`,`gif`,`bmp`,`svg`].includes(i)?t:[`pdf`].includes(i)?r:n};return ee(()=>{Ke()}),(t,n)=>(u(),s(`div`,S,[a(`div`,C,[a(`div`,w,[a(`div`,T,[a(`button`,{onClick:qe,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[l(p(ce),{class:`w-5 h-5`})]),a(`div`,null,[a(`h1`,E,h(W.value?.name||`Customer Details`),1),a(`p`,D,` Customer Code: `+h(W.value?.code),1)])]),a(`div`,O,[W.value?(u(),s(`span`,{key:0,class:m([`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium`,W.value?.is_active?`bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300`:`bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300`])},h(W.value?.is_active?`Active`:`Inactive`),3)):o(``,!0),a(`button`,{onClick:Je,class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700`},[l(p(fe),{class:`w-4 h-4 mr-2`}),n[1]||=c(` Edit `,-1)])])])]),G.value?(u(),s(`div`,k,n[2]||=[a(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mr-4`},null,-1),a(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading customer details...`,-1)])):K.value?(u(),s(`div`,A,[a(`div`,j,[l(p(te),{class:`w-6 h-6 text-red-500 mr-3`}),a(`div`,null,[n[3]||=a(`h3`,{class:`text-lg font-medium text-red-800 dark:text-red-300`},`Error Loading Customer`,-1),a(`p`,M,h(K.value),1)])])])):W.value?(u(),s(`div`,N,[l(y,{title:`General Information`},{default:d(()=>[l(v,{label:`Customer Name`,value:W.value.name},null,8,[`value`]),l(v,{label:`Code`,value:W.value.code},null,8,[`value`]),l(v,{label:`Type`,value:W.value.customer_type?.name},null,8,[`value`]),l(v,{label:`Group`,value:W.value.customer_group?.name},null,8,[`value`]),l(v,{label:`Opening Balance`,value:p(_)(W.value.opening_balance)},null,8,[`value`]),l(v,{label:`Current Balance`,value:p(_)(W.value.current_balance)},null,8,[`value`]),l(v,{label:`Credit Limit`,value:p(_)(W.value.credit_limit)},null,8,[`value`]),l(v,{label:`MOF #`,value:W.value.mof_tax_number},null,8,[`value`]),l(v,{label:`Status`},{default:d(()=>[a(`span`,{class:m([`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium`,W.value.is_active?`bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300`:`bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300`])},h(W.value.is_active?`Active`:`Inactive`),3)]),_:1})]),_:1}),l(y,{title:`Contact Information`},{default:d(()=>[l(v,{label:`Address`,value:W.value.address,class:`sm:col-span-3`},null,8,[`value`]),l(v,{label:`Contact Person`,value:W.value.contact_name},null,8,[`value`]),l(v,{label:`City`,value:W.value.city},null,8,[`value`]),l(v,{label:`Province`,value:W.value.customer_province?.name},null,8,[`value`]),l(v,{label:`GPS`,value:W.value.gps_coordinates},null,8,[`value`]),l(v,{label:`Zone`,value:W.value.customer_zone?.name},null,8,[`value`]),l(v,{label:`Telephone`},{default:d(()=>[W.value.telephone?(u(),s(`a`,{key:0,href:`tel:${W.value.telephone}`,class:`text-indigo-600 hover:text-indigo-500`},h(W.value.telephone),9,P)):(u(),s(`span`,F,`No telephone number`))]),_:1}),l(v,{label:`Mobile`},{default:d(()=>[W.value.mobile?(u(),s(`a`,{key:0,href:`tel:${W.value.mobile}`,class:`text-indigo-600 hover:text-indigo-500`},h(W.value.mobile),9,I)):(u(),s(`span`,L,`No mobile number`))]),_:1}),l(v,{label:`Email`},{default:d(()=>[W.value.email?(u(),s(`a`,{key:0,href:`mailto:${W.value.email}`,class:`text-indigo-600 hover:text-indigo-500`},h(W.value.email),9,R)):(u(),s(`span`,z,`No email`))]),_:1})]),_:1}),l(y,{title:`Sales Information`,gridCols:`cols-3`},{default:d(()=>[l(v,{label:`Salesperson`,value:W.value.salesperson?`${W.value.salesperson.name} (${W.value.salesperson.code})`:null},null,8,[`value`]),l(v,{label:`Payment Term`,value:W.value.customer_payment_term?.name},null,8,[`value`]),l(v,{label:`Price List INV`,value:W.value.price_list_INV?`${W.value.price_list_INV.code}`:null},null,8,[`value`]),l(v,{label:`Price List INX`,value:W.value.price_list_INX?`${W.value.price_list_INX.code}`:null},null,8,[`value`]),l(v,{label:`Discount Percentage`,value:W.value.discount_percentage?`${W.value.discount_percentage}%`:null},null,8,[`value`]),l(v,{label:`Notes`,value:W.value.notes,class:`sm:col-span-2`},null,8,[`value`])]),_:1}),W.value.documents&&W.value.documents.length>0?(u(),s(`div`,B,[a(`div`,me,[a(`div`,he,[a(`h3`,ge,` Documents (`+h(W.value.documents.length)+`) `,1)])]),a(`div`,_e,[a(`div`,ve,[(u(!0),s(ie,null,le(W.value.documents,t=>(u(),s(`div`,{key:t.id,class:`relative group bg-gray-50 dark:bg-gray-700 rounded-lg p-4 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors`},[a(`div`,ye,[a(`div`,be,[(u(),oe(ue(Qe(t.file_extension)),{class:`h-8 w-8 text-gray-400`}))]),a(`div`,xe,[a(`p`,Se,h(t.title||t.original_name),1),a(`p`,Ce,h(t.file_size_human),1),a(`p`,we,h(p(g)(t.created_at)),1)]),a(`div`,V,[a(`div`,Te,[Xe(t)?(u(),s(`button`,{key:0,onClick:e=>Ye(t),class:`text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300`,title:`Preview`},[l(p(i),{class:`h-5 w-5`})],8,Ee)):o(``,!0),a(`button`,{onClick:e=>X(t),class:`text-indigo-600 hover:text-indigo-500 dark:text-indigo-400 dark:hover:text-indigo-300`,title:`Download`},[l(p(e),{class:`h-5 w-5`})],8,De)])])])]))),128))])])])):(u(),s(`div`,Oe,[n[6]||=a(`div`,{class:`px-6 py-5 border-b border-gray-200 dark:border-gray-700`},[a(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-gray-100`},` Documents `)],-1),a(`div`,ke,[l(p(r),{class:`mx-auto h-12 w-12 text-gray-400`}),n[4]||=a(`h3`,{class:`mt-4 text-sm font-medium text-gray-900 dark:text-gray-100`},`No documents`,-1),n[5]||=a(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},` No documents have been uploaded for this customer. `,-1)])])),l(pe,{item:W.value,formatDateTime:p(g)},null,8,[`item`,`formatDateTime`])])):o(``,!0),q.value?(u(),s(`div`,Ae,[a(`div`,je,[a(`div`,{class:`fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity`,onClick:Z}),a(`div`,Me,[a(`div`,Ne,[a(`button`,{onClick:Z,class:`bg-white dark:bg-gray-800 rounded-md text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none`},[l(p(de),{class:`h-6 w-6`})])]),a(`div`,Pe,[a(`h3`,Fe,h(J.value?.title||J.value?.original_name),1),J.value&&Q(J.value)?(u(),s(`div`,Ie,[Y.value?(u(),s(`img`,{key:0,src:Y.value,alt:J.value.original_name,class:`max-w-full h-auto mx-auto rounded-lg shadow-lg`},null,8,Le)):(u(),s(`div`,Re,n[7]||=[a(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mr-4`},null,-1),a(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading preview...`,-1)]))])):J.value&&$(J.value)?(u(),s(`div`,ze,[Y.value?(u(),s(`iframe`,{key:0,src:Y.value,class:`w-full h-full border rounded-lg`,title:`PDF Preview`,frameborder:`0`},null,8,Be)):(u(),s(`div`,Ve,n[8]||=[a(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mr-4`},null,-1),a(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading preview...`,-1)]))])):(u(),s(`div`,He,[l(p(r),{class:`mx-auto h-12 w-12 text-gray-400 mb-4`}),n[9]||=a(`p`,{class:`text-gray-500 dark:text-gray-400`},`Preview not available for this file type.`,-1)]))]),a(`div`,Ue,[a(`button`,{onClick:n[0]||=e=>X(J.value),class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700`},[l(p(e),{class:`h-4 w-4 mr-2`}),n[10]||=c(` Download `,-1)]),a(`button`,{onClick:Z,class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600`},` Close `)])])])])):o(``,!0)]))}}),U=H;export{U as default};
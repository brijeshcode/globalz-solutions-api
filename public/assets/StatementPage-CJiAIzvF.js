import{B as e,K as t,U as n,aA as r,aH as i,aL as ee,aN as a,aO as o,aR as s,aT as te,aU as c,aV as ne,aX as re,aZ as l,a_ as ie,av as ae,az as oe,b4 as se,b5 as u,b7 as d,b8 as f,b9 as ce,bb as p,u as le,z as m}from"./index-KopOJhzy.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-jdfVzp2e.js";import{b as ue}from"./PageHeader-BUdMn1ih.js";import{c as de}from"./common-CAcZd9q3.js";import{b as h}from"./StatCard-CUVqcoit.js";import{b as g}from"./currencyUtil-4fjG38Kn.js";import{b as fe}from"./customersStore-C-iO_UKl.js";const _={class:`space-y-6`},v=[`disabled`],y={class:`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6`},b={class:`bg-white dark:bg-gray-800 shadow rounded-lg p-4`},x={class:`grid grid-cols-1 md:grid-cols-6 gap-4`},S={class:`md:col-span-2`},C={class:`relative`},w={class:`bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden`},T={key:0,class:`p-8 text-center`},E={key:1,class:`p-8 text-center`},D={class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},O={key:2,class:`overflow-x-auto`},k={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},A={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},j={class:`px-4 py-1 whitespace-nowrap`},M={class:`text-sm text-gray-900 dark:text-white`},N={class:`px-4 py-1 whitespace-nowrap`},P={class:`px-4 py-1 whitespace-nowrap`},F=[`onClick`],I={key:1,class:`text-sm text-gray-900 dark:text-white`},pe={class:`px-4 py-1 whitespace-nowrap`},L={class:`text-sm text-gray-900 dark:text-white`},R={class:`px-4 py-1 whitespace-nowrap text-right`},z={class:`text-sm font-medium text-red-600 dark:text-red-400`},B={class:`px-4 py-1 whitespace-nowrap text-right`},me={class:`text-sm font-medium text-green-600 dark:text-green-400`},he={class:`px-4 py-1 whitespace-nowrap text-right`};var V=ne({__name:`StatementPage`,setup(ne){let V=oe(),H=r(),ge=ae(),U=fe(),W=a(()=>parseInt(V.params.id)),G=d(!1),K=d([]),q=d([]),J=d(``),Y=d(null),X=d({search:``,from_date:``,to_date:``,transaction_type:``,withPage:!1}),Z=async()=>{try{G.value=!0;let e=await U.fetchCustomerStatements(W.value,X.value);console.log(e),K.value=e.data,q.value=e.stats}catch(e){ge.error(`Failed to load customer statements`,{title:`Error`}),console.error(`Error fetching statements:`,e)}finally{G.value=!1}},_e=()=>{Y.value&&clearTimeout(Y.value),Y.value=setTimeout(()=>{Z()},300)},Q=()=>{Z()},ve=()=>{X.value={search:``,from_date:``,to_date:``,transaction_type:``,withPage:!1},Z()},ye=e=>{let t={sales:`Sales`,payments:`Payment`,credit_note:`Credit Note`,debit_note:`Debit Note`,returns:`Return`};return t[e]||e},be=async()=>{try{let e=await U.fetchCustomer(W.value);J.value=e.name}catch(e){console.error(`Error fetching customer details:`,e)}},xe=()=>{H.push({name:`customers.statement.preview`,params:{id:W.value},query:{from_date:X.value.from_date,to_date:X.value.to_date,search:X.value.search,transaction_type:X.value.transaction_type}})},$=e=>{if(!e.id||!e.transaction_type)return;let t={sale:`sales.show`,payment:`customer.payments.show`,credit_debit_note:`customer.notes.show`,customer_returns:`customer.return.show`},n=t[e.transaction_type];if(!n)return;let r=H.resolve({name:n,params:{id:e.id}});window.open(r.href,`_blank`)};return re(async()=>{try{await Promise.all([be(),Z()])}catch(e){console.error(`Error loading initial data:`,e)}}),(r,a)=>(l(),s(`div`,_,[c(ue,{title:`Customer Statement - ${J.value}`,description:`View customer transaction history including sales, payments, and notes`,showCreateButton:!1},{actions:se(()=>[o(`button`,{onClick:xe,disabled:K.value.length===0,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},[c(f(e),{class:`w-4 h-4 mr-2`}),a[3]||=te(` Print Preview `,-1)],8,v)]),_:1},8,[`title`]),o(`div`,y,[c(h,{label:`Balance`,value:f(g)(q.value.balance),icon:f(m),"icon-color":`blue`},null,8,[`value`,`icon`]),c(h,{label:`Credit`,value:f(g)(q.value.total_credit),icon:f(m),"icon-color":`green`},null,8,[`value`,`icon`]),c(h,{label:`Debit`,value:f(g)(q.value.total_debit),icon:f(m),"icon-color":`red`},null,8,[`value`,`icon`])]),o(`div`,b,[o(`div`,x,[o(`div`,S,[a[4]||=o(`label`,{for:`search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Search `,-1),o(`div`,C,[u(o(`input`,{id:`search`,"onUpdate:modelValue":a[0]||=e=>X.value.search=e,type:`text`,placeholder:`Search note...`,class:`block w-full px-3 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 sm:text-sm transition-colors duration-200`,onInput:_e},null,544),[[i,X.value.search]]),c(f(le),{class:`absolute left-3 top-2.5 h-5 w-5 text-gray-400`})])]),o(`div`,null,[a[5]||=o(`label`,{for:`from_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` From Date `,-1),u(o(`input`,{id:`from_date`,"onUpdate:modelValue":a[1]||=e=>X.value.from_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:Q},null,544),[[i,X.value.from_date]])]),o(`div`,null,[a[6]||=o(`label`,{for:`to_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` To Date `,-1),u(o(`input`,{id:`to_date`,"onUpdate:modelValue":a[2]||=e=>X.value.to_date=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:Q},null,544),[[i,X.value.to_date]])]),o(`div`,{class:`flex items-end`},[o(`button`,{onClick:ve,class:`w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200`},` Clear `)])])]),o(`div`,w,[G.value?(l(),s(`div`,T,[c(f(t),{class:`h-8 w-8 animate-spin mx-auto text-blue-600 dark:text-blue-400`}),a[7]||=o(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},`Loading statements...`,-1)])):K.value.length===0?(l(),s(`div`,E,[c(f(n),{class:`h-12 w-12 mx-auto text-gray-400`}),a[8]||=o(`h3`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},` No statements found `,-1),o(`p`,D,p(X.value.search||X.value.transaction_type?`Try adjusting your search criteria.`:`No transactions available for this customer.`),1)])):(l(),s(`div`,O,[o(`table`,k,[a[9]||=o(`thead`,{class:`bg-gray-50 dark:bg-gray-700`},[o(`tr`,null,[o(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Date `),o(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Type `),o(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Transaction ID `),o(`th`,{class:`px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Note `),o(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Debit `),o(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Credit `),o(`th`,{class:`px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},` Balance `)])],-1),o(`tbody`,A,[(l(!0),s(ee,null,ie(K.value,e=>(l(),s(`tr`,{key:e.id,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[o(`td`,j,[o(`div`,M,p(f(de)(e.date)),1)]),o(`td`,N,p(ye(e.type)),1),o(`td`,P,[e.code?(l(),s(`div`,{key:0,onClick:t=>$(e),class:`text-sm text-blue-600 dark:text-blue-400 cursor-zoom-in hover:underline`},p(e.code),9,F)):(l(),s(`div`,I,` - `))]),o(`td`,pe,[o(`div`,L,p(e.note||`-`),1)]),o(`td`,R,[o(`div`,z,p(e.debit?f(g)(e.debit,!0):`-`),1)]),o(`td`,B,[o(`div`,me,p(e.credit?f(g)(e.credit,!0):`-`),1)]),o(`td`,he,[o(`div`,{class:ce([`text-sm font-medium`,e.balance>=0?`text-green-600 dark:text-green-400`:`text-red-600 dark:text-red-400`])},p(f(g)(e.balance,!0)),3)])]))),128))])])]))])]))}}),H=V;export{H as default};
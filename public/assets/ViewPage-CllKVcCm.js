import{D as e,Q as t,R as n,T as r,U as i,_ as ee,a$ as a,aB as o,aC as s,aE as c,aF as l,aG as u,aH as d,aI as f,aK as p,aL as m,aM as te,aO as ne,aQ as h,aR as g,aU as _,aX as v,a_ as y,aa as re,ab as ie,aq as ae,ar as b,b0 as oe,b2 as x,h as se}from"./index--pi_6MVY.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-BFc6-TYF.js";import{d as S,g as ce}from"./common-DNevajli.js";import{b as C}from"./DataItems-D-y3rgaf.js";import{b as le,c as w}from"./SystemInfoCard-CFLfl7hq.js";import{b as T}from"./documentService-ZOfvKLiZ.js";import{c as ue}from"./itemsStore-uQgaAoMD.js";const de={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8`},fe={class:`max-w-4xl mx-auto`},pe={class:`mb-8`},me={class:`flex items-center justify-between mb-2`},he={class:`flex items-center space-x-4`},ge={class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},_e={key:0,class:`flex items-center space-x-3`},ve={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg p-8`},ye={key:1,class:`space-y-6`},E={class:`flex items-center justify-between`},D={class:`text-sm text-gray-500 dark:text-gray-400`},O={class:`col-span-3 grid grid-cols-3`},k={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},A={class:`px-6 py-6`},j={class:`text-lg font-medium text-gray-900 dark:text-white mb-6`},M={key:0,class:`mb-8`},N={class:`text-md font-medium text-gray-700 dark:text-gray-300 mb-4`},P={class:`grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4`},be={class:`aspect-square overflow-hidden rounded-lg bg-gray-200 dark:bg-gray-700`},xe=[`src`,`alt`,`onClick`,`onLoad`],Se={key:0,class:`absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-gray-600`},Ce={class:`mt-2`},we={class:`text-xs text-gray-500 dark:text-gray-400 truncate`},Te={class:`text-xs text-gray-400 dark:text-gray-500`},Ee={class:`absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-25 transition-all duration-200 rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100`},De={class:`flex space-x-2`},Oe=[`onClick`],ke=[`onClick`],Ae={key:1},je={class:`text-md font-medium text-gray-700 dark:text-gray-300 mb-4`},Me={class:`grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3`},Ne={class:`flex items-start space-x-3`},Pe={class:`flex-shrink-0`},Fe={key:0,class:`w-12 h-12 relative`},Ie=[`src`,`alt`],Le={key:1,class:`w-12 h-12 flex items-center justify-center bg-gray-200 dark:bg-gray-600 rounded`},Re={class:`flex-1 min-w-0`},ze={class:`text-sm font-medium text-gray-900 dark:text-gray-100 truncate`},Be={class:`text-xs text-gray-500 dark:text-gray-400 mt-1`},Ve={class:`text-xs text-gray-500 dark:text-gray-400`},He={class:`flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity`},Ue={class:`flex space-x-2`},We=[`onClick`],Ge=[`onClick`],Ke={key:2,class:`bg-white dark:bg-gray-800 shadow rounded-lg p-8`},qe={class:`flex flex-col items-center`},Je={class:`flex min-h-screen items-center justify-center p-4`},Ye={class:`p-4 border-b border-gray-200 dark:border-gray-700`},Xe={class:`text-lg font-medium text-gray-900 dark:text-gray-100`},Ze={class:`p-4`},Qe={key:0,class:`max-h-[80vh] overflow-auto`},$e=[`src`,`alt`],et={key:1,class:`h-[80vh]`},tt=[`src`],nt={key:2,class:`text-center py-8`},rt={class:`text-lg font-medium text-gray-900 dark:text-gray-100 mb-2`};var F=te({__name:`ViewPage`,setup(te){let F=b(),I=ae(),L=ue(),R=y(!1),z=y(null),B=y({}),V=y(``),H=c(()=>parseInt(I.params.id)),U=c(()=>L.currentItem),W=c(()=>U.value?.documents?U.value.documents.filter(e=>Y(e)):[]),G=c(()=>U.value?.documents?U.value.documents.filter(e=>!Y(e)):[]),it=async()=>{try{R.value=!0,await L.fetchItem(H.value)}catch(e){console.error(`Error loading item:`,e)}finally{R.value=!1}},K=()=>{F.push({name:`items.index`})},at=()=>{F.push({name:`items.edit`,params:{id:H.value.toString()}})},q=e=>{z.value=e,V.value=e.thumbnail_url},J=()=>{z.value=null,V.value=``},Y=e=>{let t=e.file_extension?.toLowerCase();return[`jpg`,`jpeg`,`png`,`gif`,`bmp`,`svg`,`webp`].includes(t||``)},ot=e=>{B.value[e]=!0},st=e=>{let t=e.target;t.style.display=`none`,console.error(`Failed to load image:`,t.src)},ct=async e=>{try{await T.download(e)}catch(t){console.error(`Error downloading document:`,t),window.open(e.download_url,`_blank`)}},lt=e=>{z.value=e,V.value=e.preview_url},X=e=>{let r=e?.toLowerCase();switch(r){case`pdf`:case`doc`:case`docx`:case`xls`:case`xlsx`:case`txt`:return n;case`zip`:case`rar`:return ie;default:return t}},ut=e=>{let t=e.target;t.style.display=`none`},Z=async e=>{try{await T.download(e)}catch(e){console.error(`Error downloading document:`,e)}},Q=e=>e?Number(e).toLocaleString(`en-US`,{minimumFractionDigits:2,maximumFractionDigits:2}):`0.00`,$=e=>e?Number(e).toLocaleString(`en-US`):`0`,dt=e=>e.low_quantity_alert?e.starting_quantity<=e.low_quantity_alert?`text-red-600 dark:text-red-400`:`text-green-600 dark:text-green-400`:`text-gray-900 dark:text-white`,ft=e=>e.low_quantity_alert?e.starting_quantity<=e.low_quantity_alert?`text-red-600 dark:text-red-400`:`text-orange-600 dark:text-orange-400`:`text-gray-500 dark:text-gray-400`;return ne(()=>{it()}),(t,n)=>(h(),f(`div`,de,[l(`div`,fe,[l(`div`,pe,[l(`div`,me,[l(`div`,he,[l(`button`,{onClick:K,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[m(a(re),{class:`w-5 h-5`})]),l(`div`,null,[l(`h2`,ge,x(U.value?`Item: ${U.value.code}`:`Item Details`),1),n[2]||=l(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},` View item information and inventory details `,-1)])]),U.value?(h(),f(`div`,_e,[l(`button`,{onClick:at,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors`},[m(a(e),{class:`w-4 h-4 mr-2`}),n[3]||=p(` Edit Item `,-1)])])):d(``,!0)])]),R.value?(h(),f(`div`,ve,n[4]||=[l(`div`,{class:`flex items-center justify-center`},[l(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-4`}),l(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading item...`)],-1)])):U.value?(h(),f(`div`,ye,[l(`div`,E,[l(`span`,{class:oe([`inline-flex px-3 py-1 text-sm font-semibold rounded-full`,a(ce)(U.value.is_active)])},x(U.value.is_active?`Active`:`Inactive`),3),l(`div`,D,` ID: `+x(U.value.id),1)]),m(w,{title:`Basic Information`,gridCols:`cols-2`,data:[{label:`Item Code`,value:U.value.code,mono:!0,darkBG:!0},{label:`Short Name`,value:U.value.code},{label:`Description`,value:U.value.description}]},{default:v(()=>[m(C,{label:`Barcode`,value:U.value.barcode,mono:!0,darkBG:!0,class:`md:col-span-2`},null,8,[`value`])]),_:1},8,[`data`]),m(w,{title:`Classification`},{default:v(()=>[m(C,{label:`Item Type`,value:U.value.item_type?.name,fallback:`No item type set`},null,8,[`value`]),m(C,{label:`Item Unit`,value:U.value.item_unit?.name,fallback:`No item unit set`},null,8,[`value`]),m(C,{label:`Tax Code`,value:U.value.tax_code?`${U.value.tax_code.name} (${U.value.tax_code.rate}%)`:`-`},null,8,[`value`]),m(C,{label:`Item Family`,value:U.value.item_family?.name},null,8,[`value`]),m(C,{label:`Item Category`,value:U.value.item_category?.name},null,8,[`value`]),m(C,{label:`Supplier`,value:U.value.supplier?.name},null,8,[`value`]),m(C,{label:`Profit Margin`,value:U.value.item_profit_margin?.name},null,8,[`value`])]),_:1}),m(w,{title:`Pricing & Inventory`,data:[{label:`Base Cost`,value:`$${Q(U.value.base_cost)}`},{label:`Base Selling Price`,value:`$${Q(U.value.base_sell)}`},{label:`Starting Price`,value:`$${Q(U.value.starting_price)}`},{label:`Current Quantity`,value:`${$(U.value.starting_quantity)}`,valueClass:dt(U.value),mono:!0},{label:`Low Stock Alert`,value:`${$(U.value.low_quantity_alert)}`,valueClass:ft(U.value),mono:!0},{label:`Cost Calculation Method`,value:U.value.cost_calculation===`weighted_average`?`Weighted Average`:`Last Cost`}]},null,8,[`data`]),m(w,{title:`Additional Information`},{default:v(()=>[l(`div`,O,[m(C,{label:`Volume`,mono:!0,value:U.value.volume},null,8,[`value`]),m(C,{label:`Weight`,mono:!0,value:U.value.weight},null,8,[`value`])]),m(C,{class:`col-span-3`,label:`Notes`,value:U.value.notes,darkBG:!0},null,8,[`value`])]),_:1}),U.value.documents&&U.value.documents.length>0?(h(),f(`div`,k,[l(`div`,A,[l(`h3`,j,` Documents (`+x(U.value.documents.length)+`) `,1),W.value.length>0?(h(),f(`div`,M,[l(`h4`,N,` Images (`+x(W.value.length)+`) `,1),l(`div`,P,[(h(!0),f(s,null,g(W.value,e=>(h(),f(`div`,{key:e.id,class:`group relative`},[l(`div`,be,[l(`img`,{src:e.thumbnail_url,alt:e.title||e.original_name||`Product image`,class:`h-full w-full object-cover object-center group-hover:opacity-75 transition-opacity cursor-pointer`,onClick:t=>q(e),onLoad:t=>ot(e.id),onError:st,loading:`lazy`},null,40,xe),B.value[e.id]?d(``,!0):(h(),f(`div`,Se,n[5]||=[l(`div`,{class:`animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600`},null,-1)]))]),l(`div`,Ce,[l(`p`,we,x(e.original_name),1),l(`p`,Te,x(e.file_size_human),1)]),l(`div`,Ee,[l(`div`,De,[l(`button`,{onClick:o(t=>q(e),[`stop`]),class:`p-2 bg-white dark:bg-gray-800 rounded-full shadow-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors`,title:`View Full Size`},[m(a(r),{class:`h-4 w-4 text-gray-700 dark:text-gray-300`})],8,Oe),l(`button`,{onClick:o(t=>ct(e),[`stop`]),class:`p-2 bg-white dark:bg-gray-800 rounded-full shadow-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors`,title:`Download`},[m(a(i),{class:`h-4 w-4 text-gray-700 dark:text-gray-300`})],8,ke)])])]))),128))])])):d(``,!0),G.value.length>0?(h(),f(`div`,Ae,[l(`h4`,je,` Other Files (`+x(G.value.length)+`) `,1),l(`div`,Me,[(h(!0),f(s,null,g(G.value,e=>(h(),f(`div`,{key:e.id,class:`relative group bg-gray-50 dark:bg-gray-700 rounded-lg p-4 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors`},[l(`div`,Ne,[l(`div`,Pe,[e.file_extension?.toLowerCase()===`pdf`?(h(),f(`div`,Fe,[l(`img`,{src:e.thumbnail_url,alt:e.title||e.original_name,class:`w-12 h-12 object-cover rounded border`,onError:ut},null,40,Ie)])):(h(),f(`div`,Le,[(h(),u(_(X(e.file_extension)),{class:`h-6 w-6 text-gray-400`}))]))]),l(`div`,Re,[l(`p`,ze,x(e.title||e.original_name),1),l(`p`,Be,x(e.file_size_human),1),l(`p`,Ve,x(a(S)(e.created_at)),1)]),l(`div`,He,[l(`div`,Ue,[e.file_extension?.toLowerCase()===`pdf`?(h(),f(`button`,{key:0,onClick:t=>lt(e),class:`text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300`,title:`Preview`},[m(a(r),{class:`h-4 w-4`})],8,We)):d(``,!0),l(`button`,{onClick:t=>Z(e),class:`text-indigo-600 hover:text-indigo-500 dark:text-indigo-400 dark:hover:text-indigo-300`,title:`Download`},[m(a(i),{class:`h-4 w-4`})],8,Ge)])])])]))),128))])])):d(``,!0)])])):d(``,!0),m(le,{item:U.value,formatDateTime:a(S)},null,8,[`item`,`formatDateTime`])])):(h(),f(`div`,Ke,[l(`div`,qe,[m(a(ee),{class:`w-12 h-12 text-red-400 mb-4`}),n[6]||=l(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-gray-100 mb-2`},` Item Not Found `,-1),n[7]||=l(`p`,{class:`text-gray-500 dark:text-gray-400 mb-6`},` The item you're looking for could not be found. `,-1),l(`button`,{onClick:K,class:`px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300`},` ← Back to Items `)])]))]),z.value?(h(),f(`div`,{key:0,class:`fixed inset-0 z-50 overflow-y-auto`,onClick:J},[l(`div`,Je,[n[10]||=l(`div`,{class:`fixed inset-0 bg-black opacity-75`},null,-1),l(`div`,{class:`relative bg-white dark:bg-gray-800 rounded-lg max-w-6xl max-h-full w-full`,onClick:n[1]||=o(()=>{},[`stop`])},[l(`button`,{onClick:J,class:`absolute top-4 right-4 z-10 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 bg-white dark:bg-gray-800 rounded-full p-1`},[m(a(se),{class:`w-6 h-6`})]),l(`div`,Ye,[l(`h3`,Xe,x(z.value.title||z.value.original_name),1)]),l(`div`,Ze,[Y(z.value)?(h(),f(`div`,Qe,[l(`img`,{src:V.value||z.value.thumbnail_url,alt:z.value.title||z.value.original_name,class:`max-w-full h-auto mx-auto rounded-lg shadow-lg`},null,8,$e)])):z.value.file_extension?.toLowerCase()===`pdf`?(h(),f(`div`,et,[l(`iframe`,{src:V.value,class:`w-full h-full border rounded-lg`,title:`PDF Preview`,frameborder:`0`},null,8,tt)])):(h(),f(`div`,nt,[(h(),u(_(X(z.value.file_extension)),{class:`mx-auto h-16 w-16 text-gray-400 mb-4`})),l(`h3`,rt,x(z.value.original_name),1),n[9]||=l(`p`,{class:`text-gray-500 dark:text-gray-400 mb-4`},` Preview not available for this file type `,-1),l(`button`,{onClick:n[0]||=e=>Z(z.value),class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700`},[m(a(i),{class:`h-4 w-4 mr-2`}),n[8]||=p(` Download File `,-1)])]))])])])])):d(``,!0)]))}}),I=F;export{I as default};
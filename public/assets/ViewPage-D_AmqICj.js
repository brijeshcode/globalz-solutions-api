import{H as e,M as t,a$ as n,a5 as ee,aB as te,aC as r,aN as ne,aQ as i,aR as a,aS as o,aT as s,aV as c,aW as l,aX as re,aZ as ie,aj as ae,ax as oe,b0 as se,b6 as u,b9 as d,ba as f,bb as p,bd as m,r as ce,u as le}from"./index-CMapNz1K.js";import{b as ue}from"./useAuth-Df9OqH9_.js";import"./GlobalConfig-wPgXFcZ5.js";import"./tableUtils-ylneqlK-.js";import{b as de}from"./ConfirmationModal-CjEx_yoN.js";import"./common-qdv5PS_C.js";import"./Modal-BSVKcovw.js";import{b as h,d as fe}from"./currencyUtil-CkSyUQEZ.js";import{b as g}from"./DataItems-Dbv5cekm.js";import{b as pe}from"./salesOrderStore-CcuvmNG1.js";import{b as me}from"./SaleOrderApprove-8a8Uxx2a.js";const he={class:`max-w-8xl mx-auto py-2`},ge={class:``},_={class:`mb-8`},v={class:`flex items-center space-x-4 mb-2`},y={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},b={class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},x={class:`flex items-center justify-between`},S={class:`text-lg font-medium text-gray-900 dark:text-white`},C={class:`text-sm text-gray-500 dark:text-gray-400`},w={class:`flex space-x-3`},T={class:`px-6 py-8`},E={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},D={class:`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6`},O={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},k={class:`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6`},A={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},j={key:0,class:`text-center py-8 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg`},M={key:1,class:`overflow-x-auto`},N={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},P={class:`bg-gray-50 dark:bg-gray-700`},F={key:0,class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},I={key:1,class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},L={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},_e={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ve={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ye={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},be={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},xe={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Se={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ce={key:0,class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},we={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Te={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ee={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},De={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Oe={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ke={class:`bg-gray-50 dark:bg-gray-700`},Ae=[`colspan`],je={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Me={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Ne={key:0},Pe=[`colspan`],Fe={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Ie={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Le={key:0,class:`px-6 py-4`},Re={class:`bg-green-50 dark:bg-green-900`},ze=[`colspan`],Be={class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},Ve={class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},He={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},Ue={class:`grid grid-cols-1 md:grid-cols-3 gap-6`},We={class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},Ge={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},Ke={class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},qe={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},Je={class:`mt-1 text-lg font-medium`},Ye={key:0,class:`mb-6`},Xe={class:`bg-gray-50 dark:bg-gray-700 rounded-lg p-4`},Ze={class:`text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap`},Qe={class:`pt-6 border-t border-gray-200 dark:border-gray-700`},$e={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},et={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},tt={class:`px-6 py-8 text-center`};var R=re({__name:`ViewPage`,setup(re){let R=r(),z=te(),B=oe(),V=pe(),{isSalesman:H,isAdmin:U}=ue(),W=parseInt(z.params.id),G=d(!0),K=d({}),q=d(!1),J=d(!1),Y=d(!1),nt=()=>{R.push({name:`salesOrder.index`})},rt=()=>{R.push({name:`salesOrder.edit`,params:{id:W.toString()}})},it=()=>{J.value=!0},at=()=>{J.value=!1,B.success(`Sale order approved successfully`),R.push({name:`salesOrder.index`})},ot=()=>{q.value=!0},st=()=>{q.value=!1,Y.value=!1},X=async()=>{Y.value=!0;try{await V.deleteSaleOrder(W),B.success(`Sale order deleted successfully`),R.push({name:`salesOrder.index`})}catch{B.error(`Failed to delete sale order`)}finally{Y.value=!1}},ct=async()=>{try{G.value=!0,K.value=await V.fetchSaleOrder(W)}catch(e){console.error(`Error loading sale order:`,e),B.error(`Failed to load sale order details`),R.push({name:`salesOrder.index`})}finally{G.value=!1}},Z=e=>{let t=Number(e||0);return t>0?`text-green-600 dark:text-green-400 font-medium`:t<0?`text-red-600 dark:text-red-400 font-medium`:`text-gray-600 dark:text-gray-400`},lt=e=>{let t=Number(e||0);return t>0?`bg-green-50 dark:bg-green-900 text-green-600 dark:text-green-400`:t<0?`bg-red-50 dark:bg-red-900 text-red-600 dark:text-red-400`:`bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-400`},Q=e=>e?parseFloat(Number(e).toFixed(2)).toString():`0`,ut=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleDateString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`})},$=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`})};return ie(async()=>{await ct()}),(te,r)=>(n(),s(`div`,he,[i(`div`,ge,[i(`div`,_,[i(`div`,v,[i(`button`,{onClick:nt,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[l(f(ae),{class:`w-5 h-5`})]),r[2]||=i(`div`,null,[i(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},` Sale Order Details `),i(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},` View sale order information `)],-1)])]),G.value?(n(),s(`div`,et,[i(`div`,tt,[l(f(t),{class:`w-8 h-8 animate-spin mx-auto text-blue-600`}),r[28]||=i(`p`,{class:`mt-2 text-gray-600 dark:text-gray-400`},`Loading sale order details...`,-1)])])):(n(),s(`div`,y,[i(`div`,b,[i(`div`,x,[i(`div`,null,[i(`h3`,S,m(K.value.prefix)+`-`+m(K.value.code),1),i(`p`,C,` Sale Order ID: `+m(K.value.id),1),r[3]||=i(`span`,{class:`inline-flex mt-2 items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200`},` Pending Approval `,-1)]),i(`div`,w,[f(U)?(n(),s(`button`,{key:0,onClick:it,class:`inline-flex items-center px-3 py-2 border border-green-300 dark:border-green-600 text-sm font-medium rounded-md text-green-700 dark:text-green-300 bg-white dark:bg-gray-800 hover:bg-green-50 dark:hover:bg-green-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200`},[l(f(ee),{class:`w-4 h-4 mr-2`}),r[4]||=c(` Approve `,-1)])):o(``,!0),i(`button`,{onClick:rt,class:`inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200`},[l(f(e),{class:`w-4 h-4 mr-2`}),r[5]||=c(` Edit `,-1)]),i(`button`,{onClick:ot,class:`inline-flex items-center px-3 py-2 border border-red-300 dark:border-red-600 text-sm font-medium rounded-md text-red-700 dark:text-red-300 bg-white dark:bg-gray-800 hover:bg-red-50 dark:hover:bg-red-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200`},[l(f(ce),{class:`w-4 h-4 mr-2`}),r[6]||=c(` Delete `,-1)])])])]),i(`div`,T,[i(`div`,E,[r[7]||=i(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Basic Information `,-1),i(`div`,D,[l(g,{label:`Order Date`,value:ut(K.value.date)},null,8,[`value`]),l(g,{label:`Customer`,value:K.value.customer?.name},null,8,[`value`]),l(g,{label:`Salesperson`,value:K.value.salesperson?.name||`-`},null,8,[`value`]),l(g,{label:`Warehouse`,value:K.value.warehouse?.name},null,8,[`value`]),l(g,{label:`Currency`,value:`${K.value.currency?.code} - ${K.value.currency?.name}`},null,8,[`value`]),f(fe)(K.value.currency.code)?o(``,!0):(n(),a(g,{key:0,label:`Currency Rate`,value:Q(K.value.currency_rate)},null,8,[`value`]))])]),i(`div`,O,[r[8]||=i(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Financial Summary `,-1),i(`div`,k,[l(g,{label:`Sub Total`,value:f(h)(K.value.sub_total,!0,K.value.currency)},null,8,[`value`]),l(g,{label:`Sub Total (USD)`,value:f(h)(K.value.sub_total_usd,!0)},null,8,[`value`]),l(g,{label:`Discount Amount`,value:f(h)(K.value.discount_amount,!0,K.value.currency)},null,8,[`value`]),f(H)?o(``,!0):(n(),a(g,{key:0,label:`Total Profit`},{default:u(()=>[i(`div`,{class:p([`text-sm`,Z(K.value.total_profit)])},m(f(h)(K.value.total_profit,!0)),3)]),_:1}))])]),i(`div`,A,[r[22]||=i(`div`,{class:`flex items-center justify-between mb-4`},[i(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white`},` Sale Order Items `)],-1),K.value.items&&K.value.items.length===0?(n(),s(`div`,j,[l(f(le),{class:`mx-auto h-12 w-12 text-gray-400`}),r[9]||=i(`h5`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},`No items found`,-1),r[10]||=i(`p`,{class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},`This sale order has no items.`,-1)])):(n(),s(`div`,M,[i(`table`,N,[i(`thead`,P,[i(`tr`,null,[r[11]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`#`,-1),r[12]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Code`,-1),r[13]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Item`,-1),r[14]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Unit`,-1),r[15]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[i(`abbr`,{title:`Total Quantity`},`QTY`)],-1),r[16]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Sale Price`,-1),f(U)?(n(),s(`th`,F,`Cost Price`)):o(``,!0),r[17]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[i(`abbr`,{title:`Discount Percentage`},`Dis. %`)],-1),r[18]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[i(`abbr`,{title:`Tax Percentage`},`Tax %`)],-1),r[19]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[i(`abbr`,{title:`Tax-inclusive Price`},`TTC`)],-1),r[20]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Total`,-1),r[21]||=i(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`USD`,-1),f(H)?o(``,!0):(n(),s(`th`,I,`Profit`))])]),i(`tbody`,L,[(n(!0),s(ne,null,se(K.value.items,(e,t)=>(n(),s(`tr`,{key:t,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[i(`td`,_e,m(t+1),1),i(`td`,ve,m(e.item.code),1),i(`td`,ye,m(e.item?.description),1),i(`td`,be,m(e.item?.unit?.name||`-`),1),i(`td`,xe,m(Q(e.quantity)),1),i(`td`,Se,m(f(h)(e.price,!0,K.value.currency)),1),f(U)?(n(),s(`td`,Ce,m(f(h)(e.cost_price,!0)),1)):o(``,!0),i(`td`,we,m(Q(e.discount_percent))+`%`,1),i(`td`,Te,m(Q(e.tax_percent))+`%`,1),i(`td`,Ee,m(f(h)(e.ttc_price,!0,K.value.currency)),1),i(`td`,De,m(f(h)(e.total_price,!0,K.value.currency)),1),i(`td`,Oe,m(f(h)(e.total_price_usd,!0)),1),f(H)?o(``,!0):(n(),s(`td`,{key:1,class:p([`px-6 py-4 whitespace-nowrap text-sm`,Z(e.total_profit)])},m(f(h)(e.total_profit,!0)),3))]))),128))]),i(`tfoot`,ke,[i(`tr`,null,[i(`td`,{colspan:f(U)?10:9,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Sub Total:`,8,Ae),i(`td`,je,m(f(h)(K.value.sub_total,!0,K.value.currency)),1),i(`td`,Me,m(f(h)(K.value.sub_total_usd,!0)),1),f(H)?o(``,!0):(n(),s(`td`,{key:0,class:p([`px-6 py-4 text-sm font-medium`,Z(K.value.total_profit)])},m(f(h)(K.value.total_profit,!0)),3))]),K.value.discount_amount?(n(),s(`tr`,Ne,[i(`td`,{colspan:f(U)?10:9,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Additional Discount:`,8,Pe),i(`td`,Fe,m(f(h)(K.value.discount_amount,!0,K.value.currency)),1),i(`td`,Ie,m(f(h)(K.value.discount_amount_usd,!0)),1),f(H)?o(``,!0):(n(),s(`td`,Le,`-`))])):o(``,!0),i(`tr`,Re,[i(`td`,{colspan:f(U)?10:9,class:`px-6 py-4 text-right text-sm font-bold text-gray-900 dark:text-white`},`Final Total:`,8,ze),i(`td`,Be,m(f(h)(K.value.total,!0,K.value.currency)),1),i(`td`,Ve,m(f(h)(K.value.total_usd,!0)),1),f(H)?o(``,!0):(n(),s(`td`,{key:0,class:p([`px-6 py-4 text-sm font-bold`,Z(K.value.total_profit)])},m(f(h)(K.value.total_profit,!0)),3))])])])]))]),i(`div`,He,[r[26]||=i(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Final Totals `,-1),i(`div`,Ue,[i(`div`,We,[r[23]||=i(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount`,-1),i(`dd`,Ge,m(f(h)(K.value.total,!0,K.value.currency)),1)]),i(`div`,Ke,[r[24]||=i(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount (USD)`,-1),i(`dd`,qe,m(f(h)(K.value.total_usd,!0)),1)]),f(H)?o(``,!0):(n(),s(`div`,{key:0,class:p([`rounded-lg p-4`,lt(K.value.total_profit)])},[r[25]||=i(`dt`,{class:`text-sm font-medium`},`Total Profit (USD)`,-1),i(`dd`,Je,m(f(h)(K.value.total_profit,!0)),1)],2))])]),K.value.note?(n(),s(`div`,Ye,[r[27]||=i(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Notes `,-1),l(g,{label:`Note`},{default:u(()=>[i(`div`,Xe,[i(`p`,Ze,m(K.value.note),1)])]),_:1})])):o(``,!0),i(`div`,Qe,[i(`div`,$e,[l(g,{label:`Created At`,value:$(K.value.created_at)},null,8,[`value`]),l(g,{label:`Last Updated`,value:$(K.value.updated_at)},null,8,[`value`])])])])]))]),l(de,{show:q.value,"onUpdate:show":r[0]||=e=>q.value=e,type:`delete`,title:`Delete Sale Order ${K.value.prefix}-${K.value.code}`,message:`Are you sure you want to delete sale order '${K.value.prefix}-${K.value.code}'? This action can be undone by restoring from trash.`,"confirm-text":`Delete Sale Order`,"loading-text":`Deleting...`,loading:Y.value,onConfirm:X,onCancel:st},null,8,[`show`,`title`,`message`,`loading`]),l(me,{show:J.value,"onUpdate:show":r[1]||=e=>J.value=e,"sale-order":K.value,onApproved:at},null,8,[`show`,`sale-order`])]))}}),z=R;export{z as default};
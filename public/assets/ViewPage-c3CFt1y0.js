import{$ as e,A as t,B as n,C as r,E as i,F as ee,J as te,S as ne,a4 as a,a5 as re,aC as o,aD as s,aE as ie,aG as c,ae,ag as l,ah as u,ai as oe,aj as d,ak as f,am as p,an as m,ao as h,aq as g,ar as se,as as _,at as ce,av as v,aw as le,j as ue,w as de}from"./index-DaMCECFo.js";import"./GlobalConfig-DCFE7Hv9.js";import"./tableUtils-DX_RsmET.js";import{b as y,c as fe,d as b}from"./common-D-kmVZlF.js";import{b as pe}from"./expenseTransactionStore-2t2nC5ho.js";import{b as x}from"./documentService-BV6HRfgW.js";const S=[`stroke-width`];var C=h({__name:`DownloadIcon`,props:{size:{},color:{},stroke:{}},setup(e){let t=e,n=t.size??5,r=t.color??`text-current`,i=t.stroke??1.5;return(e,t)=>(_(),f(`svg`,{xmlns:`http://www.w3.org/2000/svg`,fill:`none`,viewBox:`0 0 24 24`,stroke:`currentColor`,"stroke-width":s(i),class:ie([`w-${s(n)}`,`h-${s(n)}`,s(r)])},t[0]||=[u(`path`,{d:`M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M7 10l5 5 5-5M12 4v12`,"stroke-linecap":`round`,"stroke-linejoin":`round`},null,-1)],10,S))}}),w=C;const T={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8`},E={class:`mb-8`},D={class:`flex items-center justify-between`},O={class:`flex items-center space-x-4`},k={class:`text-3xl font-bold text-gray-900 dark:text-gray-100`},A={class:`text-sm text-gray-600 dark:text-gray-400 mt-1`},j={class:`flex items-center space-x-3`},M={key:0,class:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300`},N={key:0,class:`flex items-center justify-center py-12`},P={key:1,class:`bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6`},F={class:`flex items-center`},I={class:`text-red-600 dark:text-red-400 mt-1`},L={key:2,class:`space-y-8`},R={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},z={class:`px-6 py-5`},B={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2 lg:grid-cols-3`},me={class:`mt-1 text-sm text-gray-900 dark:text-gray-100`},he={class:`mt-1 text-sm font-medium text-blue-600 dark:text-blue-400`},ge={class:`mt-1 text-lg font-semibold text-red-600 dark:text-red-400`},_e={class:`mt-1 text-sm text-gray-900 dark:text-gray-100`},ve={key:0},ye={class:`mt-1 text-sm text-gray-900 dark:text-gray-100`},be={key:1},xe={class:`mt-1 text-sm text-gray-900 dark:text-gray-100`},Se={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},Ce={class:`px-6 py-5`},we={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-3`},Te={key:0},Ee={class:`mt-1 text-sm text-gray-900 dark:text-gray-100`},De={key:1},Oe={class:`mt-1 text-sm text-gray-900 dark:text-gray-100`},ke={key:2},Ae={class:`mt-1 text-sm text-gray-900 dark:text-gray-100`},je={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},Me={class:`px-6 py-5`},Ne={class:`text-sm text-gray-900 dark:text-gray-100 whitespace-pre-wrap`},Pe={key:2,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},Fe={class:`px-6 py-5 border-b border-gray-200 dark:border-gray-700`},Ie={class:`flex items-center justify-between`},Le={class:`text-lg font-medium text-gray-900 dark:text-gray-100`},Re={class:`px-6 py-5`},ze={class:`grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3`},Be={class:`flex items-start space-x-3`},Ve={class:`flex-shrink-0`},He={class:`flex-1 min-w-0`},Ue={class:`text-sm font-medium text-gray-900 dark:text-gray-100 truncate`},We={class:`text-xs text-gray-500 dark:text-gray-400 mt-1`},Ge={class:`text-xs text-gray-500 dark:text-gray-400`},Ke={class:`flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity`},qe={class:`flex space-x-2`},Je=[`onClick`],Ye=[`onClick`],Xe={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},Ze={class:`px-6 py-5`},Qe={class:`grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-2`},$e={class:`mt-1 text-sm text-gray-900 dark:text-gray-100`},et={class:`text-xs text-gray-500 dark:text-gray-400`},tt={key:0},nt={class:`mt-1 text-sm text-gray-900 dark:text-gray-100`},rt={class:`text-xs text-gray-500 dark:text-gray-400`},it={key:3,class:`bg-white dark:bg-gray-800 shadow rounded-lg p-8`},at={class:`text-center`},ot={key:4,class:`fixed inset-0 z-50 overflow-y-auto`,"aria-labelledby":`modal-title`,role:`dialog`,"aria-modal":`true`},st={class:`flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0`},ct={class:`inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full sm:p-6`},lt={class:`absolute top-0 right-0 pt-4 pr-4`},ut={class:`mt-3 text-center sm:mt-5`},dt={class:`text-lg leading-6 font-medium text-gray-900 dark:text-gray-100 mb-4`},ft={key:0,class:`max-h-96 overflow-auto`},pt=[`src`,`alt`],mt={key:1,class:`flex items-center justify-center py-8`},ht={key:1,class:`h-96`},gt=[`src`],_t={key:1,class:`flex items-center justify-center py-8`},vt={key:2,class:`text-center py-8`},yt={class:`mt-5 sm:mt-6 flex justify-center space-x-3`};var V=h({__name:`ViewPage`,setup(ie){let h=re(),S=a(),C=pe(),{showError:V}=e(),H=o(!0),U=o(null),bt=l(()=>Number(S.params.id)),W=o(!1),G=o(null),K=o(``),q=l(()=>C.currentExpenseTransaction),J=async e=>{await x.download(e)},xt=async e=>{try{G.value=e,W.value=!0;let t=await x.preview(e.id);K.value=t.preview_url}catch(t){console.error(`Error getting preview URL:`,t),K.value=St(e)}},Y=()=>{W.value=!1,G.value=null,K.value=``},X=e=>Z(e)||Q(e),Z=e=>{let t=e.file_extension?.toLowerCase();return[`jpg`,`jpeg`,`png`,`gif`,`bmp`,`svg`,`webp`].includes(t||``)},Q=e=>{let t=e.file_extension?.toLowerCase();return t===`pdf`},St=e=>{let t=`https://staging.globalzsolutions.com`;return`${t}/api/documents/${e.id}/preview`},Ct=e=>{let r=e?.toLowerCase();return[`jpg`,`jpeg`,`png`,`gif`,`bmp`,`svg`].includes(r)?de:[`pdf`].includes(r)?n:t},wt=async()=>{try{H.value=!0,U.value=null,await C.fetchExpenseTransaction(bt.value),!C.currentExpenseTransaction&&(U.value=`Transaction not found`)}catch(e){U.value=e.response?.data?.message||`Failed to load transaction details`,V(U.value)}finally{H.value=!1}},Tt=()=>{q.value&&h.push({name:`expenses.transactions.edit`,params:{id:q.value.id}})},$=()=>{h.go(-1)};return g(()=>{wt()}),se(()=>{C.clearCurrentExpenseTransaction()}),(e,t)=>{let n=v(`X`),a=v(`FileTextIcon`);return _(),f(`div`,T,[u(`div`,E,[u(`div`,D,[u(`div`,O,[u(`button`,{onClick:$,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[m(s(ne),{class:`w-5 h-5`})]),u(`div`,null,[u(`h1`,k,c(q.value?.subject||`Expense Transaction Details`),1),u(`p`,A,` Transaction Code: `+c(q.value?.code),1)])]),u(`div`,j,[q.value?(_(),f(`span`,M,[m(s(i),{class:`w-4 h-4 mr-1`}),p(` $`+c(s(y)(q.value.amount)),1)])):d(``,!0),u(`button`,{onClick:Tt,class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700`},[m(s(ue),{class:`w-4 h-4 mr-2`}),t[1]||=p(` Edit `,-1)])])])]),H.value?(_(),f(`div`,N,t[2]||=[u(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mr-4`},null,-1),u(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading transaction details...`,-1)])):U.value?(_(),f(`div`,P,[u(`div`,F,[m(s(te),{class:`w-6 h-6 text-red-500 mr-3`}),u(`div`,null,[t[3]||=u(`h3`,{class:`text-lg font-medium text-red-800 dark:text-red-300`},`Error Loading Transaction`,-1),u(`p`,I,c(U.value),1)])])])):q.value?(_(),f(`div`,L,[u(`div`,R,[t[10]||=u(`div`,{class:`px-6 py-5 border-b border-gray-200 dark:border-gray-700`},[u(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-gray-100`},` Transaction Information `)],-1),u(`div`,z,[u(`dl`,B,[u(`div`,null,[t[4]||=u(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Transaction Date`,-1),u(`dd`,me,c(s(fe)(q.value.date)),1)]),u(`div`,null,[t[5]||=u(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Code`,-1),u(`dd`,he,c(q.value.code),1)]),u(`div`,null,[t[6]||=u(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Amount`,-1),u(`dd`,ge,` $`+c(s(y)(q.value.amount)),1)]),u(`div`,null,[t[7]||=u(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Subject`,-1),u(`dd`,_e,c(q.value.subject||`No subject provided`),1)]),q.value.expense_category?(_(),f(`div`,ve,[t[8]||=u(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Expense Category`,-1),u(`dd`,ye,c(q.value.expense_category.name),1)])):d(``,!0),q.value.account?(_(),f(`div`,be,[t[9]||=u(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Account`,-1),u(`dd`,xe,c(q.value.account.name),1)])):d(``,!0)])])]),q.value.order_number||q.value.check_number||q.value.bank_ref_number?(_(),f(`div`,Se,[t[14]||=u(`div`,{class:`px-6 py-5 border-b border-gray-200 dark:border-gray-700`},[u(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-gray-100`},` Reference Information `)],-1),u(`div`,Ce,[u(`dl`,we,[q.value.order_number?(_(),f(`div`,Te,[t[11]||=u(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Order Number`,-1),u(`dd`,Ee,c(q.value.order_number),1)])):d(``,!0),q.value.check_number?(_(),f(`div`,De,[t[12]||=u(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Check Number`,-1),u(`dd`,Oe,c(q.value.check_number),1)])):d(``,!0),q.value.bank_ref_number?(_(),f(`div`,ke,[t[13]||=u(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Bank Reference`,-1),u(`dd`,Ae,c(q.value.bank_ref_number),1)])):d(``,!0)])])])):d(``,!0),q.value.note?(_(),f(`div`,je,[t[15]||=u(`div`,{class:`px-6 py-5 border-b border-gray-200 dark:border-gray-700`},[u(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-gray-100`},` Notes `)],-1),u(`div`,Me,[u(`p`,Ne,c(q.value.note),1)])])):d(``,!0),q.value.documents&&q.value.documents.length>0?(_(),f(`div`,Pe,[u(`div`,Fe,[u(`div`,Ie,[u(`h3`,Le,` Documents (`+c(q.value.documents.length)+`) `,1)])]),u(`div`,Re,[u(`div`,ze,[(_(!0),f(ae,null,ce(q.value.documents,e=>(_(),f(`div`,{key:e.id,class:`relative group bg-gray-50 dark:bg-gray-700 rounded-lg p-4 hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors`},[u(`div`,Be,[u(`div`,Ve,[(_(),oe(le(Ct(e.file_extension)),{class:`h-8 w-8 text-gray-400`}))]),u(`div`,He,[u(`p`,Ue,c(e.title||e.original_name),1),u(`p`,We,c(e.file_size_human),1),u(`p`,Ge,c(s(b)(e.created_at)),1)]),u(`div`,Ke,[u(`div`,qe,[X(e)?(_(),f(`button`,{key:0,onClick:t=>xt(e),class:`text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300`,title:`Preview`},[m(s(r),{class:`h-5 w-5`})],8,Je)):d(``,!0),u(`button`,{onClick:t=>J(e),class:`text-indigo-600 hover:text-indigo-500 dark:text-indigo-400 dark:hover:text-indigo-300`,title:`Download`},[m(w,{class:`h-5 w-5`})],8,Ye)])])])]))),128))])])])):d(``,!0),u(`div`,Xe,[t[18]||=u(`div`,{class:`px-6 py-5 border-b border-gray-200 dark:border-gray-700`},[u(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-gray-100`},` System Information `)],-1),u(`div`,Ze,[u(`dl`,Qe,[u(`div`,null,[t[16]||=u(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Created By`,-1),u(`dd`,$e,[u(`div`,null,c(q.value.created_by?.name||`Unknown`),1),u(`div`,et,c(s(b)(q.value.created_at)),1)])]),q.value.updated_by?(_(),f(`div`,tt,[t[17]||=u(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Last Updated By`,-1),u(`dd`,nt,[u(`div`,null,c(q.value.updated_by.name),1),u(`div`,rt,c(s(b)(q.value.updated_at)),1)])])):d(``,!0)])])])])):(_(),f(`div`,it,[u(`div`,at,[m(s(ee),{class:`h-12 w-12 mx-auto text-gray-400`}),t[19]||=u(`h3`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-2`},` Transaction Not Found `,-1),t[20]||=u(`p`,{class:`text-gray-600 dark:text-gray-400 mb-4`},` The expense transaction you're looking for could not be found. `,-1),u(`button`,{onClick:$,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`},` Go Back `)])])),W.value?(_(),f(`div`,ot,[u(`div`,st,[u(`div`,{class:`fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity`,onClick:Y}),u(`div`,ct,[u(`div`,lt,[u(`button`,{onClick:Y,class:`bg-white dark:bg-gray-800 rounded-md text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none`},[m(n,{class:`h-6 w-6`})])]),u(`div`,ut,[u(`h3`,dt,c(G.value?.title||G.value?.original_name),1),G.value&&Z(G.value)?(_(),f(`div`,ft,[K.value?(_(),f(`img`,{key:0,src:K.value,alt:G.value.original_name,class:`max-w-full h-auto mx-auto rounded-lg shadow-lg`},null,8,pt)):(_(),f(`div`,mt,t[21]||=[u(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mr-4`},null,-1),u(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading preview...`,-1)]))])):G.value&&Q(G.value)?(_(),f(`div`,ht,[K.value?(_(),f(`iframe`,{key:0,src:K.value,class:`w-full h-full border rounded-lg`,title:`PDF Preview`,frameborder:`0`},null,8,gt)):(_(),f(`div`,_t,t[22]||=[u(`div`,{class:`animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mr-4`},null,-1),u(`span`,{class:`text-gray-600 dark:text-gray-400`},`Loading preview...`,-1)]))])):(_(),f(`div`,vt,[m(a,{class:`mx-auto h-12 w-12 text-gray-400 mb-4`}),t[23]||=u(`p`,{class:`text-gray-500 dark:text-gray-400`},`Preview not available for this file type.`,-1)]))]),u(`div`,yt,[u(`button`,{onClick:t[0]||=e=>J(G.value),class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700`},[m(w,{class:`h-4 w-4 mr-2`}),t[24]||=p(` Download `,-1)]),u(`button`,{onClick:Y,class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600`},` Close `)])])])])):d(``,!0)])}}}),H=V;export{H as default};
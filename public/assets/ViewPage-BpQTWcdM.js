import{A as e,E as t,J as ee,aH as te,aK as n,aL as r,aM as i,aN as a,aP as o,aQ as s,aR as ne,aT as c,aV as l,aW as re,ae as ie,ar as ae,av as oe,aw as se,b0 as u,b3 as d,b4 as f,b5 as p,b7 as m,p as ce,r as le}from"./index-vBZhi31r.js";import{b as ue}from"./useAuth-DskgwgXQ.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-BFc6-TYF.js";import{b as de}from"./ConfirmationModal-CXC2hr5E.js";import{b as h,d as g}from"./currencyUtil-CPvVg_gg.js";import{b as _}from"./DataItems-BbjZj-0D.js";import{b as fe}from"./salesStore-DU7nSzFZ.js";const pe={class:`max-w-8xl mx-auto py-2`},me={class:``},v={class:`mb-8`},y={class:`flex items-center space-x-4 mb-2`},b={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},x={class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},S={class:`flex items-center justify-between`},C={class:`text-lg font-medium text-gray-900 dark:text-white`},w={class:`text-sm text-gray-500 dark:text-gray-400`},T={class:`flex space-x-3`},E={class:`px-6 py-8`},D={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},O={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6`},k={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-4`},A={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},j={class:`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-6`},M={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},N={key:0,class:`text-center py-8 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg`},P={key:1,class:`overflow-x-auto`},F={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},I={class:`bg-gray-50 dark:bg-gray-700`},L={key:0,class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},R={key:1,class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},z={key:2,class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},he={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},ge={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},_e={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ve={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ye={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},be={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},xe={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Se={key:0,class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ce={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},we={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Te={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ee={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},De={key:1,class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Oe={class:`bg-gray-50 dark:bg-gray-700`},ke=[`colspan`],B={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Ae={key:0,class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},je={key:0},Me=[`colspan`],Ne={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Pe={key:0,class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Fe={key:1,class:`px-6 py-4`},Ie={class:`bg-green-50 dark:bg-green-900`},Le=[`colspan`],Re={class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},ze={key:0,class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},Be={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},Ve={class:`grid grid-cols-1 md:grid-cols-3 gap-6`},He={class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},Ue={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},We={key:0,class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},Ge={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},Ke={class:`mt-1 text-lg font-medium`},qe={key:0,class:`mb-6`},Je={class:`bg-gray-50 dark:bg-gray-700 rounded-lg p-4`},Ye={class:`text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap`},Xe={class:`pt-6 border-t border-gray-200 dark:border-gray-700`},Ze={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},Qe={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},$e={class:`px-6 py-8 text-center`};var V=ne({__name:`ViewPage`,setup(ne){let V=se(),H=oe(),U=ae(),W=fe(),{isSalesman:et,isAdmin:G,isWarehouseManager:tt}=ue(),K=parseInt(H.params.id),q=d(!0),J=d({}),Y=d(!1),X=d(!1),nt=()=>{V.push({name:`sales.index`})},rt=()=>{V.push({name:`sales.edit`,params:{id:K.toString()}})},it=()=>{V.push({name:`sales.invoice`,params:{id:K.toString()},query:{from:`view`}})},at=()=>{Y.value=!0},ot=()=>{Y.value=!1,X.value=!1},st=async()=>{X.value=!0;try{await W.deleteSale(K),U.success(`Sale deleted successfully`),V.push({name:`sales.index`})}catch{U.error(`Failed to delete sale`)}finally{X.value=!1}},ct=async()=>{try{q.value=!0,J.value=await W.fetchSale(K)}catch(e){console.error(`Error loading sale:`,e),U.error(`Failed to load sale details`),V.push({name:`sales.index`})}finally{q.value=!1}},Z=e=>{let t=Number(e||0);return t>0?`text-green-600 dark:text-green-400 font-medium`:t<0?`text-red-600 dark:text-red-400 font-medium`:`text-gray-600 dark:text-gray-400`},lt=e=>{let t=Number(e||0);return t>0?`bg-green-50 dark:bg-green-900 text-green-600 dark:text-green-400`:t<0?`bg-red-50 dark:bg-red-900 text-red-600 dark:text-red-400`:`bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-400`},Q=e=>e?parseFloat(Number(e).toFixed(2)).toString():`0`,ut=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleDateString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`})},$=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`})};return c(async()=>{await ct()}),(ne,c)=>(l(),a(`div`,pe,[n(`div`,me,[n(`div`,v,[n(`div`,y,[n(`button`,{onClick:nt,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[s(f(ie),{class:`w-5 h-5`})]),c[1]||=n(`div`,null,[n(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},` Sale Details `),n(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},` View sale order information `)],-1)])]),q.value?(l(),a(`div`,Qe,[n(`div`,$e,[s(f(ee),{class:`w-8 h-8 animate-spin mx-auto text-blue-600`}),c[26]||=n(`p`,{class:`mt-2 text-gray-600 dark:text-gray-400`},`Loading sale details...`,-1)])])):(l(),a(`div`,b,[n(`div`,x,[n(`div`,S,[n(`div`,null,[n(`h3`,C,m(J.value.prefix)+`-`+m(J.value.code),1),n(`p`,w,` Sale ID: `+m(J.value.id),1)]),n(`div`,T,[n(`button`,{onClick:it,class:`inline-flex items-center px-3 py-2 border border-green-300 dark:border-green-600 text-sm font-medium rounded-md text-green-700 dark:text-green-300 bg-white dark:bg-gray-800 hover:bg-green-50 dark:hover:bg-green-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200`},[s(f(e),{class:`w-4 h-4 mr-2`}),c[2]||=o(` Print Invoice `,-1)]),f(G)?(l(),a(`button`,{key:0,onClick:rt,class:`inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200`},[s(f(t),{class:`w-4 h-4 mr-2`}),c[3]||=o(` Edit `,-1)])):i(``,!0),f(G)?(l(),a(`button`,{key:1,onClick:at,class:`inline-flex items-center px-3 py-2 border border-red-300 dark:border-red-600 text-sm font-medium rounded-md text-red-700 dark:text-red-300 bg-white dark:bg-gray-800 hover:bg-red-50 dark:hover:bg-red-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200`},[s(f(ce),{class:`w-4 h-4 mr-2`}),c[4]||=o(` Delete `,-1)])):i(``,!0)])])]),n(`div`,E,[n(`div`,D,[c[5]||=n(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Basic Information `,-1),n(`div`,O,[s(_,{label:`Sale Date`,value:ut(J.value.date)},null,8,[`value`]),s(_,{label:`Customer`,value:J.value.customer.name},null,8,[`value`]),s(_,{label:`Salesperson`,value:J.value.salesperson.name},null,8,[`value`]),s(_,{label:`Warehouse`,value:J.value.warehouse.name},null,8,[`value`]),s(_,{label:`Currency`,value:`${J.value.currency.code} - ${J.value.currency.name}`},null,8,[`value`])]),n(`div`,k,[f(g)(J.value.currency.code)?i(``,!0):(l(),r(_,{key:0,label:`Currency Rate`,value:f(h)(J.value.currency_rate)},null,8,[`value`]))])]),n(`div`,A,[c[6]||=n(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Financial Summary `,-1),n(`div`,j,[s(_,{label:`Sub Total`,value:f(h)(J.value.sub_total,!0,J.value.currency)},null,8,[`value`]),s(_,{label:`Sub Total (USD)`,value:f(h)(J.value.sub_total_usd,!0)},null,8,[`value`]),J.value.discount_amount&&J.value.discount_amount>0?(l(),r(_,{key:0,label:`Discount Amount`,value:f(h)(J.value.discount_amount,!0,J.value.currency)},null,8,[`value`])):i(``,!0),f(G)?(l(),r(_,{key:1,label:`Total Profit`},{default:u(()=>[n(`div`,{class:p([`text-sm`,Z(J.value.total_profit)])},m(f(h)(J.value.total_profit,!0,null)),3)]),_:1})):i(``,!0)])]),n(`div`,M,[c[20]||=n(`div`,{class:`flex items-center justify-between mb-4`},[n(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white`},` Sale Items `)],-1),J.value.items&&J.value.items.length===0?(l(),a(`div`,N,[s(f(le),{class:`mx-auto h-12 w-12 text-gray-400`}),c[7]||=n(`h5`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},`No items found`,-1),c[8]||=n(`p`,{class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},`This sale has no items.`,-1)])):(l(),a(`div`,P,[n(`table`,F,[n(`thead`,I,[n(`tr`,null,[c[10]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`#`,-1),c[11]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Code`,-1),c[12]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Item`,-1),c[13]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Unit`,-1),c[14]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[n(`abbr`,{title:`Total Quantity`},`QTY`)],-1),c[15]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Sale Price`,-1),f(G)?(l(),a(`th`,L,`Cost Price`)):i(``,!0),c[16]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[n(`abbr`,{title:`Discount Percentage`},`Dis. %`)],-1),c[17]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[n(`abbr`,{title:`Tax Percentage`},`Tax %`)],-1),c[18]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[n(`abbr`,{title:`Tax-inclusive Price`},`TTC`)],-1),c[19]||=n(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Total`,-1),f(g)(J.value.currency.code)?i(``,!0):(l(),a(`th`,R,`USD`)),f(G)?(l(),a(`th`,z,c[9]||=[n(`abbr`,{title:`Total Profit`},`T.Profit`,-1)])):i(``,!0)])]),n(`tbody`,he,[(l(!0),a(te,null,re(J.value.items,(e,t)=>(l(),a(`tr`,{key:t,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[n(`td`,ge,m(t+1),1),n(`td`,_e,m(e.item_code),1),n(`td`,ve,m(e.item.description),1),n(`td`,ye,m(e.item.item_unit.name),1),n(`td`,be,m(Q(e.quantity)),1),n(`td`,xe,m(f(h)(e.price,!0,J.value.currency)),1),f(G)?(l(),a(`td`,Se,m(f(h)(e.cost_price,!0)),1)):i(``,!0),n(`td`,Ce,m(Q(e.discount_percent))+`%`,1),n(`td`,we,m(Q(e.tax_percent))+`%`,1),n(`td`,Te,m(f(h)(e.ttc_price,!0,J.value.currency)),1),n(`td`,Ee,m(f(h)(e.total_price,!0,J.value.currency)),1),f(g)(J.value.currency.code)?i(``,!0):(l(),a(`td`,De,m(f(h)(e.total_price_usd,!0)),1)),f(G)?(l(),a(`td`,{key:2,class:p([`px-6 py-4 whitespace-nowrap text-sm`,Z(e.total_profit)])},m(f(h)(e.total_profit)),3)):i(``,!0)]))),128))]),n(`tfoot`,Oe,[n(`tr`,null,[n(`td`,{colspan:f(G)?10:9,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Sub Total:`,8,ke),n(`td`,B,m(f(h)(J.value.sub_total,!0,J.value.currency)),1),f(g)(J.value.currency.code)?i(``,!0):(l(),a(`td`,Ae,m(f(h)(J.value.sub_total_usd,!0)),1)),f(G)?(l(),a(`td`,{key:1,class:p([`px-6 py-4 text-sm font-medium`,Z(J.value.total_profit)])},m(f(h)(J.value.total_profit,!0)),3)):i(``,!0)]),J.value.discount_amount&&Number(J.value.discount_amount)>0?(l(),a(`tr`,je,[n(`td`,{colspan:f(G)?10:9,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Additional Discount:`,8,Me),n(`td`,Ne,`-`+m(f(h)(J.value.discount_amount,J.value.currency)),1),f(g)(J.value.currency.code)?i(``,!0):(l(),a(`td`,Pe,`-`+m(f(h)(J.value.discount_amount_usd)),1)),f(G)?(l(),a(`td`,Fe)):i(``,!0)])):i(``,!0),n(`tr`,Ie,[n(`td`,{colspan:f(G)?10:9,class:`px-6 py-4 text-right text-sm font-bold text-gray-900 dark:text-white`},`Final Total:`,8,Le),n(`td`,Re,m(f(h)(J.value.total,!0,J.value.currency)),1),f(g)(J.value.currency.code)?i(``,!0):(l(),a(`td`,ze,m(f(h)(J.value.total_usd,!0)),1)),f(G)?(l(),a(`td`,{key:1,class:p([`px-6 py-4 text-sm font-bold`,Z(J.value.total_profit)])},m(f(h)(J.value.total_profit,!0)),3)):i(``,!0)])])])]))]),n(`div`,Be,[c[24]||=n(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Final Totals `,-1),n(`div`,Ve,[n(`div`,He,[c[21]||=n(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount`,-1),n(`dd`,Ue,m(f(h)(J.value.total,!0,J.value.currency)),1)]),f(g)(J.value.currency.code)?i(``,!0):(l(),a(`div`,We,[c[22]||=n(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount (USD)`,-1),n(`dd`,Ge,m(f(h)(J.value.total_usd,!0)),1)])),f(G)?(l(),a(`div`,{key:1,class:p([`rounded-lg p-4`,lt(J.value.total_profit)])},[c[23]||=n(`dt`,{class:`text-sm font-medium`},`Total Profit`,-1),n(`dd`,Ke,m(f(h)(J.value.total_profit,!0)),1)],2)):i(``,!0)])]),J.value.note?(l(),a(`div`,qe,[c[25]||=n(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Notes `,-1),s(_,{label:`Note`},{default:u(()=>[n(`div`,Je,[n(`p`,Ye,m(J.value.note),1)])]),_:1})])):i(``,!0),n(`div`,Xe,[n(`div`,Ze,[s(_,{label:`Created At`,value:$(J.value.created_at)},null,8,[`value`]),s(_,{label:`Last Updated`,value:$(J.value.updated_at)},null,8,[`value`])])])])]))]),s(de,{show:Y.value,"onUpdate:show":c[0]||=e=>Y.value=e,type:`delete`,title:`Delete Sale ${J.value.prefix}-${J.value.code}`,message:`Are you sure you want to delete sale '${J.value.prefix}-${J.value.code}'? This action can be undone by restoring from trash.`,"confirm-text":`Delete Sale`,"loading-text":`Deleting...`,loading:X.value,onConfirm:st,onCancel:ot},null,8,[`show`,`title`,`message`,`loading`])]))}}),H=V;export{H as default};
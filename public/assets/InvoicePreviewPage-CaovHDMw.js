import{W as e,a4 as t,a8 as n,a9 as r,aH as i,aI as a,aL as o,aj as s,am as c,ao as l,ap as u,ar as d,as as f,at as p,av as m,ax as h,ay as g,r as _,y as v}from"./index-CzmzGcJs.js";import"./GlobalConfig-DCFE7Hv9.js";import"./tableUtils-DX_RsmET.js";import{c as y}from"./currenciesStore-gQZk2PeG.js";import{b}from"./salesStore-CMiHJPa4.js";import{b as x}from"./customersStore-Am8SOUI0.js";import{b as ee}from"./employeesStore-Br3GMnHt.js";import{b as te}from"./warehousesStore-CXIB2Z3o.js";import{c as S}from"./itemsStore-BOg7JIfx.js";import{b as C}from"./companyStore-DtPBLb2H.js";const w={class:`max-w-4xl mx-auto p-8 bg-white text-gray-900 print:p-0 print:max-w-none print:mx-0`},T={class:`flex justify-between items-start mb-10 pb-6 border-b-2 border-blue-600 print:border-black print:mb-6`},E={class:`flex-1`},D={class:`flex items-center mb-3`},O=[`src`,`alt`],k={key:1,class:`text-3xl font-bold text-blue-600 print:text-black print:text-2xl`},A={class:`print:text-black`},j={class:`text-right flex-1 mt-4`},M={class:`text-lg font-semibold text-gray-600 print:text-black print:text-base`},N={class:`grid grid-cols-1 md:grid-cols-2 gap-8 mb-10 print:grid-cols-2 print:gap-6 print:mb-6`},P={class:`space-y-1 print:space-y-0`},F={class:`flex justify-between print:justify-between`},I={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},L={class:`flex justify-between print:justify-between`},R={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},z={key:0,class:`flex justify-between print:justify-between`},B={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},V={key:1,class:`flex justify-between print:justify-between`},H={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},U={key:2,class:`flex justify-between print:justify-between`},W={class:`text-red-600 font-bold print:font-normal print:text-black print:text-xs`},G={class:`space-y-1 print:space-y-0`},K={class:`flex justify-between print:justify-between`},q={class:`text-gray-900 print:text-black print:text-xs`},J={class:`flex justify-between print:justify-between`},Y={class:`text-gray-900 print:text-black print:text-xs`},X={key:0,class:`flex justify-between print:justify-between`},Z={class:`text-gray-900 print:text-black print:text-xs`},Q={class:`mb-8 print:mb-4`},ne={class:`overflow-x-auto print:overflow-visible`},re={class:`w-full border-collapse border border-gray-300 print:border-black`},ie={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center print:border-black print:text-black print:text-xs`},ae={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},oe={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},se={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},ce={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},le={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},ue={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},de={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-black print:text-xs`},fe={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-black print:text-xs`},pe={class:`print:text-black print:text-xs`},me={class:`print:text-black print:text-xs`},he={colspan:`4`,class:`print:border-black text-center relative`},ge=[`src`,`alt`],_e={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-black print:text-xs`},ve={class:`print:text-black print:text-xs`},ye={class:`print:text-black print:text-xs`},be={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-black print:text-xs`},xe={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-black print:text-xs`},Se={class:`mt-4 print:mt-2`},Ce={class:`flex gap-x-4 text-sm text-gray-600 print:text-black print:text-xs print:gap-x-4`},we={key:0,class:`flex-2 text-left print:flex-2`},Te={key:1,class:`flex-1 text-center print:flex-1`},Ee={key:2,class:`flex-1 text-center print:flex-1`},De={key:3,class:`flex-1 text-right print:flex-1`};var Oe=p({__name:`SaleInvoice`,props:{saleData:{},customers:{default:()=>[]},warehouses:{default:()=>[]},currencies:{default:()=>[]},salespersons:{default:()=>[]},items:{default:()=>[]}},setup(e,{expose:t}){let n=C();m(async()=>{try{n.company.name||await n.fetchCompany()}catch(e){console.error(`Failed to fetch company data:`,e)}});let r=e=>e?parseFloat(Number(e).toFixed(2)).toString():`0`,i=e=>e?Number(e).toLocaleString(`en-US`,{minimumFractionDigits:2,maximumFractionDigits:2}):`0.00`,d=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleDateString(`en-US`,{year:`numeric`,month:`long`,day:`numeric`})},f=()=>{window.print()};return t({printInvoice:f}),(e,t)=>(h(),u(`div`,w,[c(`div`,T,[c(`div`,E,[c(`div`,D,[a(n).company.logo?.preview_url?(h(),u(`img`,{key:0,src:a(n).company.logo.preview_url,alt:a(n).company.name||`Company Logo`,class:`h-16 w-auto mr-4 print:h-12`},null,8,O)):l(``,!0),a(n).company.logo?.preview_url?l(``,!0):(h(),u(`div`,k,o(a(n).company.name),1))]),c(`div`,null,[c(`p`,A,[c(`b`,null,`Tax Registration #: `+o(a(n).company.tax_number),1)])])]),c(`div`,j,[t[0]||=c(`h1`,{class:`text-2xl font-bold text-blue-600 mb-2 print:text-black print:text-xl`},`SALES INVOICE`,-1),c(`div`,M,o(e.saleData.prefix)+`-`+o(e.saleData.code),1)]),l(``,!0)]),c(`div`,N,[c(`div`,null,[t[7]||=c(`h3`,{class:`text-lg font-bold text-blue-600 mb-3 print:text-sm border-b border-gray-200 print:text-black print:border-black`},`Customer Information`,-1),c(`div`,P,[c(`div`,F,[t[2]||=c(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Customer:`,-1),c(`span`,I,o(e.saleData.customer?.code)+`, `+o(e.saleData.customer?.name||`Unknown Customer`),1)]),c(`div`,L,[t[3]||=c(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Address:`,-1),c(`span`,R,o(e.saleData.customer?.address)+`, `+o(e.saleData.customer?.city),1)]),e.saleData.customer?.mobile?(h(),u(`div`,z,[t[4]||=c(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Phone:`,-1),c(`span`,B,o(e.saleData.customer?.mobile),1)])):l(``,!0),e.saleData.customer?.mof_tax_number?(h(),u(`div`,V,[t[5]||=c(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Tax #:`,-1),c(`span`,H,o(e.saleData.customer?.mof_tax_number),1)])):l(``,!0),e.saleData.outStanding_balance&&Number(e.saleData.outStanding_balance)>0?(h(),u(`div`,U,[t[6]||=c(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Outstanding Balance:`,-1),c(`span`,W,o(i(e.saleData.outStanding_balance)),1)])):l(``,!0)])]),c(`div`,null,[t[11]||=c(`h3`,{class:`text-lg font-bold text-blue-600 mb-3 print:text-sm border-b border-gray-200 print:text-black print:border-black`},`Invoice Details`,-1),c(`div`,G,[c(`div`,K,[t[8]||=c(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Date:`,-1),c(`span`,q,o(d(e.saleData.date)),1)]),c(`div`,J,[t[9]||=c(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Currency:`,-1),c(`span`,Y,o(e.saleData.currency?.code||`N/A`),1)]),e.saleData.salesperson?(h(),u(`div`,X,[t[10]||=c(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Salesperson:`,-1),c(`span`,Z,o(e.saleData.salesperson?.name||`Not assigned`),1)])):l(``,!0)])])]),c(`div`,Q,[c(`div`,ne,[c(`table`,re,[t[19]||=c(`thead`,null,[c(`tr`,{class:`bg-gray-100 print:bg-gray-200`},[c(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-center font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`#`),c(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-left font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Item Code`),c(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-left font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Description`),c(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Price`),c(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},[c(`abbr`,{title:`Discount Percentage`},`Dis. %`)]),c(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},[c(`abbr`,{title:`Total Quantity`},`QTY`)]),c(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},[c(`abbr`,{title:`Tax Percentage`},`Tax %`)]),c(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Total`)])],-1),c(`tbody`,null,[(h(!0),u(s,null,g(e.saleData.items,(e,t)=>(h(),u(`tr`,{key:t,class:`even:bg-gray-50 print:even:bg-gray-100`},[c(`td`,ie,o(t+1),1),c(`td`,ae,o(e.item_code||``),1),c(`td`,oe,o(e.item?.description||`Unknown Item`),1),c(`td`,se,o(i(e.price)),1),c(`td`,ce,o(r(e.discount_percent))+`%`,1),c(`td`,le,o(r(e.quantity)),1),c(`td`,ue,o(r(e.tax_percent)),1),c(`td`,de,o(i(e.total_price)),1)]))),128)),c(`tr`,null,[t[12]||=c(`td`,{colspan:`6`,class:`print:border-black`},null,-1),t[13]||=c(`td`,{class:`border border-gray-300 print:border-black print:text-black print:text-xs`},` Sub Total`,-1),c(`td`,fe,o(i(e.saleData.sub_total)),1)]),c(`tr`,null,[c(`td`,pe,[l(``,!0)]),c(`td`,me,[l(``,!0)]),c(`td`,he,[a(n).company.stamp?.preview_url?(h(),u(`img`,{key:0,src:a(n).company.stamp.preview_url,alt:a(n).company.name||`Company Logo`,class:`h-16 w-auto mr-4 -rotate-6 print:h-8 absolute left-24`},null,8,ge)):l(``,!0)]),t[14]||=c(`td`,{class:`border border-gray-300 print:border-black print:text-black print:text-xs`},`Add. Discount`,-1),c(`td`,_e,o(i(e.saleData.discount_amount)),1)]),c(`tr`,null,[c(`td`,ve,[l(``,!0)]),c(`td`,ye,[l(``,!0)]),t[15]||=c(`td`,{colspan:`4`,class:`print:border-black`},null,-1),t[16]||=c(`td`,{class:`border border-gray-300 print:border-black print:text-black print:text-xs`},` Vat 11`,-1),c(`td`,be,o(i(e.saleData.sub_total)),1)]),c(`tr`,null,[t[17]||=c(`td`,{colspan:`6`,class:`print:border-black`},null,-1),t[18]||=c(`td`,{class:`border border-gray-300 print:border-black print:text-black print:text-xs`},` Net Total USD`,-1),c(`td`,xe,o(i(e.saleData.total_usd)),1)])])])])]),t[20]||=c(`div`,{class:`max-w-4xl mx-auto pt-2 pb-12 px-8 border-1 border-t flex text-center print:text-sm`},[c(`div`,{class:`flex-1`},`Receved By`),c(`div`,{class:`flex-1`},`Signature By`)],-1),c(`div`,Se,[c(`div`,Ce,[a(n).company.address?(h(),u(`p`,we,o(a(n).company.address),1)):l(``,!0),a(n).company.phone?(h(),u(`p`,Te,o(a(n).company.phone),1)):l(``,!0),a(n).company.email?(h(),u(`p`,Ee,o(a(n).company.email),1)):l(``,!0),a(n).company.website?(h(),u(`p`,De,o(a(n).company.website),1)):l(``,!0)])])]))}}),ke=Oe;const Ae={class:`min-h-screen bg-gray-50 print:bg-white`},je={class:`bg-white shadow-sm border-b print:hidden`},Me={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8`},Ne={class:`flex items-center justify-between h-16`},Pe={class:`flex items-center space-x-4`},$={class:`text-sm text-gray-500`},Fe={class:`flex items-center space-x-3`},Ie={key:0,class:`flex items-center justify-center min-h-screen`},Le={class:`text-center`},Re={key:1,class:`py-8 print:py-0`},ze={class:`max-w-6xl mx-auto print:max-w-none`};var Be=p({__name:`InvoicePreviewPage`,setup(s){let l=r(),p=n(),g=t(),C=b(),w=x(),T=ee(),E=y(),D=te(),O=S(),k=parseInt(p.params.id),A=i(!0),j=i({}),M=i(null),N=i([]),P=i([]),F=i([]),I=i([]),L=i([]),R=()=>{let e=p.query.from===`view`;e?l.push({name:`sales.show`,params:{id:k.toString()}}):l.push({name:`sales.index`})},z=async()=>{if(M.value)try{await M.value.printInvoice()}catch(e){console.error(`Failed to print invoice:`,e),g.error(`Failed to print invoice`)}},B=async()=>{try{j.value=await C.fetchSale(k)}catch(e){console.error(`Error loading sale:`,e),g.error(`Failed to load sale details`),l.push({name:`sales.index`})}},V=async()=>{try{await Promise.all([H(),U(),W(),G(),K()])}catch(e){console.error(`Error loading dropdown data:`,e)}},H=async()=>{await w.fetchCustomers({is_active:!0}),N.value=w.customers},U=async()=>{await T.fetchEmployees({is_active:!0}),P.value=T.salespersons},W=async()=>{await D.fetchWarehouses(),F.value=D.warehouses},G=async()=>{await E.fetchCurrencies(),I.value=E.currencies},K=async()=>{await O.fetchItems({per_page:1e3}),L.value=O.items};return m(async()=>{try{A.value=!0,await Promise.all([V(),B()])}catch(e){console.error(`Error initializing invoice preview:`,e)}finally{A.value=!1}}),(t,n)=>(h(),u(`div`,Ae,[c(`div`,je,[c(`div`,Me,[c(`div`,Ne,[c(`div`,Pe,[c(`button`,{onClick:R,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100 transition-colors`},[f(a(e),{class:`w-5 h-5`})]),c(`div`,null,[n[0]||=c(`h1`,{class:`text-lg font-semibold text-gray-900`},`Invoice Preview`,-1),c(`p`,$,o(j.value.prefix)+`-`+o(j.value.code),1)])]),c(`div`,Fe,[c(`button`,{onClick:z,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`},[f(a(_),{class:`w-4 h-4 mr-2`}),n[1]||=d(` Print Invoice `,-1)])])])])]),A.value?(h(),u(`div`,Ie,[c(`div`,Le,[f(a(v),{class:`w-8 h-8 animate-spin mx-auto text-blue-600`}),n[2]||=c(`p`,{class:`mt-2 text-gray-600`},`Loading invoice...`,-1)])])):(h(),u(`div`,Re,[c(`div`,ze,[f(ke,{ref_key:`saleInvoiceRef`,ref:M,"sale-data":j.value,customers:N.value,warehouses:F.value,currencies:I.value,salespersons:P.value,items:L.value},null,8,[`sale-data`,`customers`,`warehouses`,`currencies`,`salespersons`,`items`])])]))]))}}),Ve=Be;export{Ve as default};
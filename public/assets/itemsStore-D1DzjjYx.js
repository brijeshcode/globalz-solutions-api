import{P as e,Q as t,R as n,S as r,T as i,Y as a,Z as o,_ as s,a9 as c,ar as l,av as u}from"./index-sY1m64Sn.js";var d=class{baseUrl=`/setups/items`;async getItems(e){try{let n=this.buildQueryParams(e),r=await t(`${this.baseUrl}?${n}`,{loadingMessage:`Loading items...`,showLoading:!0});return{data:r.data.data,pagination:r.data.pagination}}catch(e){throw console.error(`Error fetching items:`,e),e}}async getItem(e){try{let n=await t(`${this.baseUrl}/${e}`,{loadingMessage:`Loading item...`});return n.data.data}catch(e){throw console.error(`Error fetching item:`,e),e}}async createItem(e){try{let t=await r(this.baseUrl,e,{loadingMessage:`Creating item...`,showSuccessNotification:!0,successMessage:`Item created successfully`});return t.data.data}catch(e){throw console.error(`Error creating item:`,e),e}}async createItemWithImages(e){try{let t=await r(this.baseUrl,e,{loadingMessage:`Creating item with images...`,showSuccessNotification:!0,successMessage:`Item created successfully`,headers:{"Content-Type":`multipart/form-data`}});return t.data.data}catch(e){throw console.error(`Error creating item with images:`,e),e}}async updateItem(e,t){try{let n=await i(`${this.baseUrl}/${e}`,t,{loadingMessage:`Updating item...`,showSuccessNotification:!0,successMessage:`Item updated successfully`});return n.data.data}catch(e){throw console.error(`Error updating item:`,e),e}}async updateItemWithImages(e,t){try{let n=await r(`${this.baseUrl}/${e}`,t,{loadingMessage:`Updating item with images...`,showSuccessNotification:!0,successMessage:`Item updated successfully`,headers:{"Content-Type":`multipart/form-data`}});return n.data.data}catch(e){throw console.error(`Error updating item with images:`,e),e}}async deleteItem(t){try{await e(`${this.baseUrl}/${t}`,{loadingMessage:`Deleting item...`,showSuccessNotification:!0,successMessage:`Item deleted successfully`})}catch(e){throw console.error(`Error deleting item:`,e),e}}async getTrashedItems(e){try{let n=this.buildQueryParams(e),r=await t(`${this.baseUrl}/trashed?${n}`,{loadingMessage:`Loading trashed items...`});return{data:r.data.data,pagination:r.data.pagination}}catch(e){throw console.error(`Error fetching trashed items:`,e),e}}async restoreItem(e){try{let t=await n(`${this.baseUrl}/${e}/restore`,{},{loadingMessage:`Restoring item...`,showSuccessNotification:!0,successMessage:`Item restored successfully`});return t.data.data}catch(e){throw console.error(`Error restoring item:`,e),e}}async forceDeleteItem(t){try{await e(`${this.baseUrl}/${t}/force-delete`,{loadingMessage:`Permanently deleting item...`,showSuccessNotification:!0,successMessage:`Item permanently deleted`})}catch(e){throw console.error(`Error permanently deleting item:`,e),e}}async getItemStats(){try{let e=await t(`${this.baseUrl}/stats`,{loadingMessage:`Loading item statistics...`});return e.data.data}catch(e){throw console.error(`Error fetching item statistics:`,e),e}}async exportItems(e){try{let n=this.buildQueryParams(e),r=await t(`${this.baseUrl}/export?${n}`,{loadingMessage:`Exporting items...`,showSuccessNotification:!0,successMessage:`Items exported successfully`});return r.data.data}catch(e){throw console.error(`Error exporting items:`,e),e}}async getNextCode(){try{let e=await t(`${this.baseUrl}/next-code`,{showLoading:!1});return e.data.data}catch(e){throw console.error(`Error fetching next code:`,e),e}}async checkCodeAvailability(e){try{let t=await r(`${this.baseUrl}/check-code`,{code:e},{showLoading:!1});return t.data.data}catch(e){throw console.error(`Error checking code availability:`,e),e}}async getItemsForSelect(e){try{let n={is_active:!0,per_page:100};e&&(n.search=e);let r=this.buildQueryParams(n),i=await t(`${this.baseUrl}?${r}`,{showLoading:!1}),a=i.data.data;return a.map(e=>({value:e.id,label:`${e.code} - ${e.description}`,code:e.code,disabled:!1}))}catch(e){throw console.error(`Error fetching items for select:`,e),e}}async searchItems(e,t=50){try{return await this.getItemsForSelect(e)}catch(e){throw console.error(`Error searching items:`,e),e}}async getLowStockItems(e){try{let n={...e},r=this.buildQueryParams(n),i=await t(`${this.baseUrl}?low_stock=true&${r}`,{loadingMessage:`Loading low stock items...`});return{data:i.data.data,pagination:i.data.pagination}}catch(e){throw console.error(`Error fetching low stock items:`,e),e}}buildQueryParams(e){if(!e)return``;let t=new URLSearchParams;return Object.entries(e).forEach(([e,n])=>{n!=null&&n!==``&&t.append(e,String(n))}),t.toString()}};const f=new d,p=s(`items`,()=>{let e=o(),t=a(),n=u([]),r=u(null),i=u([]),s=u({total_items:0,active_items:0,inactive_items:0,trashed_items:0,low_stock_items:0,total_inventory_value:0,items_by_type:[],items_by_family:[],cost_calculation_breakdown:[]}),d=u({current_page:1,per_page:20,total:0,last_page:1,from:null,to:null,has_more_pages:!1,next_page_url:null,prev_page_url:null,first_page_url:``,last_page_url:``}),p=u(!1),m=u({}),h=c(()=>({page:t.query.page?parseInt(t.query.page):1,per_page:t.query.per_page?parseInt(t.query.per_page):20,search:t.query.search||``,search_field:t.query.search_field||``,sort_by:t.query.sort_by||``,sort_direction:t.query.sort_direction||`desc`,is_active:t.query.is_active===void 0?void 0:t.query.is_active===`true`,item_type_id:t.query.item_type_id?parseInt(t.query.item_type_id):void 0,item_family_id:t.query.item_family_id?parseInt(t.query.item_family_id):void 0,item_group_id:t.query.item_group_id?parseInt(t.query.item_group_id):void 0,item_category_id:t.query.item_category_id?parseInt(t.query.item_category_id):void 0,item_brand_id:t.query.item_brand_id?parseInt(t.query.item_brand_id):void 0,supplier_id:t.query.supplier_id?parseInt(t.query.supplier_id):void 0,item_profit_margin_id:t.query.item_profit_margin_id?parseInt(t.query.item_profit_margin_id):void 0,cost_calculation:t.query.cost_calculation||void 0,code:t.query.code||void 0})),g=c(()=>n.value.filter(e=>e.is_active)),_=c(()=>n.value.filter(e=>!e.is_active)),v=c(()=>g.value.map(e=>({value:e.id,label:`${e.code} - ${e.description}`,code:e.code,disabled:!1}))),y=c(()=>n.value.filter(e=>e.low_quantity_alert!==null&&e.starting_quantity<=e.low_quantity_alert)),b=(n,r=!1)=>{let i={...t.query};Object.entries(n).forEach(([e,t])=>{t!=null&&t!==``?i[e]=String(t):delete i[e]});let a=r?`replace`:`push`;e[a]({query:i})},x=()=>{e.replace({query:{}})},S=()=>{m.value={...h.value}};l(()=>t.query,()=>{S()},{immediate:!0,deep:!0});let C=async(e,t=!0)=>{try{p.value=!0;let r=m.value;e&&(r={...m.value,...e},t&&b(e));let i=await f.getItems(r);n.value=i.data,d.value=i.pagination}catch(e){throw console.error(`Error fetching items:`,e),e}finally{p.value=!1}},w=async e=>{try{let t=await f.getItem(e);return r.value=t,t}catch(e){throw console.error(`Error fetching item:`,e),e}},T=async e=>{try{let t=await f.createItem(e);return n.value.unshift(t),d.value.total+=1,s.value.total_items+=1,e.is_active===!1?s.value.inactive_items+=1:s.value.active_items+=1,t}catch(e){throw console.error(`Error creating item:`,e),e}},E=async e=>{try{let t=await f.createItemWithImages(e);n.value.unshift(t),d.value.total+=1,s.value.total_items+=1;let r=e.get(`is_active`)!==`0`;return r?s.value.active_items+=1:s.value.inactive_items+=1,t}catch(e){throw console.error(`Error creating item with images:`,e),e}},D=async(e,t)=>{try{let i=await f.updateItem(e,t),a=n.value.findIndex(t=>t.id===e);return a!==-1&&(n.value[a]=i),r.value?.id===e&&(r.value=i),i}catch(e){throw console.error(`Error updating item:`,e),e}},O=async(e,t)=>{try{let i=await f.updateItemWithImages(e,t),a=n.value.findIndex(t=>t.id===e);return a!==-1&&(n.value[a]=i),r.value?.id===e&&(r.value=i),i}catch(e){throw console.error(`Error updating item with images:`,e),e}},k=async e=>{try{await f.deleteItem(e);let t=n.value.findIndex(t=>t.id===e);t!==-1&&n.value.splice(t,1),--d.value.total,--s.value.total_items,s.value.trashed_items+=1,r.value?.id===e&&(r.value=null)}catch(e){throw console.error(`Error deleting item:`,e),e}},A=async e=>{try{p.value=!0;let t=e||{},n=await f.getTrashedItems(t);i.value=n.data}catch(e){throw console.error(`Error fetching trashed items:`,e),e}finally{p.value=!1}},j=async e=>{try{let t=await f.restoreItem(e),r=i.value.findIndex(t=>t.id===e);return r!==-1&&i.value.splice(r,1),n.value.unshift(t),d.value.total+=1,--s.value.trashed_items,t}catch(e){throw console.error(`Error restoring item:`,e),e}},M=async e=>{try{await f.forceDeleteItem(e);let t=i.value.findIndex(t=>t.id===e);t!==-1&&i.value.splice(t,1),--s.value.trashed_items}catch(e){throw console.error(`Error permanently deleting item:`,e),e}},N=async()=>{try{let e=await f.getItemStats();return s.value=e,e}catch(e){throw console.error(`Error fetching item stats:`,e),e}},P=async e=>{try{let t=e||m.value;return await f.exportItems(t)}catch(e){throw console.error(`Error exporting items:`,e),e}},F=async()=>{try{return await f.getNextCode()}catch(e){throw console.error(`Error getting next code:`,e),e}},I=async e=>{try{return await f.checkCodeAvailability(e)}catch(e){throw console.error(`Error checking code availability:`,e),e}},L=async(e,t=50)=>{try{return await f.searchItems(e,t)}catch(e){return console.error(`Error searching items:`,e),[]}},R=async e=>{try{return await f.getLowStockItems(e)}catch(e){throw console.error(`Error fetching low stock items:`,e),e}},z=(e,t=!0)=>{m.value={...m.value,...e},t&&b(e)},B=(e=!0)=>{m.value={},e&&x()},V=e=>{z({page:e},!0)},H=e=>{z({per_page:e,page:1},!0)},U=(e,t=`desc`)=>{z({sort_by:e,sort_direction:t,page:1},!0)},W=(e,t=``)=>{z({search:e,search_field:t,page:1},!0)},G=()=>{r.value=null},K=()=>{n.value=[],r.value=null,i.value=[],d.value={current_page:1,per_page:20,total:0,last_page:1,from:null,to:null,has_more_pages:!1,next_page_url:null,prev_page_url:null,first_page_url:``,last_page_url:``},m.value={},p.value=!1,s.value={total_items:0,active_items:0,inactive_items:0,trashed_items:0,low_stock_items:0,total_inventory_value:0,items_by_type:[],items_by_family:[],cost_calculation_breakdown:[]}},q=async e=>{try{return await f.getItemsForSelect(e)}catch(e){return console.error(`Error fetching items for select:`,e),[]}};return{items:n,currentItem:r,trashedItems:i,stats:s,pagination:d,loading:p,filters:m,urlParams:h,activeItems:g,inactiveItems:_,itemsForSelect:v,lowStockItems:y,updateUrlParams:b,clearUrlParams:x,syncFiltersWithUrl:S,fetchItems:C,fetchItem:w,createItem:T,createItemWithImages:E,updateItem:D,updateItemWithImages:O,deleteItem:k,fetchTrashedItems:A,restoreItem:j,forceDeleteItem:M,fetchStats:N,exportItems:P,getNextCode:F,checkCodeAvailability:I,searchItems:L,fetchLowStockItems:R,updateFilters:z,clearFilters:B,setPage:V,setPerPage:H,setSort:U,setSearch:W,clearCurrentItem:G,reset:K,fetchItemsForSelect:q}});export{p as b};
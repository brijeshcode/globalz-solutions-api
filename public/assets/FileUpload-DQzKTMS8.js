import{P as e,Q as t,R as n,S as r,T as i,_ as a,a7 as o,a9 as s,aa as c,ac as l,ad as u,af as d,ah as f,ak as p,al as m,am as h,ar as g,av as _,ax as v,az as y}from"./index-Dr1ObvLr.js";var b=class{baseUrl=`/setups/suppliers`;async getSuppliers(e){try{let n=this.buildQueryParams(e),r=await t(`${this.baseUrl}?${n}`,{loadingMessage:`Loading suppliers...`,showLoading:!0});return{data:r.data.data,pagination:r.data.pagination}}catch(e){throw console.error(`Error fetching suppliers:`,e),e}}async getSupplier(e){try{let n=await t(`${this.baseUrl}/${e}`,{loadingMessage:`Loading supplier...`});return n.data.data}catch(e){throw console.error(`Error fetching supplier:`,e),e}}async createSupplier(e){try{let t=await r(this.baseUrl,e,{loadingMessage:`Creating supplier...`,showSuccessNotification:!0,successMessage:`Supplier created successfully`});return t.data.data}catch(e){throw console.error(`Error creating supplier:`,e),e}}async createSupplierWithFiles(e){try{let t=await r(this.baseUrl,e,{loadingMessage:`Creating supplier...`,showSuccessNotification:!0,successMessage:`Supplier created successfully`});return t.data.data}catch(e){throw console.error(`Error creating supplier with files:`,e),e}}async updateSupplier(e,t){try{let n=await i(`${this.baseUrl}/${e}`,t,{loadingMessage:`Updating supplier...`,showSuccessNotification:!0,successMessage:`Supplier updated successfully`});return n.data.data}catch(e){throw console.error(`Error updating supplier:`,e),e}}async updateSupplierWithFiles(e,t){console.log(`updateSupplierWithFiles`);try{let n=await r(`${this.baseUrl}/${e}`,t,{loadingMessage:`Updating supplier...`,showSuccessNotification:!0,successMessage:`Supplier updated successfully`});return n.data.data}catch(e){throw console.error(`Error updating supplier with files:`,e),e}}async deleteSupplier(t){try{await e(`${this.baseUrl}/${t}`,{loadingMessage:`Deleting supplier...`,showSuccessNotification:!0,successMessage:`Supplier deleted successfully`})}catch(e){throw console.error(`Error deleting supplier:`,e),e}}async getTrashedSuppliers(e){try{let n=this.buildQueryParams(e),r=await t(`${this.baseUrl}/trashed?${n}`,{loadingMessage:`Loading trashed suppliers...`});return{data:r.data.data,pagination:r.data.pagination}}catch(e){throw console.error(`Error fetching trashed suppliers:`,e),e}}async restoreSupplier(e){try{let t=await n(`${this.baseUrl}/${e}/restore`,{},{loadingMessage:`Restoring supplier...`,showSuccessNotification:!0,successMessage:`Supplier restored successfully`});return t.data.data}catch(e){throw console.error(`Error restoring supplier:`,e),e}}async forceDeleteSupplier(t){try{await e(`${this.baseUrl}/${t}/force-delete`,{loadingMessage:`Permanently deleting supplier...`,showSuccessNotification:!0,successMessage:`Supplier permanently deleted`})}catch(e){throw console.error(`Error permanently deleting supplier:`,e),e}}async getSuppliersForSelect(){try{let e=await t(`${this.baseUrl}`,{showLoading:!1}),n=e.data.data;return n.filter(e=>e.is_active).map(e=>({value:e.id,label:e.name,disabled:!1}))}catch(e){throw console.error(`Error fetching suppliers for select:`,e),e}}async getSupplierStats(){try{let e=await t(`${this.baseUrl}/stats`,{showLoading:!1});return e.data.data}catch(e){throw console.error(`Error fetching supplier stats:`,e),e}}async exportSuppliers(e){try{let n=this.buildQueryParams(e),r=await t(`${this.baseUrl}/export?${n}`,{loadingMessage:`Exporting suppliers...`,showSuccessNotification:!0,successMessage:`Suppliers exported successfully`});return r.data.data}catch(e){throw console.error(`Error exporting suppliers:`,e),e}}buildQueryParams(e){if(!e)return``;let t=new URLSearchParams;return Object.entries(e).forEach(([e,n])=>{n!=null&&n!==``&&t.append(e,String(n))}),t.toString()}};const x=new b,S=a(`suppliers`,()=>{let e=_([]),t=_(null),n=_([]),r=_({current_page:1,per_page:20,total:0,last_page:1,from:null,to:null,has_more_pages:!1,next_page_url:null,prev_page_url:null,first_page_url:``,last_page_url:``}),i=_(!1),a=_({}),o=_(null),c=s(()=>e.value.filter(e=>e.is_active)),l=s(()=>e.value.filter(e=>!e.is_active)),u=s(()=>c.value.map(e=>({value:e.id,label:`${e.code} - ${e.name}`,disabled:!1}))),d=s(()=>e.value.reduce((e,t)=>e+(t.opening_balance||0),0)),f=s(()=>e.value.reduce((e,t)=>e+t.balance,0)),p=async t=>{try{i.value=!0,t&&(a.value={...a.value,...t});let n=await x.getSuppliers(a.value);e.value=n.data,r.value=n.pagination}catch(e){throw console.error(`Error fetching suppliers:`,e),e}finally{i.value=!1}},m=async e=>{try{let n=await x.getSupplier(e);return t.value=n,n}catch(e){throw console.error(`Error fetching supplier:`,e),e}},h=async t=>{try{let n=await x.createSupplier(t);return e.value.unshift(n),r.value.total+=1,n}catch(e){throw console.error(`Error creating supplier:`,e),e}},g=async t=>{try{let n=await x.createSupplierWithFiles(t);return e.value.unshift(n),r.value.total+=1,n}catch(e){throw console.error(`Error creating supplier with files:`,e),e}},v=async(n,r)=>{try{let i=await x.updateSupplier(n,r),a=e.value.findIndex(e=>e.id===n);return a!==-1&&(e.value[a]=i),t.value?.id===n&&(t.value=i),i}catch(e){throw console.error(`Error updating supplier:`,e),e}},y=async(n,r)=>{try{let i=await x.updateSupplierWithFiles(n,r),a=e.value.findIndex(e=>e.id===n);return a!==-1&&(e.value[a]=i),t.value?.id===n&&(t.value=i),i}catch(e){throw console.error(`Error updating supplier with files:`,e),e}},b=async n=>{try{await x.deleteSupplier(n);let i=e.value.findIndex(e=>e.id===n);i!==-1&&e.value.splice(i,1),--r.value.total,t.value?.id===n&&(t.value=null)}catch(e){throw console.error(`Error deleting supplier:`,e),e}},S=async e=>{try{i.value=!0;let t=e||{},r=await x.getTrashedSuppliers(t);n.value=r.data}catch(e){throw console.error(`Error fetching trashed suppliers:`,e),e}finally{i.value=!1}},C=async t=>{try{let i=await x.restoreSupplier(t),a=n.value.findIndex(e=>e.id===t);return a!==-1&&n.value.splice(a,1),e.value.unshift(i),r.value.total+=1,i}catch(e){throw console.error(`Error restoring supplier:`,e),e}},w=async e=>{try{await x.forceDeleteSupplier(e);let t=n.value.findIndex(t=>t.id===e);t!==-1&&n.value.splice(t,1)}catch(e){throw console.error(`Error permanently deleting supplier:`,e),e}},T=async()=>{try{return o.value=await x.getSupplierStats(),o.value}catch(e){throw console.error(`Error fetching supplier stats:`,e),e}},E=async e=>{try{let t=e||a.value;return await x.exportSuppliers(t)}catch(e){throw console.error(`Error exporting suppliers:`,e),e}},D=e=>{a.value={...a.value,...e}},O=()=>{a.value={}},k=()=>{t.value=null},A=()=>{e.value=[],t.value=null,n.value=[],r.value={current_page:1,per_page:20,total:0,last_page:1,from:null,to:null,has_more_pages:!1,next_page_url:null,prev_page_url:null,first_page_url:``,last_page_url:``},a.value={},i.value=!1,o.value=null},j=async()=>{try{return await x.getSuppliersForSelect()}catch(e){return console.error(`Error fetching suppliers for select:`,e),[]}};return{suppliers:e,currentSupplier:t,trashedSuppliers:n,pagination:r,loading:i,filters:a,stats:o,activeSuppliers:c,inactiveSuppliers:l,suppliersForSelect:u,totalOpeningBalance:d,totalCurrentBalance:f,fetchSuppliers:p,fetchSupplier:m,createSupplier:h,createSupplierWithFiles:g,updateSupplier:v,updateSupplierWithFiles:y,deleteSupplier:b,fetchTrashedSuppliers:S,restoreSupplier:C,forceDeleteSupplier:w,fetchSupplierStats:T,exportSuppliers:E,updateFilters:D,clearFilters:O,clearCurrentSupplier:k,reset:A,fetchSuppliersForSelect:j}}),C={class:`w-full`},w={class:`space-y-3`},T={for:`file-upload`,class:`cursor-pointer`},E=[`multiple`,`accept`,`disabled`],D={class:`text-xs text-gray-500 dark:text-gray-400`},O={key:0},k={key:0,class:`mt-2 text-sm text-red-600 dark:text-red-400`},A={key:1,class:`mt-4 space-y-4`},j={class:`text-sm font-medium text-gray-700 dark:text-gray-300`},M={key:0,class:`space-y-3`},N={class:`grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4`},P={class:`aspect-square bg-gray-100 dark:bg-gray-700 rounded-lg overflow-hidden`},F=[`src`,`alt`,`onLoad`],I={class:`absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-opacity rounded-lg flex items-end`},ee={class:`p-2 text-white opacity-0 group-hover:opacity-100 transition-opacity`},te={class:`text-xs font-medium truncate`},L={class:`text-xs`},R=[`onClick`,`disabled`],z={key:1,class:`space-y-3`},B={key:0,class:`text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wide`},V={class:`space-y-2`},H={class:`flex items-center space-x-3`},U={class:`text-sm font-medium text-gray-900 dark:text-gray-100`},W={class:`text-xs text-gray-500 dark:text-gray-400`},G=[`onClick`,`disabled`];var K=f({__name:`FileUpload`,props:{multiple:{type:Boolean,default:!0},accept:{default:`.pdf,.doc,.docx,.xls,.xlsx,.jpg,.jpeg,.png,.gif,.txt,.csv,.zip`},maxSize:{default:20*1024*1024},maxFiles:{default:10},disabled:{type:Boolean,default:!1},modelValue:{default:()=>[]}},emits:[`update:modelValue`,`change`,`error`],setup(e,{expose:t,emit:n}){let r=e,i=n,a=_(),f=_([]),b=_(``),x=_(new Map),S=s(()=>r.accept.includes(`.pdf`)?`PDF, DOC, XLS, images`:`All supported files`),K=s(()=>{let e=r.maxSize/(1024*1024);return`${e}MB`}),q=s(()=>f.value.map((e,t)=>({file:e,originalIndex:t})).filter(({file:e})=>Q(e))),J=s(()=>f.value.map((e,t)=>({file:e,originalIndex:t})).filter(({file:e})=>!Q(e))),Y=e=>{let t=e.target;if(!t.files)return;let n=Array.from(t.files);b.value=``;let o=f.value.length+n.length;if(o>r.maxFiles){b.value=`Maximum ${r.maxFiles} files allowed`;return}for(let e of n){if(e.size>r.maxSize){b.value=`File "${e.name}" is too large. Maximum size is ${K.value}`;return}if(r.accept&&!Z(e)){b.value=`File "${e.name}" type is not allowed`;return}}f.value.push(...n),a.value&&(a.value.value=``),i(`update:modelValue`,f.value),i(`change`,f.value)},X=e=>{let t=f.value[e];if(Q(t)){let e=x.value.get(t);e&&(URL.revokeObjectURL(e),x.value.delete(t))}f.value.splice(e,1),b.value=``,i(`update:modelValue`,f.value),i(`change`,f.value)},Z=e=>{if(!r.accept)return!0;let t=r.accept.split(`,`).map(e=>e.trim()),n=e.name.toLowerCase();return t.some(e=>{let t=e.replace(`.`,``);return n.endsWith(`.${t}`)})},Q=e=>e.type.startsWith(`image/`),ne=e=>{if(!x.value.has(e)){let t=URL.createObjectURL(e);x.value.set(e,t)}return x.value.get(e)||``},$=e=>{if(e===0)return`0 Bytes`;let t=1024,n=[`Bytes`,`KB`,`MB`,`GB`],r=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/t**+r).toFixed(2))+` `+n[r]},re=()=>{x.value.forEach(e=>{URL.revokeObjectURL(e)}),x.value.clear(),f.value=[],b.value=``,a.value&&(a.value.value=``),i(`update:modelValue`,f.value),i(`change`,f.value)};return g(()=>r.modelValue,e=>{f.value=e||[]},{immediate:!0}),p(()=>{x.value.forEach(e=>{URL.revokeObjectURL(e)}),x.value.clear()}),t({clearFiles:re}),(e,t)=>(m(),u(`div`,C,[c(`div`,{class:v([`border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center hover:border-gray-400 dark:hover:border-gray-500 transition-colors`,{"border-red-300 dark:border-red-600":b.value}])},[c(`div`,w,[t[2]||=c(`svg`,{class:`mx-auto h-12 w-12 text-gray-400`,stroke:`currentColor`,fill:`none`,viewBox:`0 0 48 48`},[c(`path`,{d:`M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02`,"stroke-width":`2`,"stroke-linecap":`round`,"stroke-linejoin":`round`})],-1),c(`div`,null,[c(`label`,T,[t[0]||=c(`span`,{class:`text-sm font-medium text-indigo-600 dark:text-indigo-400 hover:text-indigo-500 dark:hover:text-indigo-300`},` Click to upload files `,-1),c(`input`,{id:`file-upload`,ref_key:`fileInput`,ref:a,type:`file`,class:`sr-only`,multiple:e.multiple,accept:e.accept,disabled:e.disabled,onChange:Y},null,40,E)]),t[1]||=c(`span`,{class:`text-sm text-gray-500 dark:text-gray-400`},` or drag and drop`,-1)]),c(`p`,D,[d(y(S.value)+` up to `+y(K.value)+` each `,1),e.maxFiles>1?(m(),u(`span`,O,`(max `+y(e.maxFiles)+` files)`,1)):l(``,!0)])])],2),b.value?(m(),u(`p`,k,y(b.value),1)):l(``,!0),f.value.length>0?(m(),u(`div`,A,[c(`h4`,j,` Selected Files (`+y(f.value.length)+y(e.maxFiles>1?`/${e.maxFiles}`:``)+`) `,1),q.value.length>0?(m(),u(`div`,M,[t[4]||=c(`h5`,{class:`text-xs font-medium text-gray-600 dark:text-gray-400 uppercase tracking-wide`},`Images`,-1),c(`div`,N,[(m(!0),u(o,null,h(q.value,(n,r)=>(m(),u(`div`,{key:`image-${r}`,class:`relative group`},[c(`div`,P,[c(`img`,{src:ne(n.file),alt:n.file.name,class:`w-full h-full object-cover`,onLoad:()=>(n.file,void 0)},null,40,F)]),c(`div`,I,[c(`div`,ee,[c(`p`,te,y(n.file.name),1),c(`p`,L,y($(n.file.size)),1)])]),c(`button`,{type:`button`,onClick:e=>X(n.originalIndex),disabled:e.disabled,class:`absolute -top-2 -right-2 bg-red-500 hover:bg-red-600 text-white rounded-full p-1 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed`,title:`Remove image`},t[3]||=[c(`svg`,{class:`h-3 w-3`,fill:`currentColor`,viewBox:`0 0 20 20`},[c(`path`,{"fill-rule":`evenodd`,d:`M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z`,"clip-rule":`evenodd`})],-1)],8,R)]))),128))])])):l(``,!0),J.value.length>0?(m(),u(`div`,z,[q.value.length>0?(m(),u(`h5`,B,`Other Files`)):l(``,!0),c(`div`,V,[(m(!0),u(o,null,h(J.value,(n,r)=>(m(),u(`div`,{key:`file-${r}`,class:`flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-md`},[c(`div`,H,[t[5]||=c(`svg`,{class:`h-5 w-5 text-gray-400`,fill:`currentColor`,viewBox:`0 0 20 20`},[c(`path`,{"fill-rule":`evenodd`,d:`M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z`,"clip-rule":`evenodd`})],-1),c(`div`,null,[c(`p`,U,y(n.file.name),1),c(`p`,W,y($(n.file.size)),1)])]),c(`button`,{type:`button`,onClick:e=>X(n.originalIndex),disabled:e.disabled,class:`text-red-500 hover:text-red-700 dark:hover:text-red-400 disabled:opacity-50 disabled:cursor-not-allowed`,title:`Remove file`},t[6]||=[c(`svg`,{class:`h-4 w-4`,fill:`currentColor`,viewBox:`0 0 20 20`},[c(`path`,{"fill-rule":`evenodd`,d:`M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z`,"clip-rule":`evenodd`})],-1)],8,G)]))),128))])])):l(``,!0)])):l(``,!0)]))}}),q=K;export{q as b,S as c};
import{B as e,D as t,F as ee,I as te,J as n,U as ne,a$ as r,aD as i,aF as a,aG as o,aI as s,aJ as c,aL as l,aM as u,aN as re,aP as ie,aR as d,aS as ae,aZ as f,an as oe,as as se,az as p,b0 as m,b3 as h,h as ce,o as g,s as le,v as ue}from"./index-DMU9rpXT.js";import{b as de}from"./useAuth-TrM2yBGk.js";import"./GlobalConfig-Dep5CV3r.js";import"./tableUtils-BFc6-TYF.js";import{b as fe}from"./ConfirmationModal-BiZdQbdH.js";import{f as _}from"./common-DNevajli.js";import{b as v}from"./StatCard-CxIk6-0v.js";import{b as pe,c as y}from"./Pagination-DJzR5xqm.js";import{b as me}from"./priceListStore-BqovOwoV.js";const he={class:`space-y-6`},ge={class:`flex flex-col sm:flex-row sm:items-center sm:justify-between`},_e={class:`mt-4 sm:mt-0 flex space-x-2`},ve={key:0,class:`grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6`},ye={class:`bg-white dark:bg-gray-800 shadow rounded-lg p-4`},be={class:`grid grid-cols-1 md:grid-cols-4 gap-4`},xe={class:`md:col-span-1`},Se={class:`relative`},Ce={class:`bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden`},we={key:0,class:`p-8 text-center`},Te={key:1,class:`p-8 text-center`},Ee={class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},De={class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},Oe={key:0,class:`mt-6`},ke={key:2,class:`overflow-x-auto`},b={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},x={class:`bg-gray-50 dark:bg-gray-700`},S={key:0,class:`px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},C={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},w={class:`px-6 py-4 whitespace-nowrap`},Ae={class:`flex items-center`},je={class:`flex-shrink-0 h-10 w-10 rounded-md bg-blue-100 dark:bg-blue-900 flex items-center justify-center`},Me={class:`ml-4`},Ne={class:`text-sm font-medium text-gray-900 dark:text-white`},Pe={class:`text-sm text-gray-500 dark:text-gray-400`},Fe={class:`px-6 py-4`},Ie={class:`text-sm text-gray-900 dark:text-white`},Le=[`title`],Re={class:`px-6 py-4 whitespace-nowrap`},ze={class:`text-sm text-gray-900 dark:text-white`},Be={key:0,class:`px-6 py-4 whitespace-nowrap text-right text-sm font-medium`},Ve={class:`flex items-center justify-end space-x-2`},He=[`onClick`],Ue=[`onClick`],We=[`onClick`],Ge=[`onClick`],Ke=[`onClick`],qe={key:3};var T=re({__name:`IndexPage`,setup(re,{expose:T}){let E=se(),D=oe(),O=me(),{isSuperAdmin:k}=de(),A=r(!1),j=r(!1),M=r(null),N=r(``),P=r(``),F=r(``),I=r(!1),L=r(!1),R=r(null),z=r(``),B=a(()=>j.value?O.trashedPriceLists:O.priceLists),V=a(()=>O.pagination),H=a(()=>O.priceListStats),U=a(()=>O.urlParams),W=a(()=>!!(N.value||P.value||F.value)),Je=a(()=>B.value.length>0||j.value),G=async()=>{A.value=!0;try{j.value?await O.fetchTrashedPriceLists():await O.fetchPriceLists()}catch{D.error(`Failed to load price lists`)}finally{A.value=!1}},Ye=()=>{M.value&&clearTimeout(M.value),M.value=setTimeout(()=>{K()},300)},K=()=>{let e={page:1};N.value&&(e.search=N.value),P.value&&(e.date_from=P.value),F.value&&(e.date_to=F.value),O.updateFilters(e),G()},q=()=>{N.value=``,P.value=``,F.value=``,O.clearFilters(),G()},J=(e,t)=>{O.setSort(e,t),G()},Y=e=>{O.setPage(e),G()},Xe=()=>{V.value&&V.value.current_page>1&&Y(V.value.current_page-1)},Ze=()=>{V.value&&V.value.has_more_pages&&Y(V.value.current_page+1)},Qe=e=>{O.setPerPage(e),G()},$e=()=>{j.value=!j.value,O.clearFilters(),q(),G()},X=()=>{E.push({name:`price-lists.create`})},Z=e=>{E.push({name:`price-lists.view`,params:{id:e.id.toString()}})},et=e=>{E.push({name:`price-lists.edit`,params:{id:e.id.toString()}})},tt=e=>{R.value=e,z.value=`delete`,I.value=!0},nt=e=>{R.value=e,z.value=`restore`,I.value=!0},rt=e=>{R.value=e,z.value=`forceDelete`,I.value=!0},Q=a(()=>{switch(z.value){case`delete`:if(!R.value)break;return{title:`Delete Price List`,message:`Are you sure you want to delete "${R.value.code} - ${R.value.description}"? This action can be undone by restoring from trash.`,buttonText:`Delete Price List`,loadingText:`Deleting...`};case`restore`:if(!R.value)break;return{title:`Restore Price List`,message:`Are you sure you want to restore "${R.value.code} - ${R.value.description}"? The price list will be moved back to active price lists.`,buttonText:`Restore Price List`,loadingText:`Restoring...`};case`forceDelete`:if(!R.value)break;return{title:`Permanently Delete Price List`,message:`Are you sure you want to permanently delete "${R.value.code} - ${R.value.description}"? This action cannot be undone and all associated data will be lost.`,buttonText:`Permanently Delete`,loadingText:`Permanently Deleting...`};default:break}return{title:``,message:``,buttonText:``,loadingText:``}}),it=async()=>{L.value=!0;try{switch(z.value){case`delete`:if(!R.value)return;await O.deletePriceList(R.value.id),D.success(`Price list deleted successfully`);break;case`restore`:if(!R.value)return;await O.restorePriceList(R.value.id),D.success(`Price list restored successfully`);break;case`forceDelete`:if(!R.value)return;await O.forceDeletePriceList(R.value.id),D.success(`Price list permanently deleted`);break}G(),$()}catch{let e=z.value===`delete`?`delete`:z.value===`restore`?`restore`:`permanently delete`;D.error(`Failed to ${e} price list`)}finally{L.value=!1}},$=()=>{I.value=!1,R.value=null,z.value=``,L.value=!1};return ie(async()=>{await G()}),T({refreshData:G}),(r,a)=>(d(),c(`div`,he,[o(`div`,ge,[a[5]||=o(`div`,null,[o(`h1`,{class:`text-2xl font-bold text-gray-900 dark:text-white`},`Price Lists`),o(`p`,{class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},` Manage price lists and their items `)],-1),o(`div`,_e,[Je.value?(d(),c(`button`,{key:0,onClick:$e,class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[u(m(g),{class:`h-5 w-5 mr-2`}),l(` `+h(j.value?`View Active`:`View Trashed`),1)])):s(``,!0),m(k)&&!j.value?(d(),c(`button`,{key:1,onClick:X,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-900 transition-colors duration-200`},[u(m(e),{class:`h-5 w-5 mr-2`}),a[4]||=l(` Create Price List `,-1)])):s(``,!0)])]),j.value?s(``,!0):(d(),c(`div`,ve,[u(v,{label:`Total Price Lists`,value:m(_)(H.value.total||0),icon:m(n),"icon-color":`blue`},null,8,[`value`,`icon`]),u(v,{label:`Total Items`,value:m(_)(H.value.totalItems||0),icon:m(ee),"icon-color":`green`},null,8,[`value`,`icon`])])),o(`div`,ye,[o(`div`,be,[o(`div`,xe,[a[6]||=o(`label`,{for:`search`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Search `,-1),o(`div`,Se,[f(o(`input`,{id:`search`,"onUpdate:modelValue":a[0]||=e=>N.value=e,type:`text`,placeholder:`Search by code or description...`,class:`block w-full px-3 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 sm:text-sm transition-colors duration-200`,onInput:Ye},null,544),[[p,N.value]]),u(m(le),{class:`absolute left-3 top-2.5 h-5 w-5 text-gray-400`})])]),o(`div`,null,[a[7]||=o(`label`,{for:`date-from`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Date From `,-1),f(o(`input`,{id:`date-from`,"onUpdate:modelValue":a[1]||=e=>P.value=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:K},null,544),[[p,P.value]])]),o(`div`,null,[a[8]||=o(`label`,{for:`date-to`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1`},` Date To `,-1),f(o(`input`,{id:`date-to`,"onUpdate:modelValue":a[2]||=e=>F.value=e,type:`date`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,onChange:K},null,544),[[p,F.value]])]),o(`div`,{class:`flex items-end`},[o(`button`,{onClick:q,class:`w-full px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-200`},` Clear Filters `)])])]),o(`div`,Ce,[A.value?(d(),c(`div`,we,[u(m(te),{class:`h-8 w-8 animate-spin mx-auto text-blue-600 dark:text-blue-400`}),a[9]||=o(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},`Loading price lists...`,-1)])):B.value.length===0?(d(),c(`div`,Te,[u(m(n),{class:`h-12 w-12 mx-auto text-gray-400`}),o(`h3`,Ee,h(j.value?`No trashed price lists found`:`No price lists found`),1),o(`p`,De,h(W.value?`Try adjusting your search criteria.`:`Get started by creating your first price list.`),1),!W.value&&!j.value?(d(),c(`div`,Oe,[o(`button`,{onClick:X,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors duration-200`},[u(m(e),{class:`h-5 w-5 mr-2`}),a[10]||=l(` Add Your First Price List `,-1)])])):s(``,!0)])):(d(),c(`div`,ke,[o(`table`,b,[o(`thead`,x,[o(`tr`,null,[u(y,{label:`PL Code`,"sort-key":`code`,"current-sort":U.value.sort_by,"sort-direction":U.value.sort_direction,onSort:J},null,8,[`current-sort`,`sort-direction`]),u(y,{label:`Description`,"sort-key":`description`,"current-sort":U.value.sort_by,"sort-direction":U.value.sort_direction,onSort:J},null,8,[`current-sort`,`sort-direction`]),u(y,{label:`Item Count`,"sort-key":`item_count`,"current-sort":U.value.sort_by,"sort-direction":U.value.sort_direction,onSort:J},null,8,[`current-sort`,`sort-direction`]),m(k)?(d(),c(`th`,S,` Actions `)):s(``,!0)])]),o(`tbody`,C,[(d(!0),c(i,null,ae(B.value,e=>(d(),c(`tr`,{key:e.id,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[o(`td`,w,[o(`div`,Ae,[o(`div`,je,[u(m(n),{class:`h-5 w-5 text-blue-600 dark:text-blue-400`})]),o(`div`,Me,[o(`div`,Ne,h(e.code),1),o(`div`,Pe,` ID: `+h(e.id),1)])])]),o(`td`,Fe,[o(`div`,Ie,h(e.description),1),e.note?(d(),c(`div`,{key:0,class:`text-sm text-gray-500 dark:text-gray-400 truncate max-w-xs`,title:e.note},h(e.note),9,Le)):s(``,!0)]),o(`td`,Re,[o(`div`,ze,h(m(_)(e.item_count)),1)]),m(k)?(d(),c(`td`,Be,[o(`div`,Ve,[j.value?(d(),c(i,{key:1},[o(`button`,{onClick:t=>nt(e),class:`text-green-600 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 transition-colors duration-200`,title:`Restore price list`},[u(m(ue),{class:`h-4 w-4`})],8,Ge),o(`button`,{onClick:t=>rt(e),class:`text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300 transition-colors duration-200`,title:`Permanently delete`},[u(m(ce),{class:`h-4 w-4`})],8,Ke)],64)):(d(),c(i,{key:0},[o(`button`,{onClick:t=>Z(e),class:`text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 transition-colors duration-200`,title:`View details`},[u(m(ne),{class:`w-4 h-4`})],8,He),o(`button`,{onClick:t=>et(e),class:`text-indigo-600 dark:text-indigo-400 hover:text-indigo-900 dark:hover:text-indigo-300 transition-colors duration-200`,title:`Edit price list`},[u(m(t),{class:`h-4 w-4`})],8,Ue),o(`button`,{onClick:t=>tt(e),class:`text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300 transition-colors duration-200`,title:`Delete price list`},[u(m(g),{class:`h-4 w-4`})],8,We)],64))])])):s(``,!0)]))),128))])])])),V.value&&V.value.total>0?(d(),c(`div`,qe,[u(pe,{pagination:V.value,title:`price lists`,onChangePage:Y,onPrev:Xe,onNext:Ze,onChangePerPage:Qe},null,8,[`pagination`])])):s(``,!0)]),u(fe,{show:I.value,"onUpdate:show":a[3]||=e=>I.value=e,type:`delete`,title:Q.value.title,message:Q.value.message,"confirm-text":Q.value.buttonText,"loading-text":Q.value.loadingText,loading:L.value,onConfirm:it,onCancel:$},null,8,[`show`,`title`,`message`,`confirm-text`,`loading-text`,`loading`])]))}}),E=T;export{E as default};
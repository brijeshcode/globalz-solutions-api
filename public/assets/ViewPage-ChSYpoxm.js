import{W as e,a4 as t,a8 as n,a9 as ee,aH as r,aI as i,aJ as a,aL as o,aj as te,am as s,ao as c,ap as l,ar as u,as as d,at as ne,av as re,ax as f,ay as ie,k as ae,m as oe,r as se,v as ce,y as le}from"./index-CzmzGcJs.js";import"./GlobalConfig-DCFE7Hv9.js";import"./tableUtils-DX_RsmET.js";import{c as ue}from"./currenciesStore-gQZk2PeG.js";import{b as de}from"./ConfirmationModal-n5LW0c6g.js";import{b as p}from"./common-B50tJbGU.js";import{b as fe}from"./salesStore-CMiHJPa4.js";import{b as pe}from"./customersStore-Am8SOUI0.js";import{b as me}from"./employeesStore-Br3GMnHt.js";import{b as he}from"./warehousesStore-CXIB2Z3o.js";import{c as ge}from"./itemsStore-BOg7JIfx.js";const _e={class:`max-w-8xl mx-auto py-2`},m={class:``},h={class:`mb-8`},g={class:`flex items-center space-x-4 mb-2`},_={key:0,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},v={class:`px-6 py-4 border-b border-gray-200 dark:border-gray-700`},y={class:`flex items-center justify-between`},b={class:`text-lg font-medium text-gray-900 dark:text-white`},x={class:`text-sm text-gray-500 dark:text-gray-400`},S={class:`flex space-x-3`},C={class:`px-6 py-8`},w={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},T={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6`},E={class:`mt-1 text-sm text-gray-900 dark:text-white`},D={class:`mt-1 text-sm text-gray-900 dark:text-white`},O={class:`mt-1 text-sm text-gray-900 dark:text-white`},k={class:`mt-1 text-sm text-gray-900 dark:text-white`},A={class:`mt-1 text-sm text-gray-900 dark:text-white`},j={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-4`},M={class:`mt-1 text-sm text-gray-900 dark:text-white`},N={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},P={class:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6`},F={class:`mt-1 text-sm text-gray-900 dark:text-white`},I={class:`mt-1 text-sm text-gray-900 dark:text-white`},ve={class:`mt-1 text-sm text-gray-900 dark:text-white`},ye={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},be={key:0,class:`text-center py-8 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg`},xe={key:1,class:`overflow-x-auto`},Se={class:`min-w-full divide-y divide-gray-200 dark:divide-gray-700`},Ce={class:`bg-gray-50 dark:bg-gray-700`},we={class:`bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700`},Te={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ee={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},De={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Oe={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},ke={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ae={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},je={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Me={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ne={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Pe={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Fe={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Ie={class:`px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white`},Le={class:`bg-gray-50 dark:bg-gray-700`},Re={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},L={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},ze={key:0},Be={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},Ve={class:`px-6 py-4 text-sm font-medium text-gray-900 dark:text-white`},He={class:`bg-green-50 dark:bg-green-900`},Ue={class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},We={class:`px-6 py-4 text-sm font-bold text-gray-900 dark:text-white`},Ge={class:`border-b border-gray-200 dark:border-gray-700 pb-6 mb-6`},Ke={class:`grid grid-cols-1 md:grid-cols-3 gap-6`},qe={class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},Je={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},Ye={class:`bg-blue-50 dark:bg-blue-900 rounded-lg p-4`},Xe={class:`mt-1 text-lg font-medium text-blue-900 dark:text-blue-100`},Ze={class:`mt-1 text-lg font-medium`},Qe={key:0,class:`mb-6`},$e={class:`bg-gray-50 dark:bg-gray-700 rounded-lg p-4`},et={class:`text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap`},tt={class:`pt-6 border-t border-gray-200 dark:border-gray-700`},nt={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},rt={class:`mt-1 text-sm text-gray-900 dark:text-white`},it={class:`mt-1 text-sm text-gray-900 dark:text-white`},at={key:1,class:`bg-white dark:bg-gray-800 shadow rounded-lg`},ot={class:`px-6 py-8 text-center`};var R=ne({__name:`ViewPage`,setup(ne){let R=ee(),z=n(),B=t(),V=fe(),H=pe(),U=me(),W=ue(),G=he(),K=ge(),q=parseInt(z.params.id),J=r(!0),Y=r({}),X=r(!1),Z=r(!1),st=r([]),ct=r([]),lt=r([]),ut=r([]),dt=r([]),ft=()=>{R.push({name:`sales.index`})},pt=()=>{R.push({name:`sales.edit`,params:{id:q.toString()}})},mt=()=>{R.push({name:`sales.invoice`,params:{id:q.toString()},query:{from:`view`}})},ht=()=>{X.value=!0},gt=()=>{X.value=!1,Z.value=!1},_t=async()=>{Z.value=!0;try{await V.deleteSale(q),B.success(`Sale deleted successfully`),R.push({name:`sales.index`})}catch{B.error(`Failed to delete sale`)}finally{Z.value=!1}},vt=async()=>{try{J.value=!0,Y.value=await V.fetchSale(q)}catch(e){console.error(`Error loading sale:`,e),B.error(`Failed to load sale details`),R.push({name:`sales.index`})}finally{J.value=!1}},yt=async()=>{try{await Promise.all([bt(),xt(),St(),Ct(),wt()])}catch(e){console.error(`Error loading dropdown data:`,e)}},bt=async()=>{await H.fetchCustomers({is_active:!0}),st.value=H.customers},xt=async()=>{await U.fetchEmployees({is_active:!0}),ct.value=U.salespersons},St=async()=>{await G.fetchWarehouses(),lt.value=G.warehouses},Ct=async()=>{await W.fetchCurrencies(),ut.value=W.currencies},wt=async()=>{await K.fetchItems({per_page:1e3}),dt.value=K.items},Tt=e=>{let t=Number(e||0);return t>0?`text-green-600 dark:text-green-400 font-medium`:t<0?`text-red-600 dark:text-red-400 font-medium`:`text-gray-600 dark:text-gray-400`},Et=e=>{let t=Number(e||0);return t>0?`bg-green-50 dark:bg-green-900 text-green-600 dark:text-green-400`:t<0?`bg-red-50 dark:bg-red-900 text-red-600 dark:text-red-400`:`bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-400`},Dt=e=>{let t=Number(e||0);return t>0?`text-red-600 dark:text-red-400 font-medium`:`text-gray-900 dark:text-white`},Q=e=>e?parseFloat(Number(e).toFixed(2)).toString():`0`,Ot=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleDateString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`})},$=e=>{if(!e)return`-`;let t=new Date(e);return t.toLocaleString(`en-US`,{year:`numeric`,month:`short`,day:`numeric`,hour:`2-digit`,minute:`2-digit`})};return re(async()=>{await yt(),await vt()}),(t,n)=>(f(),l(`div`,_e,[s(`div`,m,[s(`div`,h,[s(`div`,g,[s(`button`,{onClick:ft,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors`},[d(i(e),{class:`w-5 h-5`})]),n[1]||=s(`div`,null,[s(`h2`,{class:`text-2xl font-bold text-gray-900 dark:text-gray-100`},` Sale Details `),s(`p`,{class:`text-sm text-gray-600 dark:text-gray-400`},` View sale order information `)],-1)])]),J.value?(f(),l(`div`,at,[s(`div`,ot,[d(i(le),{class:`w-8 h-8 animate-spin mx-auto text-blue-600`}),n[43]||=s(`p`,{class:`mt-2 text-gray-600 dark:text-gray-400`},`Loading sale details...`,-1)])])):(f(),l(`div`,_,[s(`div`,v,[s(`div`,y,[s(`div`,null,[s(`h3`,b,o(Y.value.prefix)+`-`+o(Y.value.code),1),s(`p`,x,` Sale ID: `+o(Y.value.id),1)]),s(`div`,S,[s(`button`,{onClick:mt,class:`inline-flex items-center px-3 py-2 border border-green-300 dark:border-green-600 text-sm font-medium rounded-md text-green-700 dark:text-green-300 bg-white dark:bg-gray-800 hover:bg-green-50 dark:hover:bg-green-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200`},[d(i(se),{class:`w-4 h-4 mr-2`}),n[2]||=u(` Print Invoice `,-1)]),s(`button`,{onClick:pt,class:`inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200`},[d(i(ce),{class:`w-4 h-4 mr-2`}),n[3]||=u(` Edit `,-1)]),s(`button`,{onClick:ht,class:`inline-flex items-center px-3 py-2 border border-red-300 dark:border-red-600 text-sm font-medium rounded-md text-red-700 dark:text-red-300 bg-white dark:bg-gray-800 hover:bg-red-50 dark:hover:bg-red-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200`},[d(i(ae),{class:`w-4 h-4 mr-2`}),n[4]||=u(` Delete `,-1)])])])]),s(`div`,C,[s(`div`,w,[n[12]||=s(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Basic Information `,-1),s(`div`,T,[s(`div`,null,[n[5]||=s(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Sale Date`,-1),s(`dd`,E,o(Ot(Y.value.date)),1)]),s(`div`,null,[n[6]||=s(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Customer`,-1),s(`dd`,D,o(Y.value.customer.name),1)]),s(`div`,null,[n[7]||=s(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Salesperson`,-1),s(`dd`,O,o(Y.value.salesperson.name),1)]),s(`div`,null,[n[8]||=s(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Warehouse`,-1),s(`dd`,k,o(Y.value.warehouse.name),1)]),s(`div`,null,[n[9]||=s(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Currency`,-1),s(`dd`,A,o(Y.value.currency.code)+` - `+o(Y.value.currency.name),1)])]),s(`div`,j,[s(`div`,null,[n[10]||=s(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Currency Rate`,-1),s(`dd`,M,o(Q(Y.value.currency_rate)),1)]),s(`div`,null,[n[11]||=s(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Outstanding Balance`,-1),s(`dd`,{class:a([`mt-1 text-sm`,Dt(Y.value.outStanding_balance)])},o(i(p)(Y.value.outStanding_balance)),3)])])]),s(`div`,N,[n[17]||=s(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Financial Summary `,-1),s(`div`,P,[s(`div`,null,[n[13]||=s(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Sub Total`,-1),s(`dd`,F,o(i(p)(Y.value.sub_total)),1)]),s(`div`,null,[n[14]||=s(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Sub Total (USD)`,-1),s(`dd`,I,o(i(p)(Y.value.sub_total_usd)),1)]),s(`div`,null,[n[15]||=s(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Discount Amount`,-1),s(`dd`,ve,o(i(p)(Y.value.discount_amount)),1)]),s(`div`,null,[n[16]||=s(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Total Profit`,-1),s(`dd`,{class:a([`mt-1 text-sm`,Tt(Y.value.total_profit)])},o(i(p)(Y.value.total_profit)),3)])])]),s(`div`,ye,[n[35]||=s(`div`,{class:`flex items-center justify-between mb-4`},[s(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white`},` Sale Items `)],-1),Y.value.items&&Y.value.items.length===0?(f(),l(`div`,be,[d(i(oe),{class:`mx-auto h-12 w-12 text-gray-400`}),n[18]||=s(`h5`,{class:`mt-2 text-sm font-medium text-gray-900 dark:text-white`},`No items found`,-1),n[19]||=s(`p`,{class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},`This sale has no items.`,-1)])):(f(),l(`div`,xe,[s(`table`,Se,[s(`thead`,Ce,[s(`tr`,null,[n[20]||=s(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`#`,-1),n[21]||=s(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Code`,-1),n[22]||=s(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Item`,-1),n[23]||=s(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Unit`,-1),n[24]||=s(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[s(`abbr`,{title:`Total Quantity`},`QTY`)],-1),n[25]||=s(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Sale Price`,-1),n[26]||=s(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Cost Price`,-1),n[27]||=s(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[s(`abbr`,{title:`Discount Percentage`},`Dis. %`)],-1),n[28]||=s(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[s(`abbr`,{title:`Tax Percentage`},`Tax %`)],-1),n[29]||=s(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},[s(`abbr`,{title:`Tax-inclusive Price`},`TTC`)],-1),n[30]||=s(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`Total`,-1),n[31]||=s(`th`,{class:`px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider`},`USD`,-1),c(``,!0)])]),s(`tbody`,we,[(f(!0),l(te,null,ie(Y.value.items,(e,t)=>(f(),l(`tr`,{key:t,class:`hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200`},[s(`td`,Te,o(t+1),1),s(`td`,Ee,o(e.item_code),1),s(`td`,De,o(e.item.description),1),s(`td`,Oe,o(e.item.item_unit.name),1),s(`td`,ke,o(Q(e.quantity)),1),s(`td`,Ae,o(i(p)(e.price)),1),s(`td`,je,o(i(p)(e.cost_price)),1),s(`td`,Me,o(Q(e.discount_percent))+`%`,1),s(`td`,Ne,o(Q(e.tax_percent))+`%`,1),s(`td`,Pe,o(Q(e.ttc_price)),1),s(`td`,Fe,o(i(p)(e.total_price)),1),s(`td`,Ie,o(i(p)(e.total_price_usd)),1),c(``,!0)]))),128))]),s(`tfoot`,Le,[s(`tr`,null,[n[32]||=s(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Sub Total:`,-1),s(`td`,Re,o(i(p)(Y.value.sub_total)),1),s(`td`,L,o(i(p)(Y.value.sub_total_usd)),1),c(``,!0)]),Y.value.discount_amount&&Number(Y.value.discount_amount)>0?(f(),l(`tr`,ze,[n[33]||=s(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-medium text-gray-900 dark:text-white`},`Additional Discount:`,-1),s(`td`,Be,`-`+o(i(p)(Y.value.discount_amount)),1),s(`td`,Ve,`-`+o(i(p)(Y.value.discount_amount_usd)),1),c(``,!0)])):c(``,!0),s(`tr`,He,[n[34]||=s(`td`,{colspan:`10`,class:`px-6 py-4 text-right text-sm font-bold text-gray-900 dark:text-white`},`Final Total:`,-1),s(`td`,Ue,o(i(p)(Y.value.total)),1),s(`td`,We,o(i(p)(Y.value.total_usd)),1),c(``,!0)])])])]))]),s(`div`,Ge,[n[39]||=s(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Final Totals `,-1),s(`div`,Ke,[s(`div`,qe,[n[36]||=s(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount`,-1),s(`dd`,Je,o(i(p)(Y.value.total)),1)]),s(`div`,Ye,[n[37]||=s(`dt`,{class:`text-sm font-medium text-blue-600 dark:text-blue-400`},`Total Amount (USD)`,-1),s(`dd`,Xe,o(i(p)(Y.value.total_usd)),1)]),s(`div`,{class:a([`rounded-lg p-4`,Et(Y.value.total_profit)])},[n[38]||=s(`dt`,{class:`text-sm font-medium`},`Total Profit (USD)`,-1),s(`dd`,Ze,o(i(p)(Y.value.total_profit)),1)],2)])]),Y.value.note?(f(),l(`div`,Qe,[n[40]||=s(`h4`,{class:`text-lg font-medium text-gray-900 dark:text-white mb-4`},` Notes `,-1),s(`div`,$e,[s(`p`,et,o(Y.value.note),1)])])):c(``,!0),s(`div`,tt,[s(`div`,nt,[s(`div`,null,[n[41]||=s(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Created At`,-1),s(`dd`,rt,o($(Y.value.created_at)),1)]),s(`div`,null,[n[42]||=s(`dt`,{class:`text-sm font-medium text-gray-500 dark:text-gray-400`},`Last Updated`,-1),s(`dd`,it,o($(Y.value.updated_at)),1)])])])])]))]),d(de,{show:X.value,"onUpdate:show":n[0]||=e=>X.value=e,type:`delete`,title:`Delete Sale ${Y.value.prefix}-${Y.value.code}`,message:`Are you sure you want to delete sale '${Y.value.prefix}-${Y.value.code}'? This action can be undone by restoring from trash.`,"confirm-text":`Delete Sale`,"loading-text":`Deleting...`,loading:Z.value,onConfirm:_t,onCancel:gt},null,8,[`show`,`title`,`message`,`loading`])]))}}),z=R;export{z as default};
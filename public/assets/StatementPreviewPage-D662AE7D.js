import{F as e,O as t,aD as n,aE as r,aP as i,aR as a,aS as o,aU as s,aV as c,aW as l,aX as u,aY as d,aZ as f,al as p,az as ee,b0 as m,b2 as h,b3 as g,bc as _,bd as v,be as y,bg as b}from"./index-CPSuq9q8.js";import"./GlobalConfig-wPgXFcZ5.js";import{c as x}from"./common-CZbH6H1Z.js";import"./tableUtils-dXs1kjAL.js";import{b as S}from"./currencyUtil-CW5chEzz.js";import{b as C}from"./companyStore-XVHWGXaW.js";import{b as te}from"./customersStore-D1NzMQ4E.js";const w={class:`max-w-4xl mx-auto p-8 bg-white text-gray-900 print:h-full print:p-0 print:max-w-none print:mx-0`},T={class:`header`},E={class:`flex justify-between items-start mb-10 pb-6 border-b-2 border-blue-600 print:border-black print:mb-6`},D={class:`flex-1`},O={class:`flex items-center mb-3`},k=[`src`,`alt`],A={key:1,class:`text-3xl font-bold text-blue-600 print:text-black print:text-2xl`},j={key:0},M={class:`print:text-black`},N={class:`text-right flex-1 mt-4`},P={class:`text-lg font-semibold text-gray-600 print:text-black print:text-base`},F={class:`grid grid-cols-1 md:grid-cols-12 gap-8 mb-10 print:grid-cols-12 print:gap-6 print:mb-6`},I={class:`col-span-12 md:col-span-8 print:col-span-8`},L={class:`space-y-1 print:space-y-0`},R={class:`flex justify-between print:justify-between`},z={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},B={class:`flex justify-between print:justify-between`},V={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},H={key:0,class:`flex justify-between print:justify-between`},U={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},W={key:1,class:`flex justify-between print:justify-between`},G={class:`text-gray-900 font-semibold print:font-normal print:text-black print:text-xs`},K={class:`col-span-12 md:col-span-4 print:col-span-4`},q={class:`space-y-1 print:space-y-0`},J={key:0,class:`flex justify-between print:justify-between`},Y={class:`text-gray-900 print:text-black print:text-xs`},X={class:`flex justify-between print:justify-between`},Z={class:`text-gray-900 print:text-black print:text-xs`},Q={class:`flex justify-between print:justify-between`},ne={class:`text-gray-900 print:text-black print:text-xs`},re={key:1,class:`flex justify-between print:justify-between`},ie={class:`text-gray-900 print:text-black print:text-xs`},ae={class:`body`},oe={class:`mb-8 print:mb-4`},se={class:`overflow-x-auto print:overflow-visible`},ce={class:`w-full border-collapse border border-gray-300 print:border-black`},le={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},ue={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},de={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},fe={class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},pe={class:`border-t-2 border-gray-400 print:border-t-2 print:border-black font-bold bg-gray-100 print:bg-gray-200`},me={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},he={class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-black print:text-xs`},ge={class:`footer print:block hidden print:fixed print:bottom-0 print:left-0 print:right-0`},_e={class:`border-t-2 border-gray-300 print:border-black pt-4 pb-2`},ve={class:`mt-2 print:mt-1`},ye={class:`flex flex-wrap gap-2 text-sm text-gray-600 print:text-black print:text-xs justify-between`},be={key:0,class:`flex-1`},xe={key:1,class:`flex-1 text-center`},Se={key:2,class:`flex-1 text-center`},Ce={key:3,class:`flex-1 text-right`};var we=f({__name:`CustomerStatement`,props:{statements:{default:()=>[]},stats:{default:()=>({})},customerData:{},filters:{default:()=>({})}},setup(e,{expose:t}){let n=e,r=C();m(async()=>{try{r.company.name||await r.fetchCompany()}catch(e){console.error(`Failed to fetch company data:`,e)}});let u=a(()=>{let e=n.statements?.length||0,t=15;return e>=t?0:t-e}),d=e=>{let t={sales:`Sales`,payments:`Payment`,credit_note:`Credit Note`,debit_note:`Debit Note`,returns:`Return`};return t[e]||e},f=e=>!e&&e!==0?`print:text-black`:e>=0?`text-green-600 dark:text-green-400 print:text-black`:`text-red-600 dark:text-red-400 print:text-black`,p=()=>{window.print()};return t({printStatement:p}),(e,t)=>(h(),c(`div`,w,[o(`section`,T,[o(`div`,E,[o(`div`,D,[o(`div`,O,[v(r).company.logo?.preview_url?(h(),c(`img`,{key:0,src:v(r).company.logo.preview_url,alt:v(r).company.name||`Company Logo`,class:`h-24 w-auto mr-4 print:h-12`},null,8,k)):s(``,!0),v(r).company.logo?.preview_url?s(``,!0):(h(),c(`div`,A,b(v(r).company.name),1))]),v(r).company.tax_number?(h(),c(`div`,j,[o(`p`,M,[o(`b`,null,`Tax Registration #: `+b(v(r).company.tax_number),1)])])):s(``,!0)]),o(`div`,N,[t[0]||=o(`h1`,{class:`text-2xl font-bold text-blue-600 mb-2 print:text-black print:text-xl`},`CUSTOMER STATEMENT`,-1),o(`div`,P,b(e.customerData?.code),1)])]),o(`div`,F,[o(`div`,I,[t[5]||=o(`h3`,{class:`text-lg font-bold text-blue-600 mb-3 print:text-sm border-b border-gray-200 print:text-black print:border-black`},`Customer Information`,-1),o(`div`,L,[o(`div`,R,[t[1]||=o(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Customer:`,-1),o(`span`,z,b(e.customerData?.code)+`, `+b(e.customerData?.name||`Unknown Customer`),1)]),o(`div`,B,[t[2]||=o(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Address:`,-1),o(`span`,V,b(e.customerData?.address)+`, `+b(e.customerData?.city),1)]),e.customerData?.mobile?(h(),c(`div`,H,[t[3]||=o(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Phone:`,-1),o(`span`,U,b(e.customerData?.mobile),1)])):s(``,!0),e.customerData?.mof_tax_number?(h(),c(`div`,W,[t[4]||=o(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Tax #:`,-1),o(`span`,G,b(e.customerData?.mof_tax_number),1)])):s(``,!0)])]),o(`div`,K,[t[10]||=o(`h3`,{class:`text-lg font-bold text-blue-600 mb-3 print:text-sm border-b border-gray-200 print:text-black print:border-black`},`Statement Period`,-1),o(`div`,q,[e.filters?.from_date?(h(),c(`div`,J,[t[6]||=o(`span`,{class:`font-semibold text-gray-700 print:text-black`},`From Date:`,-1),o(`span`,Y,b(v(x)(e.filters.from_date)),1)])):s(``,!0),o(`div`,X,[t[7]||=o(`span`,{class:`font-semibold text-gray-700 print:text-black`},`To Date:`,-1),o(`span`,Z,b(e.filters?.to_date?v(x)(e.filters.to_date):`Current`),1)]),o(`div`,Q,[t[8]||=o(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Print Date:`,-1),o(`span`,ne,b(v(x)(new Date().toISOString())),1)]),e.customerData?.salesperson?(h(),c(`div`,re,[t[9]||=o(`span`,{class:`font-semibold text-gray-700 print:text-black`},`Sales Pers.:`,-1),o(`span`,ie,b(e.customerData.salesperson?.name),1)])):s(``,!0)])])])]),o(`section`,ae,[o(`div`,oe,[o(`div`,se,[o(`table`,ce,[t[15]||=o(`thead`,null,[o(`tr`,{class:`bg-gray-100 print:bg-gray-200`},[o(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-left font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Date`),o(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-left font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Type`),o(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-left font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Transaction ID`),o(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-left font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Note`),o(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Debit`),o(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Credit`),o(`th`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-gray-700 print:border-black print:text-black print:text-xs`},`Balance`)])],-1),o(`tbody`,null,[s(``,!0),(h(!0),c(i,null,g(e.statements,e=>(h(),c(`tr`,{key:e.id,class:`even:bg-gray-50 print:even:bg-gray-100`},[o(`td`,le,b(v(x)(e.date)),1),o(`td`,ue,b(d(e.type)),1),o(`td`,de,b(e.code||`-`),1),o(`td`,fe,b(e.note||`-`),1),o(`td`,{class:y([`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-xs`,e.debit?`text-red-600 dark:text-red-400 font-medium print:text-black`:`print:text-black`])},b(e.debit?v(S)(e.debit):`-`),3),o(`td`,{class:y([`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right print:border-black print:text-xs`,e.credit?`text-green-600 dark:text-green-400 font-medium print:text-black`:`print:text-black`])},b(e.credit?v(S)(e.credit):`-`),3),o(`td`,{class:y([`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-semibold print:border-black print:text-xs`,f(e.balance)])},b(v(S)(e.balance)),3)]))),128)),(h(!0),c(i,null,g(u.value,e=>(h(),c(`tr`,{key:`empty-`+e,class:`even:bg-gray-50 print:even:bg-gray-100`},t[12]||=[o(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1),o(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1),o(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1),o(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1),o(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1),o(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1),o(`td`,{class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-xs`},`\xA0`,-1)]))),128)),o(`tr`,pe,[t[13]||=o(`td`,{colspan:`3`,class:`border-r border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black`},null,-1),t[14]||=o(`td`,{class:`border border-gray-300 px-3 py-1 print:px-1 print:py-0 print:border-black print:text-black print:text-xs`},`Total`,-1),o(`td`,me,b(v(S)(e.stats?.total_debit)),1),o(`td`,he,b(v(S)(e.stats?.total_credit)),1),o(`td`,{class:y([`border border-gray-300 px-3 py-1 print:px-1 print:py-0 text-right font-bold text-lg print:border-black print:text-xs`,f(e.stats?.balance)])},b(v(S)(e.stats?.balance)),3)])])])])]),t[16]||=l(`<div class="flex justify-between items-center mb-6 print:mb-3 mt-8 print:mt-6"><div class="flex-1 text-center"><p class="font-semibold text-gray-700 print:text-black print:text-xs">Received By</p><div class="border-b border-gray-400 print:border-black mt-8 print:mt-4"></div></div><div class="flex-1 text-center ml-8"><p class="font-semibold text-gray-700 print:text-black print:text-xs">Signature</p><div class="border-b border-gray-400 print:border-black mt-8 print:mt-4"></div></div></div>`,1)]),o(`section`,ge,[o(`footer`,_e,[o(`div`,ve,[o(`div`,ye,[v(r).company.address?(h(),c(`p`,be,b(v(r).company.address),1)):s(``,!0),v(r).company.phone?(h(),c(`p`,xe,b(v(r).company.phone),1)):s(``,!0),v(r).company.email?(h(),c(`p`,Se,b(v(r).company.email),1)):s(``,!0),v(r).company.website?(h(),c(`p`,Ce,b(v(r).company.website),1)):s(``,!0)])])])])]))}}),Te=we;const Ee={class:`min-h-screen bg-gray-50 print:bg-white`},De={class:`bg-white shadow-sm border-b print:hidden`},$={class:`max-w-7xl mx-auto px-4 sm:px-6 lg:px-8`},Oe={class:`flex items-center justify-between h-16`},ke={class:`flex items-center space-x-4`},Ae={class:`text-sm text-gray-500`},je={class:`flex items-center space-x-3`},Me={key:0,class:`flex items-center justify-center min-h-screen`},Ne={class:`text-center`},Pe={key:1,class:`py-8 print:py-0`},Fe={class:`max-w-6xl mx-auto print:max-w-none`};var Ie=f({__name:`StatementPreviewPage`,setup(i){let s=r(),l=n(),f=ee(),g=te(),y=a(()=>parseInt(l.params.id)),x=_(!0),S=_([]),C=_({}),w=_(null),T=_(null),E=_({search:l.query.search||``,from_date:l.query.from_date||``,to_date:l.query.to_date||``,transaction_type:l.query.transaction_type||``,withPage:!1}),D=()=>{s.back()},O=async()=>{if(T.value)try{await T.value.printStatement()}catch(e){console.error(`Failed to print statement:`,e),f.error(`Failed to print statement`)}},k=async()=>{try{w.value=await g.fetchCustomer(y.value)}catch(e){console.error(`Error loading customer:`,e),f.error(`Failed to load customer details`),s.push({name:`customers.index`})}},A=async()=>{try{let e=await g.fetchCustomerStatements(y.value,E.value);S.value=e.data,C.value=e.stats}catch(e){f.error(`Failed to load customer statements`,{title:`Error`}),console.error(`Error fetching statements:`,e)}};return m(async()=>{try{x.value=!0,await Promise.all([k(),A()])}catch(e){console.error(`Error initializing statement preview:`,e)}finally{x.value=!1}}),(n,r)=>(h(),c(`div`,Ee,[o(`div`,De,[o(`div`,$,[o(`div`,Oe,[o(`div`,ke,[o(`button`,{onClick:D,class:`inline-flex items-center p-2 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100 transition-colors`},[d(v(p),{class:`w-5 h-5`})]),o(`div`,null,[r[0]||=o(`h1`,{class:`text-lg font-semibold text-gray-900`},`Statement Preview`,-1),o(`p`,Ae,b(w.value?.code)+` - `+b(w.value?.name),1)])]),o(`div`,je,[o(`button`,{onClick:O,class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`},[d(v(e),{class:`w-4 h-4 mr-2`}),r[1]||=u(` Print Statement `,-1)])])])])]),x.value?(h(),c(`div`,Me,[o(`div`,Ne,[d(v(t),{class:`w-8 h-8 animate-spin mx-auto text-blue-600`}),r[2]||=o(`p`,{class:`mt-2 text-gray-600`},`Loading statement...`,-1)])])):(h(),c(`div`,Pe,[o(`div`,Fe,[d(Te,{ref_key:`customerStatementRef`,ref:T,statements:S.value,stats:C.value,"customer-data":w.value,filters:E.value},null,8,[`statements`,`stats`,`customer-data`,`filters`])])]))]))}}),Le=Ie;export{Le as default};